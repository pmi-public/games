import"./modulepreload-polyfill-B5Qt9EMX.js";var Ai=Object.defineProperty,Ri=(i,t,e)=>t in i?Ai(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ke=(i,t,e)=>(Ri(i,typeof t!="symbol"?t+"":t,e),e);const randomNumber=i=>Math.floor(Math.random()*i),nul=()=>!1,each=(i,t)=>{if(Array.isArray(i))i=[...i],i.forEach(t);else if(typeof i=="object"){const e={};for(const s in i)if(!e[s]&&t(i[s],s)===!1)break}else if(typeof i=="number")for(let e=0;e<i&&t(e,e)!==!1;e++);else if(typeof i=="string")for(let e=0,s=i.length;e<s&&t(i.charAt(e),e)!==!1;e++);},apply=(i,t,e)=>(t||(t={}),e?each(i,(s,h)=>{h in e||(t[h]=s)}):each(i,(s,h)=>t[h]=s),t),makeElement=(i,t)=>{const e=document.createElement(i),s=h=>{typeof h=="string"?e.style.cssText=h:apply(h,e.style)};for(const h in t)h==="class"?e.className=t[h]:h==="for"?e.htmlFor=t[h]:h==="style"?s(t[h]):e.setAttribute(h,t[h]);return e};function addPonyfills(){String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/,"")},String.prototype.htmlEncode=String.prototype.htmlEncode||function(){const i=document.createElement("div");return function(){let t;return i.appendChild(document.createTextNode(this)),t=i.innerHTML,i.innerHTML="",t}}(),String.prototype.byteLength=String.prototype.byteLength||function(){return this.replace(/[^\x00-\xff]/g,"  ").length},String.prototype.subByte=String.prototype.subByte||function(i,t){let e=this;return e.byteLength()<=i?e:(t=t||"",i-=t.byteLength(),e=e.slice(0,i).replace(/([^\x00-\xff])/g,"$1 ").slice(0,i).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"$1")+t)},Function.prototype.defer=Function.prototype.defer||function(i,t){const e=this;return setTimeout(function(){e.apply(i,arguments)},t)},Function.prototype.bind=Function.prototype.bind||function(i){const t=this;return function(){return t.apply(i,arguments)}},Function.prototype.saturate=Function.prototype.saturate||function(i){const t=this,e=[].slice.call(arguments,1);return function(){return t.apply(i,[].slice.call(arguments,0).concat(e))}},Array.prototype.indexOf=Array.prototype.indexOf||function(i,t){const e=this.length;for(t||(t=0),t<0&&(t=e+t);t<e;t++)if(this[t]===i)return t;return-1},Array.prototype.every=Array.prototype.every||function(i,t){for(var e=0,s=this.length;e<s;e++)if(!i.call(t,this[e],e,this))return!1;return!0},Array.prototype.filter=Array.prototype.filter||function(i,t){let e=[],s;for(var h=0,m=this.length;h<m;h++)s=this[h],i.call(t,s,h,this)&&e.push(s);return e},Array.prototype.forEach=Array.prototype.forEach||function(i,t){for(var e=0,s=this.length;e<s;e++)i.call(t,this[e],e,this)},Array.prototype.map=Array.prototype.map||function(i,t){const e=[];for(var s=0,h=this.length;s<h;s++)e[s]=i.call(t,this[s],s,this);return e},Array.prototype.some=Array.prototype.some||function(i,t){for(var e=0,s=this.length;e<s;e++)if(i.call(t,this[e],e,this))return!0;return!1},Array.prototype.invoke=Array.prototype.invoke||function(i){const t=[].slice.call(arguments,1);return this.forEach(function(e){e instanceof Array?e[0][i].apply(e[0],e.slice(1)):e[i].apply(e,t)}),this},Array.prototype.random=Array.prototype.random||function(){let i=this.slice(0),t=[],e=i.length;for(;e--;)t.push(i.splice(randomNumber(e+1),1)[0]);return t}}addPonyfills();(function(){function i(){if(i.is(arguments[0],ut)){for(var r=arguments[0],n=ce[U](i,r.splice(0,3+i.is(r[0],nt))),o=n.set(),c=0,l=r[L];c<l;c++){var d=r[c]||{};e[m](d.type)&&o[J](n[d.type]().attr(d))}return o}return ce[U](i,arguments)}i.version="1.5.2";var t=/[, ]+/,e={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},s=/\{(\d+)\}/g,h="prototype",m="hasOwnProperty",T=document,v=window,b={was:Object[h][m].call(v,"Raphael"),is:v.Raphael},w=function(){this.customAttributes={}},S,O="appendChild",U="apply",F="concat",X="createTouch"in T,M="",z=" ",H=String,Q="split",Bt="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[Q](z),Ct={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},tt="join",L="length",Tt=H[h].toLowerCase,P=Math,it=P.max,gt=P.min,et=P.abs,W=P.pow,lt=P.PI,nt="number",It="string",ut="array",Et="toString",yt="fill",$e=Object[h][Et],J="push",Te=/^url\(['"]?([^\)]+?)['"]?\)$/i,ti=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ei={NaN:1,Infinity:1,"-Infinity":1},ni=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,st=P.round,ft="setAttribute",V=parseFloat,Ot=parseInt,ie=" progid:DXImageTransform.Microsoft",Xt=H[h].toUpperCase,zt={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},ne={along:"along",blur:nt,"clip-rect":"csv",cx:nt,cy:nt,fill:"colour","fill-opacity":nt,"font-size":nt,height:nt,opacity:nt,path:"path",r:nt,rotation:"csv",rx:nt,ry:nt,scale:"csv",stroke:"colour","stroke-opacity":nt,"stroke-width":nt,translation:"csv",width:nt,x:nt,y:nt},at="replace",si=/^(from|to|\d+%?)$/,se=/\s*,\s*/,ai={hs:1,rg:1},ri=/,?([achlmqrstvxz]),?/gi,oi=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,hi=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Ee=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,ci=function(r,n){return r.key-n.key};if(i.type=v.SVGAngle||T.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",i.type=="VML"){var ae=T.createElement("div"),Wt;if(ae.innerHTML='<v:shape adj="1"/>',Wt=ae.firstChild,Wt.style.behavior="url(#default#VML)",!(Wt&&typeof Wt.adj=="object"))return i.type=null;ae=null}i.svg=!(i.vml=i.type=="VML"),w[h]=i[h],S=w[h],i._id=0,i._oid=0,i.fn={},i.is=function(r,n){return n=Tt.call(n),n=="finite"?!ei[m](+r):n=="null"&&r===null||n==typeof r||n=="object"&&r===Object(r)||n=="array"&&Array.isArray&&Array.isArray(r)||$e.call(r).slice(8,-1).toLowerCase()==n},i.angle=function(r,n,o,c,l,d){{if(l==null){var f=r-o,u=n-c;return!f&&!u?0:((f<0)*180+P.atan(-u/-f)*180/lt+360)%360}return i.angle(r,n,l,d)-i.angle(o,c,l,d)}},i.rad=function(r){return r%360*lt/180},i.deg=function(r){return r*180/lt%360},i.snapTo=function(r,n,o){if(o=i.is(o,"finite")?o:10,i.is(r,ut)){for(var c=r.length;c--;)if(et(r[c]-n)<=o)return r[c]}else{r=+r;var l=n%r;if(l<o)return n-l;if(l>r-o)return n-l+r}return n};function Vt(){for(var r=[],n=0;n<32;n++)r[n]=(~~(P.random()*16))[Et](16);return r[12]=4,r[16]=(r[16]&3|8)[Et](16),"r-"+r[tt]("")}i.setWindow=function(r){v=r,T=v.document};var Pt=function(r){if(i.vml){var n=/^\s+|\s+$/g,o;try{var c=new ActiveXObject("htmlfile");c.write("<body>"),c.close(),o=c.body}catch{o=createPopup().document.body}var l=o.createTextRange();Pt=St(function(f){try{o.style.color=H(f)[at](n,M);var u=l.queryCommandValue("ForeColor");return u=(u&255)<<16|u&65280|(u&16711680)>>>16,"#"+("000000"+u[Et](16)).slice(-6)}catch{return"none"}})}else{var d=T.createElement("i");d.title="Raphaël Colour Picker",d.style.display="none",T.body[O](d),Pt=St(function(f){return d.style.color=f,T.defaultView.getComputedStyle(d,M).getPropertyValue("color")})}return Pt(r)},Se=function(){return"hsb("+[this.h,this.s,this.b]+")"},li=function(){return"hsl("+[this.h,this.s,this.l]+")"},ui=function(){return this.hex};i.hsb2rgb=function(r,n,o,c){return i.is(r,"object")&&"h"in r&&"s"in r&&"b"in r&&(o=r.b,n=r.s,r=r.h,c=r.o),i.hsl2rgb(r,n,o/2,c)},i.hsl2rgb=function(r,n,o,c){i.is(r,"object")&&"h"in r&&"s"in r&&"l"in r&&(o=r.l,n=r.s,r=r.h),(r>1||n>1||o>1)&&(r/=360,n/=100,o/=100);var l={},d=["r","g","b"],f,u,_;if(n){o<.5?f=o*(1+n):f=o+n-o*n,u=2*o-f;for(var p=0;p<3;p++)_=r+1/3*-(p-1),_<0&&_++,_>1&&_--,_*6<1?l[d[p]]=u+(f-u)*6*_:_*2<1?l[d[p]]=f:_*3<2?l[d[p]]=u+(f-u)*(2/3-_)*6:l[d[p]]=u}else l={r:o,g:o,b:o};return l.r*=255,l.g*=255,l.b*=255,l.hex="#"+(16777216|l.b|l.g<<8|l.r<<16).toString(16).slice(1),i.is(c,"finite")&&(l.opacity=c),l.toString=ui,l},i.rgb2hsb=function(r,n,o){if(n==null&&i.is(r,"object")&&"r"in r&&"g"in r&&"b"in r&&(o=r.b,n=r.g,r=r.r),n==null&&i.is(r,It)){var c=i.getRGB(r);r=c.r,n=c.g,o=c.b}(r>1||n>1||o>1)&&(r/=255,n/=255,o/=255);var l=it(r,n,o),d=gt(r,n,o),f,u,_=l;{if(d==l)return{h:0,s:0,b:l,toString:Se};var p=l-d;u=p/l,r==l?f=(n-o)/p:n==l?f=2+(o-r)/p:f=4+(r-n)/p,f/=6,f<0&&f++,f>1&&f--}return{h:f,s:u,b:_,toString:Se}},i.rgb2hsl=function(r,n,o){if(n==null&&i.is(r,"object")&&"r"in r&&"g"in r&&"b"in r&&(o=r.b,n=r.g,r=r.r),n==null&&i.is(r,It)){var c=i.getRGB(r);r=c.r,n=c.g,o=c.b}(r>1||n>1||o>1)&&(r/=255,n/=255,o/=255);var l=it(r,n,o),d=gt(r,n,o),f,u,_=(l+d)/2,p;if(d==l)p={h:0,s:0,l:_};else{var E=l-d;u=_<.5?E/(l+d):E/(2-l-d),r==l?f=(n-o)/E:n==l?f=2+(o-r)/E:f=4+(r-n)/E,f/=6,f<0&&f++,f>1&&f--,p={h:f,s:u,l:_}}return p.toString=li,p},i._path2string=function(){return this.join(",")[at](ri,"$1")};function St(r,n,o){function c(){var l=Array[h].slice.call(arguments,0),d=l[tt]("►"),f=c.cache=c.cache||{},u=c.count=c.count||[];return f[m](d)||(u[L]>=1e3&&delete f[u.shift()],u[J](d),f[d]=r[U](n,l)),o?o(f[d]):f[d]}return c}i.getRGB=St(function(r){if(!r||(r=H(r)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(r=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(ai[m](r.toLowerCase().substring(0,2))||r.charAt()=="#")&&(r=Pt(r));var n,o,c,l,d,f,u=r.match(ti);return u?(u[2]&&(c=Ot(u[2].substring(5),16),o=Ot(u[2].substring(3,5),16),n=Ot(u[2].substring(1,3),16)),u[3]&&(c=Ot((d=u[3].charAt(3))+d,16),o=Ot((d=u[3].charAt(2))+d,16),n=Ot((d=u[3].charAt(1))+d,16)),u[4]&&(f=u[4][Q](se),n=V(f[0]),f[0].slice(-1)=="%"&&(n*=2.55),o=V(f[1]),f[1].slice(-1)=="%"&&(o*=2.55),c=V(f[2]),f[2].slice(-1)=="%"&&(c*=2.55),u[1].toLowerCase().slice(0,4)=="rgba"&&(l=V(f[3])),f[3]&&f[3].slice(-1)=="%"&&(l/=100)),u[5]?(f=u[5][Q](se),n=V(f[0]),f[0].slice(-1)=="%"&&(n*=2.55),o=V(f[1]),f[1].slice(-1)=="%"&&(o*=2.55),c=V(f[2]),f[2].slice(-1)=="%"&&(c*=2.55),(f[0].slice(-3)=="deg"||f[0].slice(-1)=="°")&&(n/=360),u[1].toLowerCase().slice(0,4)=="hsba"&&(l=V(f[3])),f[3]&&f[3].slice(-1)=="%"&&(l/=100),i.hsb2rgb(n,o,c,l)):u[6]?(f=u[6][Q](se),n=V(f[0]),f[0].slice(-1)=="%"&&(n*=2.55),o=V(f[1]),f[1].slice(-1)=="%"&&(o*=2.55),c=V(f[2]),f[2].slice(-1)=="%"&&(c*=2.55),(f[0].slice(-3)=="deg"||f[0].slice(-1)=="°")&&(n/=360),u[1].toLowerCase().slice(0,4)=="hsla"&&(l=V(f[3])),f[3]&&f[3].slice(-1)=="%"&&(l/=100),i.hsl2rgb(n,o,c,l)):(u={r:n,g:o,b:c},u.hex="#"+(16777216|c|o<<8|n<<16).toString(16).slice(1),i.is(l,"finite")&&(u.opacity=l),u)):{r:-1,g:-1,b:-1,hex:"none",error:1}},i),i.getColor=function(r){var n=this.getColor.start=this.getColor.start||{h:0,s:1,b:r||.75},o=this.hsb2rgb(n.h,n.s,n.b);return n.h+=.075,n.h>1&&(n.h=0,n.s-=.2,n.s<=0&&(this.getColor.start={h:0,s:1,b:n.b})),o.hex},i.getColor.reset=function(){delete this.start},i.parsePathString=St(function(r){if(!r)return null;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return i.is(r,ut)&&i.is(r[0],ut)&&(o=Kt(r)),o[L]||H(r)[at](oi,function(c,l,d){var f=[],u=Tt.call(l);for(d[at](hi,function(_,p){p&&f[J](+p)}),u=="m"&&f[L]>2&&(o[J]([l][F](f.splice(0,2))),u="l",l=l=="m"?"l":"L");f[L]>=n[u]&&(o[J]([l][F](f.splice(0,n[u]))),!!n[u]););}),o[Et]=i._path2string,o}),i.findDotsAtSegment=function(r,n,o,c,l,d,f,u,_){var p=1-_,E=W(p,3)*r+W(p,2)*3*_*o+p*3*_*_*l+W(_,3)*f,A=W(p,3)*n+W(p,2)*3*_*c+p*3*_*_*d+W(_,3)*u,I=r+2*_*(o-r)+_*_*(l-2*o+r),R=n+2*_*(c-n)+_*_*(d-2*c+n),N=o+2*_*(l-o)+_*_*(f-2*l+o),y=c+2*_*(d-c)+_*_*(u-2*d+c),x=(1-_)*r+_*o,C=(1-_)*n+_*c,B=(1-_)*l+_*f,Y=(1-_)*d+_*u,k=90-P.atan((I-N)/(R-y))*180/lt;return(I>N||R<y)&&(k+=180),{x:E,y:A,m:{x:I,y:R},n:{x:N,y},start:{x,y:C},end:{x:B,y:Y},alpha:k}};var jt=St(function(r){if(!r)return{x:0,y:0,width:0,height:0};r=Qt(r);for(var n=0,o=0,c=[],l=[],d,f=0,u=r[L];f<u;f++)if(d=r[f],d[0]=="M")n=d[1],o=d[2],c[J](n),l[J](o);else{var _=di(n,o,d[1],d[2],d[3],d[4],d[5],d[6]);c=c[F](_.min.x,_.max.x),l=l[F](_.min.y,_.max.y),n=d[5],o=d[6]}var p=gt[U](0,c),E=gt[U](0,l);return{x:p,y:E,width:it[U](0,c)-p,height:it[U](0,l)-E}}),Kt=function(r){var n=[];(!i.is(r,ut)||!i.is(r&&r[0],ut))&&(r=i.parsePathString(r));for(var o=0,c=r[L];o<c;o++){n[o]=[];for(var l=0,d=r[o][L];l<d;l++)n[o][l]=r[o][l]}return n[Et]=i._path2string,n},re=St(function(r){(!i.is(r,ut)||!i.is(r&&r[0],ut))&&(r=i.parsePathString(r));var n=[],o=0,c=0,l=0,d=0,f=0;r[0][0]=="M"&&(o=r[0][1],c=r[0][2],l=o,d=c,f++,n[J](["M",o,c]));for(var u=f,_=r[L];u<_;u++){var p=n[u]=[],E=r[u];if(E[0]!=Tt.call(E[0]))switch(p[0]=Tt.call(E[0]),p[0]){case"a":p[1]=E[1],p[2]=E[2],p[3]=E[3],p[4]=E[4],p[5]=E[5],p[6]=+(E[6]-o).toFixed(3),p[7]=+(E[7]-c).toFixed(3);break;case"v":p[1]=+(E[1]-c).toFixed(3);break;case"m":l=E[1],d=E[2];default:for(var A=1,I=E[L];A<I;A++)p[A]=+(E[A]-(A%2?o:c)).toFixed(3)}else{p=n[u]=[],E[0]=="m"&&(l=E[1]+o,d=E[2]+c);for(var R=0,N=E[L];R<N;R++)n[u][R]=E[R]}var y=n[u][L];switch(n[u][0]){case"z":o=l,c=d;break;case"h":o+=+n[u][y-1];break;case"v":c+=+n[u][y-1];break;default:o+=+n[u][y-2],c+=+n[u][y-1]}}return n[Et]=i._path2string,n},0,Kt),Dt=St(function(r){(!i.is(r,ut)||!i.is(r&&r[0],ut))&&(r=i.parsePathString(r));var n=[],o=0,c=0,l=0,d=0,f=0;r[0][0]=="M"&&(o=+r[0][1],c=+r[0][2],l=o,d=c,f++,n[0]=["M",o,c]);for(var u=f,_=r[L];u<_;u++){var p=n[u]=[],E=r[u];if(E[0]!=Xt.call(E[0]))switch(p[0]=Xt.call(E[0]),p[0]){case"A":p[1]=E[1],p[2]=E[2],p[3]=E[3],p[4]=E[4],p[5]=E[5],p[6]=+(E[6]+o),p[7]=+(E[7]+c);break;case"V":p[1]=+E[1]+c;break;case"H":p[1]=+E[1]+o;break;case"M":l=+E[1]+o,d=+E[2]+c;default:for(var A=1,I=E[L];A<I;A++)p[A]=+E[A]+(A%2?o:c)}else for(var R=0,N=E[L];R<N;R++)n[u][R]=E[R];switch(p[0]){case"Z":o=l,c=d;break;case"H":o=p[1];break;case"V":c=p[1];break;case"M":l=n[u][n[u][L]-2],d=n[u][n[u][L]-1];default:o=n[u][n[u][L]-2],c=n[u][n[u][L]-1]}}return n[Et]=i._path2string,n},null,Kt),qt=function(r,n,o,c){return[r,n,o,c,o,c]},xe=function(r,n,o,c,l,d){var f=.3333333333333333,u=2/3;return[f*r+u*o,f*n+u*c,f*l+u*o,f*d+u*c,l,d]},ye=function(r,n,o,c,l,d,f,u,_,p){var E=lt*120/180,A=lt/180*(+l||0),I=[],R,N=St(function(Qe,Je,ee){var Ii=Qe*P.cos(ee)-Je*P.sin(ee),bi=Qe*P.sin(ee)+Je*P.cos(ee);return{x:Ii,y:bi}});if(p)$=p[0],G=p[1],q=p[2],Z=p[3];else{R=N(r,n,-A),r=R.x,n=R.y,R=N(u,_,-A),u=R.x,_=R.y;var y=(r-u)/2,x=(n-_)/2,C=y*y/(o*o)+x*x/(c*c);C>1&&(C=P.sqrt(C),o=C*o,c=C*c);var B=o*o,Y=c*c,k=(d==f?-1:1)*P.sqrt(et((B*Y-B*x*x-Y*y*y)/(B*x*x+Y*y*y))),q=k*o*x/c+(r+u)/2,Z=k*-c*y/o+(n+_)/2,$=P.asin(((n-Z)/c).toFixed(9)),G=P.asin(((_-Z)/c).toFixed(9));$=r<q?lt-$:$,G=u<q?lt-G:G,$<0&&($=lt*2+$),G<0&&(G=lt*2+G),f&&$>G&&($=$-lt*2),!f&&G>$&&(G=G-lt*2)}var ht=G-$;if(et(ht)>E){var rt=G,xt=u,vt=_;G=$+E*(f&&G>$?1:-1),u=q+o*P.cos(G),_=Z+c*P.sin(G),I=ye(u,_,o,c,l,0,f,xt,vt,[G,rt,q,Z])}ht=G-$;var At=P.cos($),ct=P.sin($),Mt=P.cos(G),_t=P.sin(G),Rt=P.tan(ht/4),Lt=4/3*o*Rt,Ve=4/3*c*Rt,Pe=[r,n],Ft=[r+Lt*ct,n-Ve*At],je=[u+Lt*_t,_-Ve*Mt],qe=[u,_];Ft[0]=2*Pe[0]-Ft[0],Ft[1]=2*Pe[1]-Ft[1];{if(p)return[Ft,je,qe][F](I);I=[Ft,je,qe][F](I)[tt]()[Q](",");for(var Ze=[],bt=0,Ni=I[L];bt<Ni;bt++)Ze[bt]=bt%2?N(I[bt-1],I[bt],A).y:N(I[bt],I[bt+1],A).x;return Ze}},Zt=function(r,n,o,c,l,d,f,u,_){var p=1-_;return{x:W(p,3)*r+W(p,2)*3*_*o+p*3*_*_*l+W(_,3)*f,y:W(p,3)*n+W(p,2)*3*_*c+p*3*_*_*d+W(_,3)*u}},di=St(function(r,n,o,c,l,d,f,u){var _=l-2*o+r-(f-2*l+o),p=2*(o-r)-2*(l-o),E=r-o,A=(-p+P.sqrt(p*p-4*_*E))/2/_,I=(-p-P.sqrt(p*p-4*_*E))/2/_,R=[n,u],N=[r,f],y;return et(A)>"1e12"&&(A=.5),et(I)>"1e12"&&(I=.5),A>0&&A<1&&(y=Zt(r,n,o,c,l,d,f,u,A),N[J](y.x),R[J](y.y)),I>0&&I<1&&(y=Zt(r,n,o,c,l,d,f,u,I),N[J](y.x),R[J](y.y)),_=d-2*c+n-(u-2*d+c),p=2*(c-n)-2*(d-c),E=n-c,A=(-p+P.sqrt(p*p-4*_*E))/2/_,I=(-p-P.sqrt(p*p-4*_*E))/2/_,et(A)>"1e12"&&(A=.5),et(I)>"1e12"&&(I=.5),A>0&&A<1&&(y=Zt(r,n,o,c,l,d,f,u,A),N[J](y.x),R[J](y.y)),I>0&&I<1&&(y=Zt(r,n,o,c,l,d,f,u,I),N[J](y.x),R[J](y.y)),{min:{x:gt[U](0,N),y:gt[U](0,R)},max:{x:it[U](0,N),y:it[U](0,R)}}}),Qt=St(function(r,n){for(var o=Dt(r),c=n&&Dt(n),l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f=function(y,x){var C,B;if(!y)return["C",x.x,x.y,x.x,x.y,x.x,x.y];switch(!(y[0]in{T:1,Q:1})&&(x.qx=x.qy=null),y[0]){case"M":x.X=y[1],x.Y=y[2];break;case"A":y=["C"][F](ye[U](0,[x.x,x.y][F](y.slice(1))));break;case"S":C=x.x+(x.x-(x.bx||x.x)),B=x.y+(x.y-(x.by||x.y)),y=["C",C,B][F](y.slice(1));break;case"T":x.qx=x.x+(x.x-(x.qx||x.x)),x.qy=x.y+(x.y-(x.qy||x.y)),y=["C"][F](xe(x.x,x.y,x.qx,x.qy,y[1],y[2]));break;case"Q":x.qx=y[1],x.qy=y[2],y=["C"][F](xe(x.x,x.y,y[1],y[2],y[3],y[4]));break;case"L":y=["C"][F](qt(x.x,x.y,y[1],y[2]));break;case"H":y=["C"][F](qt(x.x,x.y,y[1],x.y));break;case"V":y=["C"][F](qt(x.x,x.y,x.x,y[1]));break;case"Z":y=["C"][F](qt(x.x,x.y,x.X,x.Y));break}return y},u=function(y,x){if(y[x][L]>7){y[x].shift();for(var C=y[x];C[L];)y.splice(x++,0,["C"][F](C.splice(0,6)));y.splice(x,1),E=it(o[L],c&&c[L]||0)}},_=function(y,x,C,B,Y){y&&x&&y[Y][0]=="M"&&x[Y][0]!="M"&&(x.splice(Y,0,["M",B.x,B.y]),C.bx=0,C.by=0,C.x=y[Y][1],C.y=y[Y][2],E=it(o[L],c&&c[L]||0))},p=0,E=it(o[L],c&&c[L]||0);p<E;p++){o[p]=f(o[p],l),u(o,p),c&&(c[p]=f(c[p],d)),c&&u(c,p),_(o,c,l,d,p),_(c,o,d,l,p);var A=o[p],I=c&&c[p],R=A[L],N=c&&I[L];l.x=A[R-2],l.y=A[R-1],l.bx=V(A[R-4])||l.x,l.by=V(A[R-3])||l.y,d.bx=c&&(V(I[N-4])||d.x),d.by=c&&(V(I[N-3])||d.y),d.x=c&&I[N-2],d.y=c&&I[N-1]}return c?[o,c]:o},null,Kt),Oe=St(function(r){for(var n=[],o=0,c=r[L];o<c;o++){var l={},d=r[o].match(/^([^:]*):?([\d\.]*)/);if(l.color=i.getRGB(d[1]),l.color.error)return null;l.color=l.color.hex,d[2]&&(l.offset=d[2]+"%"),n[J](l)}for(o=1,c=n[L]-1;o<c;o++)if(!n[o].offset){for(var f=V(n[o-1].offset||0),u=0,_=o+1;_<c;_++)if(n[_].offset){u=n[_].offset;break}u||(u=100,_=c),u=V(u);for(var p=(u-f)/(_-o+1);o<_;o++)f+=p,n[o].offset=f+"%"}return n}),ve=function(r,n,o,c){var l;if(i.is(r,It)||i.is(r,"object")){if(l=i.is(r,It)?T.getElementById(r):r,l.tagName)return n==null?{container:l,width:l.style.pixelWidth||l.offsetWidth,height:l.style.pixelHeight||l.offsetHeight}:{container:l,width:n,height:o}}else return{container:1,x:r,y:n,width:o,height:c}},oe=function(r,n){var o=this;for(var c in n)if(n[m](c)&&!(c in r))switch(typeof n[c]){case"function":(function(l){r[c]=r===o?l:function(){return l[U](o,arguments)}})(n[c]);break;case"object":r[c]=r[c]||{},oe.call(this,r[c],n[c]);break;default:r[c]=n[c];break}},Ut=function(r,n){r==n.top&&(n.top=r.prev),r==n.bottom&&(n.bottom=r.next),r.next&&(r.next.prev=r.prev),r.prev&&(r.prev.next=r.next)},Ne=function(r,n){n.top!==r&&(Ut(r,n),r.next=null,r.prev=n.top,n.top.next=r,n.top=r)},Ie=function(r,n){n.bottom!==r&&(Ut(r,n),r.next=n.bottom,r.prev=null,n.bottom.prev=r,n.bottom=r)},Ae=function(r,n,o){Ut(r,o),n==o.top&&(o.top=r),n.next&&(n.next.prev=r),r.next=n.next,r.prev=n,n.next=r},Re=function(r,n,o){Ut(r,o),n==o.bottom&&(o.bottom=r),n.prev&&(n.prev.next=r),r.prev=n.prev,n.prev=r,r.next=n},be=function(r){return function(){throw new Error("Raphaël: you are calling to method “"+r+"” of removed object")}};if(i.pathToRelative=re,i.svg){S.svgns="http://www.w3.org/2000/svg",S.xlink="http://www.w3.org/1999/xlink",st=function(r){return+r+(~~r===r)*.5};var D=function(r,n){if(n)for(var o in n)n[m](o)&&r[ft](o,H(n[o]));else return r=T.createElementNS(S.svgns,r),r.style.webkitTapHighlightColor="rgba(0,0,0,0)",r};i[Et]=function(){return`Your browser supports SVG.
You are running Raphaël `+this.version};var Le=function(r,n){var o=D("path");n.canvas&&n.canvas[O](o);var c=new K(o,n);return c.type="path",Nt(c,{fill:"none",stroke:"#000",path:r}),c},Gt=function(r,n,o){var c="linear",l=.5,d=.5,f=r.style;if(n=H(n)[at](Ee,function(x,C,B){if(c="radial",C&&B){l=V(C),d=V(B);var Y=(d>.5)*2-1;W(l-.5,2)+W(d-.5,2)>.25&&(d=P.sqrt(.25-W(l-.5,2))*Y+.5)&&d!=.5&&(d=d.toFixed(5)-1e-5*Y)}return M}),n=n[Q](/\s*\-\s*/),c=="linear"){var u=n.shift();if(u=-V(u),isNaN(u))return null;var _=[0,0,P.cos(u*lt/180),P.sin(u*lt/180)],p=1/(it(et(_[2]),et(_[3]))||1);_[2]*=p,_[3]*=p,_[2]<0&&(_[0]=-_[2],_[2]=0),_[3]<0&&(_[1]=-_[3],_[3]=0)}var E=Oe(n);if(!E)return null;var A=r.getAttribute(yt);A=A.match(/^url\(#(.*)\)$/),A&&o.defs.removeChild(T.getElementById(A[1]));var I=D(c+"Gradient");I.id=Vt(),D(I,c=="radial"?{fx:l,fy:d}:{x1:_[0],y1:_[1],x2:_[2],y2:_[3]}),o.defs[O](I);for(var R=0,N=E[L];R<N;R++){var y=D("stop");D(y,{offset:E[R].offset?E[R].offset:R?"100%":"0%","stop-color":E[R].color||"#fff"}),I[O](y)}return D(r,{fill:"url(#"+I.id+")",opacity:1,"fill-opacity":1}),f.fill=M,f.opacity=1,f.fillOpacity=1,1},he=function(r){var n=r.getBBox();D(r.pattern,{patternTransform:i.format("translate({0},{1})",n.x,n.y)})},Nt=function(r,n){var o={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},c=r.node,l=r.attrs,d=r.rotate(),f=function(G,ht){if(ht=o[Tt.call(ht)],ht){for(var rt=G.attrs["stroke-width"]||"1",xt={round:rt,square:rt,butt:0}[G.attrs["stroke-linecap"]||n["stroke-linecap"]]||0,vt=[],At=ht[L];At--;)vt[At]=ht[At]*rt+(At%2?1:-1)*xt;D(c,{"stroke-dasharray":vt[tt](",")})}};n[m]("rotation")&&(d=n.rotation);var u=H(d)[Q](t);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,V(d)&&r.rotate(0,!0);for(var _ in n)if(n[m](_)){if(!zt[m](_))continue;var p=n[_];switch(l[_]=p,_){case"blur":r.blur(p);break;case"rotation":r.rotate(p,!0);break;case"href":case"title":case"target":var E=c.parentNode;if(Tt.call(E.tagName)!="a"){var A=D("a");E.insertBefore(A,c),A[O](c),E=A}_=="target"&&p=="blank"?E.setAttributeNS(r.paper.xlink,"show","new"):E.setAttributeNS(r.paper.xlink,_,p);break;case"cursor":c.style.cursor=p;break;case"clip-rect":var I=H(p)[Q](t);if(I[L]==4){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var R=D("clipPath"),N=D("rect");R.id=Vt(),D(N,{x:I[0],y:I[1],width:I[2],height:I[3]}),R[O](N),r.paper.defs[O](R),D(c,{"clip-path":"url(#"+R.id+")"}),r.clip=N}if(!p){var y=T.getElementById(c.getAttribute("clip-path")[at](/(^url\(#|\)$)/g,M));y&&y.parentNode.removeChild(y),D(c,{"clip-path":M}),delete r.clip}break;case"path":r.type=="path"&&D(c,{d:p?l.path=Dt(p):"M0,0"});break;case"width":if(c[ft](_,p),l.fx)_="x",p=l.x;else break;case"x":l.fx&&(p=-l.x-(l.width||0));case"rx":if(_=="rx"&&r.type=="rect")break;case"cx":u&&(_=="x"||_=="cx")&&(u[1]+=p-l[_]),c[ft](_,p),r.pattern&&he(r);break;case"height":if(c[ft](_,p),l.fy)_="y",p=l.y;else break;case"y":l.fy&&(p=-l.y-(l.height||0));case"ry":if(_=="ry"&&r.type=="rect")break;case"cy":u&&(_=="y"||_=="cy")&&(u[2]+=p-l[_]),c[ft](_,p),r.pattern&&he(r);break;case"r":r.type=="rect"?D(c,{rx:p,ry:p}):c[ft](_,p);break;case"src":r.type=="image"&&c.setAttributeNS(r.paper.xlink,"href",p);break;case"stroke-width":c.style.strokeWidth=p,c[ft](_,p),l["stroke-dasharray"]&&f(r,l["stroke-dasharray"]);break;case"stroke-dasharray":f(r,p);break;case"translation":var x=H(p)[Q](t);x[0]=+x[0]||0,x[1]=+x[1]||0,u&&(u[1]+=x[0],u[2]+=x[1]),te.call(r,x[0],x[1]);break;case"scale":x=H(p)[Q](t),r.scale(+x[0]||1,+x[1]||+x[0]||1,isNaN(V(x[2]))?null:+x[2],isNaN(V(x[3]))?null:+x[3]);break;case yt:var C=H(p).match(Te);if(C){R=D("pattern");var B=D("image");R.id=Vt(),D(R,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),D(B,{x:0,y:0}),B.setAttributeNS(r.paper.xlink,"href",C[1]),R[O](B);var Y=T.createElement("img");Y.style.cssText="position:absolute;left:-9999em;top-9999em",Y.onload=function(){D(R,{width:this.offsetWidth,height:this.offsetHeight}),D(B,{width:this.offsetWidth,height:this.offsetHeight}),T.body.removeChild(this),r.paper.safari()},T.body[O](Y),Y.src=C[1],r.paper.defs[O](R),c.style.fill="url(#"+R.id+")",D(c,{fill:"url(#"+R.id+")"}),r.pattern=R,r.pattern&&he(r);break}var k=i.getRGB(p);if(k.error)if(({circle:1,ellipse:1}[m](r.type)||H(p).charAt()!="r")&&Gt(c,p,r.paper)){l.gradient=p,l.fill="none";break}else delete n.gradient,delete l.gradient,!i.is(l.opacity,"undefined")&&i.is(n.opacity,"undefined")&&D(c,{opacity:l.opacity}),!i.is(l["fill-opacity"],"undefined")&&i.is(n["fill-opacity"],"undefined")&&D(c,{"fill-opacity":l["fill-opacity"]});k[m]("opacity")&&D(c,{"fill-opacity":k.opacity>1?k.opacity/100:k.opacity});case"stroke":k=i.getRGB(p),c[ft](_,k.hex),_=="stroke"&&k[m]("opacity")&&D(c,{"stroke-opacity":k.opacity>1?k.opacity/100:k.opacity});break;case"gradient":({circle:1,ellipse:1}[m](r.type)||H(p).charAt()!="r")&&Gt(c,p,r.paper);break;case"opacity":l.gradient&&!l[m]("stroke-opacity")&&D(c,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(l.gradient){var q=T.getElementById(c.getAttribute(yt)[at](/^url\(#|\)$/g,M));if(q){var Z=q.getElementsByTagName("stop");Z[Z[L]-1][ft]("stop-opacity",p)}break}default:_=="font-size"&&(p=Ot(p,10)+"px");var $=_[at](/(\-.)/g,function(G){return Xt.call(G.substring(1))});c.style[$]=p,c[ft](_,p);break}}gi(r,n),u?r.rotate(u.join(z)):V(d)&&r.rotate(d,!0)},Ue=1.2,gi=function(r,n){if(!(r.type!="text"||!(n[m]("text")||n[m]("font")||n[m]("font-size")||n[m]("x")||n[m]("y")))){var o=r.attrs,c=r.node,l=c.firstChild?Ot(T.defaultView.getComputedStyle(c.firstChild,M).getPropertyValue("font-size"),10):10;if(n[m]("text")){for(o.text=n.text;c.firstChild;)c.removeChild(c.firstChild);for(var d=H(n.text)[Q](`
`),f=0,u=d[L];f<u;f++)if(d[f]){var _=D("tspan");f&&D(_,{dy:l*Ue,x:o.x}),_[O](T.createTextNode(d[f])),c[O](_)}}else for(d=c.getElementsByTagName("tspan"),f=0,u=d[L];f<u;f++)f&&D(d[f],{dy:l*Ue,x:o.x});D(c,{y:o.y});var p=r.getBBox(),E=o.y-(p.y+p.height/2);E&&i.is(E,"finite")&&D(c,{y:o.y+E})}},K=function(r,n){this[0]=r,this.id=i._oid++,this.node=r,r.raphael=this,this.paper=n,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},j=K[h];K[h].rotate=function(r,n,o){if(this.removed)return this;if(r==null)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][tt](z):this._.rt.deg;var c=this.getBBox();return r=H(r)[Q](t),r[L]-1&&(n=V(r[1]),o=V(r[2])),r=V(r[0]),n!=null&&n!==!1?this._.rt.deg=r:this._.rt.deg+=r,o==null&&(n=null),this._.rt.cx=n,this._.rt.cy=o,n=n??c.x+c.width/2,o=o??c.y+c.height/2,this._.rt.deg?(this.transformations[0]=i.format("rotate({0} {1} {2})",this._.rt.deg,n,o),this.clip&&D(this.clip,{transform:i.format("rotate({0} {1} {2})",-this._.rt.deg,n,o)})):(this.transformations[0]=M,this.clip&&D(this.clip,{transform:M})),D(this.node,{transform:this.transformations[tt](z)}),this},K[h].hide=function(){return!this.removed&&(this.node.style.display="none"),this},K[h].show=function(){return!this.removed&&(this.node.style.display=""),this},K[h].remove=function(){if(!this.removed){Ut(this,this.paper),this.node.parentNode.removeChild(this.node);for(var r in this)delete this[r];this.removed=!0}},K[h].getBBox=function(){if(this.removed)return this;if(this.type=="path")return jt(this.attrs.path);if(this.node.style.display=="none"){this.show();var r=!0}var n={};try{n=this.node.getBBox()}catch{}finally{n=n||{}}if(this.type=="text"){n={x:n.x,y:1/0,width:0,height:0};for(var o=0,c=this.node.getNumberOfChars();o<c;o++){var l=this.node.getExtentOfChar(o);l.y<n.y&&(n.y=l.y),l.y+l.height-n.y>n.height&&(n.height=l.y+l.height-n.y),l.x+l.width-n.x>n.width&&(n.width=l.x+l.width-n.x)}}return r&&this.hide(),n},K[h].attr=function(r,n){if(this.removed)return this;if(r==null){var o={};for(var c in this.attrs)this.attrs[m](c)&&(o[c]=this.attrs[c]);return this._.rt.deg&&(o.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(o.scale=this.scale()),o.gradient&&o.fill=="none"&&(o.fill=o.gradient)&&delete o.gradient,o}if(n==null&&i.is(r,It))return r=="translation"?te.call(this):r=="rotation"?this.rotate():r=="scale"?this.scale():r==yt&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[r];if(n==null&&i.is(r,ut)){for(var l={},d=0,f=r.length;d<f;d++)l[r[d]]=this.attr(r[d]);return l}if(n!=null){var u={};u[r]=n}else r!=null&&i.is(r,"object")&&(u=r);for(var _ in this.paper.customAttributes)if(this.paper.customAttributes[m](_)&&u[m](_)&&i.is(this.paper.customAttributes[_],"function")){var p=this.paper.customAttributes[_].apply(this,[][F](u[_]));this.attrs[_]=u[_];for(var E in p)p[m](E)&&(u[E]=p[E])}return Nt(this,u),this},K[h].toFront=function(){if(this.removed)return this;this.node.parentNode[O](this.node);var r=this.paper;return r.top!=this&&Ne(this,r),this},K[h].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Ie(this,this.paper),this.paper),this)},K[h].insertAfter=function(r){if(this.removed)return this;var n=r.node||r[r.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode[O](this.node),Ae(this,r,this.paper),this},K[h].insertBefore=function(r){if(this.removed)return this;var n=r.node||r[0].node;return n.parentNode.insertBefore(this.node,n),Re(this,r,this.paper),this},K[h].blur=function(r){var n=this;if(+r!=0){var o=D("filter"),c=D("feGaussianBlur");n.attrs.blur=r,o.id=Vt(),D(c,{stdDeviation:+r||1.5}),o.appendChild(c),n.paper.defs.appendChild(o),n._blur=o,D(n.node,{filter:"url(#"+o.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")};var we=function(r,n,o,c){var l=D("circle");r.canvas&&r.canvas[O](l);var d=new K(l,r);return d.attrs={cx:n,cy:o,r:c,fill:"none",stroke:"#000"},d.type="circle",D(l,d.attrs),d},Me=function(r,n,o,c,l,d){var f=D("rect");r.canvas&&r.canvas[O](f);var u=new K(f,r);return u.attrs={x:n,y:o,width:c,height:l,r:d||0,rx:d||0,ry:d||0,fill:"none",stroke:"#000"},u.type="rect",D(f,u.attrs),u},Fe=function(r,n,o,c,l){var d=D("ellipse");r.canvas&&r.canvas[O](d);var f=new K(d,r);return f.attrs={cx:n,cy:o,rx:c,ry:l,fill:"none",stroke:"#000"},f.type="ellipse",D(d,f.attrs),f},Be=function(r,n,o,c,l,d,f="none"){var u=D("image");D(u,{x:o,y:c,width:l,height:d,preserveAspectRatio:f}),u.setAttributeNS(r.xlink,"href",n),r.canvas&&r.canvas[O](u);var _=new K(u,r);return _.attrs={x:o,y:c,width:l,height:d,src:n},_.type="image",_},Ce=function(r,n,o,c){var l=D("text");D(l,{x:n,y:o,"text-anchor":"middle"}),r.canvas&&r.canvas[O](l);var d=new K(l,r);return d.attrs={x:n,y:o,"text-anchor":"middle",text:c,font:zt.font,stroke:"none",fill:"#000"},d.type="text",Nt(d,d.attrs),d},De=function(r,n){return this.width=r||this.width,this.height=n||this.height,this.canvas[ft]("width",this.width),this.canvas[ft]("height",this.height),this},ce=function(){var r=ve[U](0,arguments),n=r&&r.container,o=r.x,c=r.y,l=r.width,d=r.height;if(!n)throw new Error("SVG container not found.");var f=D("svg");return o=o||0,c=c||0,l=l||512,d=d||342,D(f,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:l,height:d}),n==1?(f.style.cssText="position:absolute;left:"+o+"px;top:"+c+"px",T.body[O](f)):n.firstChild?n.insertBefore(f,n.firstChild):n[O](f),n=new w,n.width=l,n.height=d,n.canvas=f,oe.call(n,n,i.fn),n.clear(),n};S.clear=function(){for(var r=this.canvas;r.firstChild;)r.removeChild(r.firstChild);this.bottom=this.top=null,(this.desc=D("desc"))[O](T.createTextNode("Created with Raphaël")),r[O](this.desc),r[O](this.defs=D("defs"))},S.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var r in this)this[r]=be(r)}}if(i.vml){let r=function(n,o,c,l,d){return d?i.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",n+d,o,c-d*2,d,-d,l-d*2,d*2-c,d*2-l):i.format("M{0},{1}l{2},0,0,{3},{4},0z",n,o,c,l,-c)};var ke={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},fi=/([clmz]),?([^clmz]*)/gi,_i=/ progid:\S+Blur\([^\)]+\)/g,mi=/-?[^,\s-]+/g,Yt=1e3+z+1e3,wt=10,Ht={path:1,rect:1},pi=function(n){var o=/[ahqstv]/ig,c=Dt;if(H(n).match(o)&&(c=Qt),o=/[clmz]/g,c==Dt&&!H(n).match(o)){var l=H(n)[at](fi,function(I,R,N){var y=[],x=Tt.call(R)=="m",C=ke[R];return N[at](mi,function(B){x&&y[L]==2&&(C+=y+ke[R=="m"?"l":"L"],y=[]),y[J](st(B*wt))}),C+y});return l}var d=c(n),f,u;l=[];for(var _=0,p=d[L];_<p;_++){f=d[_],u=Tt.call(d[_][0]),u=="z"&&(u="x");for(var E=1,A=f[L];E<A;E++)u+=st(f[E]*wt)+(E!=A-1?",":M);l[J](u)}return l[tt](z)};i[Et]=function(){return`Your browser doesn’t support SVG. Falling down to VML.
You are running Raphaël `+this.version},Le=function(n,o){var c=ot("group");c.style.cssText="position:absolute;left:0;top:0;width:"+o.width+"px;height:"+o.height+"px",c.coordsize=o.coordsize,c.coordorigin=o.coordorigin;var l=ot("shape"),d=l.style;d.width=o.width+"px",d.height=o.height+"px",l.coordsize=Yt,l.coordorigin=o.coordorigin,c[O](l);var f=new K(l,c,o),u={fill:"none",stroke:"#000"};return n&&(u.path=n),f.type="path",f.path=[],f.Path=M,Nt(f,u),o.canvas[O](c),f},Nt=function(n,o){n.attrs=n.attrs||{};var c=n.node,l=n.attrs,d=c.style,f,u=(o.x!=l.x||o.y!=l.y||o.width!=l.width||o.height!=l.height||o.r!=l.r)&&n.type=="rect",_=n;for(var p in o)o[m](p)&&(l[p]=o[p]);if(u&&(l.path=r(l.x,l.y,l.width,l.height,l.r),n.X=l.x,n.Y=l.y,n.W=l.width,n.H=l.height),o.href&&(c.href=o.href),o.title&&(c.title=o.title),o.target&&(c.target=o.target),o.cursor&&(d.cursor=o.cursor),"blur"in o&&n.blur(o.blur),(o.path&&n.type=="path"||u)&&(c.path=pi(l.path)),o.rotation!=null&&n.rotate(o.rotation,!0),o.translation&&(f=H(o.translation)[Q](t),te.call(n,f[0],f[1]),n._.rt.cx!=null&&(n._.rt.cx+=+f[0],n._.rt.cy+=+f[1],n.setBox(n.attrs,f[0],f[1]))),o.scale&&(f=H(o.scale)[Q](t),n.scale(+f[0]||1,+f[1]||+f[0]||1,+f[2]||null,+f[3]||null)),"clip-rect"in o){var E=H(o["clip-rect"])[Q](t);if(E[L]==4){E[2]=+E[2]+ +E[0],E[3]=+E[3]+ +E[1];var A=c.clipRect||T.createElement("div"),I=A.style,R=c.parentNode;I.clip=i.format("rect({1}px {2}px {3}px {0}px)",E),c.clipRect||(I.position="absolute",I.top=0,I.left=0,I.width=n.paper.width+"px",I.height=n.paper.height+"px",R.parentNode.insertBefore(A,R),A[O](R),c.clipRect=A)}o["clip-rect"]||c.clipRect&&(c.clipRect.style.clip=M)}if(n.type=="image"&&o.src&&(c.src=o.src),n.type=="image"&&o.opacity&&(c.filterOpacity=ie+".Alpha(opacity="+o.opacity*100+")",d.filter=(c.filterMatrix||M)+(c.filterOpacity||M)),o.font&&(d.font=o.font),o["font-family"]&&(d.fontFamily='"'+o["font-family"][Q](",")[0][at](/^['"]+|['"]+$/g,M)+'"'),o["font-size"]&&(d.fontSize=o["font-size"]),o["font-weight"]&&(d.fontWeight=o["font-weight"]),o["font-style"]&&(d.fontStyle=o["font-style"]),o.opacity!=null||o["stroke-width"]!=null||o.fill!=null||o.stroke!=null||o["stroke-width"]!=null||o["stroke-opacity"]!=null||o["fill-opacity"]!=null||o["stroke-dasharray"]!=null||o["stroke-miterlimit"]!=null||o["stroke-linejoin"]!=null||o["stroke-linecap"]!=null){c=n.shape||c;var N=c.getElementsByTagName(yt)&&c.getElementsByTagName(yt)[0],y=!1;if(!N&&(y=N=ot(yt)),"fill-opacity"in o||"opacity"in o){var x=((+l["fill-opacity"]+1||2)-1)*((+l.opacity+1||2)-1)*((+i.getRGB(o.fill).o+1||2)-1);x=gt(it(x,0),1),N.opacity=x}if(o.fill&&(N.on=!0),(N.on==null||o.fill=="none")&&(N.on=!1),N.on&&o.fill){var C=o.fill.match(Te);C?(N.src=C[1],N.type="tile"):(N.color=i.getRGB(o.fill).hex,N.src=M,N.type="solid",i.getRGB(o.fill).error&&(_.type in{circle:1,ellipse:1}||H(o.fill).charAt()!="r")&&Gt(_,o.fill)&&(l.fill="none",l.gradient=o.fill))}y&&c[O](N);var B=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],Y=!1;!B&&(Y=B=ot("stroke")),(o.stroke&&o.stroke!="none"||o["stroke-width"]||o["stroke-opacity"]!=null||o["stroke-dasharray"]||o["stroke-miterlimit"]||o["stroke-linejoin"]||o["stroke-linecap"])&&(B.on=!0),(o.stroke=="none"||B.on==null||o.stroke==0||o["stroke-width"]==0)&&(B.on=!1);var k=i.getRGB(o.stroke);B.on&&o.stroke&&(B.color=k.hex),x=((+l["stroke-opacity"]+1||2)-1)*((+l.opacity+1||2)-1)*((+k.o+1||2)-1);var q=(V(o["stroke-width"])||1)*.75;if(x=gt(it(x,0),1),o["stroke-width"]==null&&(q=l["stroke-width"]),o["stroke-width"]&&(B.weight=q),q&&q<1&&(x*=q)&&(B.weight=1),B.opacity=x,o["stroke-linejoin"]&&(B.joinstyle=o["stroke-linejoin"]||"miter"),B.miterlimit=o["stroke-miterlimit"]||8,o["stroke-linecap"]&&(B.endcap=o["stroke-linecap"]=="butt"?"flat":o["stroke-linecap"]=="square"?"square":"round"),o["stroke-dasharray"]){var Z={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};B.dashstyle=Z[m](o["stroke-dasharray"])?Z[o["stroke-dasharray"]]:M}Y&&c[O](B)}if(_.type=="text")switch(d=_.paper.span.style,l.font&&(d.font=l.font),l["font-family"]&&(d.fontFamily=l["font-family"]),l["font-size"]&&(d.fontSize=l["font-size"]),l["font-weight"]&&(d.fontWeight=l["font-weight"]),l["font-style"]&&(d.fontStyle=l["font-style"]),_.node.string&&(_.paper.span.innerHTML=H(_.node.string)[at](/</g,"&#60;")[at](/&/g,"&#38;")[at](/\n/g,"<br>")),_.W=l.w=_.paper.span.offsetWidth,_.H=l.h=_.paper.span.offsetHeight,_.X=l.x,_.Y=l.y+st(_.H/2),l["text-anchor"]){case"start":_.node.style["v-text-align"]="left",_.bbx=st(_.W/2);break;case"end":_.node.style["v-text-align"]="right",_.bbx=-st(_.W/2);break;default:_.node.style["v-text-align"]="center";break}},Gt=function(n,o){n.attrs=n.attrs||{},n.attrs;var c,l="linear",d=".5 .5";if(n.attrs.gradient=o,o=H(o)[at](Ee,function(A,I,R){return l="radial",I&&R&&(I=V(I),R=V(R),W(I-.5,2)+W(R-.5,2)>.25&&(R=P.sqrt(.25-W(I-.5,2))*((R>.5)*2-1)+.5),d=I+z+R),M}),o=o[Q](/\s*\-\s*/),l=="linear"){var f=o.shift();if(f=-V(f),isNaN(f))return null}var u=Oe(o);if(!u)return null;if(n=n.shape||n.node,c=n.getElementsByTagName(yt)[0]||ot(yt),!c.parentNode&&n.appendChild(c),u[L]){c.on=!0,c.method="none",c.color=u[0].color,c.color2=u[u[L]-1].color;for(var _=[],p=0,E=u[L];p<E;p++)u[p].offset&&_[J](u[p].offset+z+u[p].color);c.colors&&(c.colors.value=_[L]?_[tt]():"0% "+c.color),l=="radial"?(c.type="gradientradial",c.focus="100%",c.focussize=d,c.focusposition=d):(c.type="gradient",c.angle=(270-f)%360)}return 1},K=function(n,o,c){this[0]=n,this.id=i._oid++,this.node=n,n.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=o,this.paper=c,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},j=K[h],j.rotate=function(n,o,c){return this.removed?this:n==null?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][tt](z):this._.rt.deg:(n=H(n)[Q](t),n[L]-1&&(o=V(n[1]),c=V(n[2])),n=V(n[0]),o!=null?this._.rt.deg=n:this._.rt.deg+=n,c==null&&(o=null),this._.rt.cx=o,this._.rt.cy=c,this.setBox(this.attrs,o,c),this.Group.style.rotation=this._.rt.deg,this)},j.setBox=function(n,o,c){if(this.removed)return this;var l=this.Group.style,d=this.shape&&this.shape.style||this.node.style;n=n||{};for(var f in n)n[m](f)&&(this.attrs[f]=n[f]);o=o||this._.rt.cx,c=c||this._.rt.cy;var u=this.attrs,_,p,E,A;switch(this.type){case"circle":_=u.cx-u.r,p=u.cy-u.r,E=A=u.r*2;break;case"ellipse":_=u.cx-u.rx,p=u.cy-u.ry,E=u.rx*2,A=u.ry*2;break;case"image":_=+u.x,p=+u.y,E=u.width||0,A=u.height||0;break;case"text":this.textpath.v=["m",st(u.x),", ",st(u.y-2),"l",st(u.x)+1,", ",st(u.y-2)][tt](M),_=u.x-st(this.W/2),p=u.y-this.H/2,E=this.W,A=this.H;break;case"rect":case"path":if(this.attrs.path){var I=jt(this.attrs.path);_=I.x,p=I.y,E=I.width,A=I.height}else _=0,p=0,E=this.paper.width,A=this.paper.height;break;default:_=0,p=0,E=this.paper.width,A=this.paper.height;break}o=o??_+E/2,c=c??p+A/2;var R=o-this.paper.width/2,N=c-this.paper.height/2,y;l.left!=(y=R+"px")&&(l.left=y),l.top!=(y=N+"px")&&(l.top=y),this.X=Ht[m](this.type)?-R:_,this.Y=Ht[m](this.type)?-N:p,this.W=E,this.H=A,Ht[m](this.type)?(d.left!=(y=-R*wt+"px")&&(d.left=y),d.top!=(y=-N*wt+"px")&&(d.top=y)):this.type=="text"?(d.left!=(y=-R+"px")&&(d.left=y),d.top!=(y=-N+"px")&&(d.top=y)):(l.width!=(y=this.paper.width+"px")&&(l.width=y),l.height!=(y=this.paper.height+"px")&&(l.height=y),d.left!=(y=_-R+"px")&&(d.left=y),d.top!=(y=p-N+"px")&&(d.top=y),d.width!=(y=E+"px")&&(d.width=y),d.height!=(y=A+"px")&&(d.height=y))},j.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},j.show=function(){return!this.removed&&(this.Group.style.display="block"),this},j.getBBox=function(){return this.removed?this:Ht[m](this.type)?jt(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},j.remove=function(){if(!this.removed){Ut(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var n in this)delete this[n];this.removed=!0}},j.attr=function(n,o){if(this.removed)return this;if(n==null){var c={};for(var l in this.attrs)this.attrs[m](l)&&(c[l]=this.attrs[l]);return this._.rt.deg&&(c.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(c.scale=this.scale()),c.gradient&&c.fill=="none"&&(c.fill=c.gradient)&&delete c.gradient,c}if(o==null&&i.is(n,"string"))return n=="translation"?te.call(this):n=="rotation"?this.rotate():n=="scale"?this.scale():n==yt&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[n];if(this.attrs&&o==null&&i.is(n,ut)){var d,f={};for(l=0,d=n[L];l<d;l++)f[n[l]]=this.attr(n[l]);return f}var u;if(o!=null&&(u={},u[n]=o),o==null&&i.is(n,"object")&&(u=n),u){for(var _ in this.paper.customAttributes)if(this.paper.customAttributes[m](_)&&u[m](_)&&i.is(this.paper.customAttributes[_],"function")){var p=this.paper.customAttributes[_].apply(this,[][F](u[_]));this.attrs[_]=u[_];for(var E in p)p[m](E)&&(u[E]=p[E])}u.text&&this.type=="text"&&(this.node.string=u.text),Nt(this,u),u.gradient&&({circle:1,ellipse:1}[m](this.type)||H(u.gradient).charAt()!="r")&&Gt(this,u.gradient),(!Ht[m](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},j.toFront=function(){return!this.removed&&this.Group.parentNode[O](this.Group),this.paper.top!=this&&Ne(this,this.paper),this},j.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Ie(this,this.paper)),this)},j.insertAfter=function(n){return this.removed?this:(n.constructor==dt&&(n=n[n.length-1]),n.Group.nextSibling?n.Group.parentNode.insertBefore(this.Group,n.Group.nextSibling):n.Group.parentNode[O](this.Group),Ae(this,n,this.paper),this)},j.insertBefore=function(n){return this.removed?this:(n.constructor==dt&&(n=n[0]),n.Group.parentNode.insertBefore(this.Group,n.Group),Re(this,n,this.paper),this)},j.blur=function(n){var o=this.node.runtimeStyle,c=o.filter;c=c.replace(_i,M),+n!=0?(this.attrs.blur=n,o.filter=c+z+ie+".Blur(pixelradius="+(+n||1.5)+")",o.margin=i.format("-{0}px 0 0 -{0}px",st(+n||1.5))):(o.filter=c,o.margin=0,delete this.attrs.blur)},we=function(n,o,c,l){var d=ot("group"),f=ot("oval");f.style,d.style.cssText="position:absolute;left:0;top:0;width:"+n.width+"px;height:"+n.height+"px",d.coordsize=Yt,d.coordorigin=n.coordorigin,d[O](f);var u=new K(f,d,n);return u.type="circle",Nt(u,{stroke:"#000",fill:"none"}),u.attrs.cx=o,u.attrs.cy=c,u.attrs.r=l,u.setBox({x:o-l,y:c-l,width:l*2,height:l*2}),n.canvas[O](d),u},Me=function(n,o,c,l,d,f){var u=r(o,c,l,d,f),_=n.path(u),p=_.attrs;return _.X=p.x=o,_.Y=p.y=c,_.W=p.width=l,_.H=p.height=d,p.r=f,p.path=u,_.type="rect",_},Fe=function(n,o,c,l,d){var f=ot("group"),u=ot("oval");u.style,f.style.cssText="position:absolute;left:0;top:0;width:"+n.width+"px;height:"+n.height+"px",f.coordsize=Yt,f.coordorigin=n.coordorigin,f[O](u);var _=new K(u,f,n);return _.type="ellipse",Nt(_,{stroke:"#000"}),_.attrs.cx=o,_.attrs.cy=c,_.attrs.rx=l,_.attrs.ry=d,_.setBox({x:o-l,y:c-d,width:l*2,height:d*2}),n.canvas[O](f),_},Be=function(n,o,c,l,d,f){var u=ot("group"),_=ot("image");u.style.cssText="position:absolute;left:0;top:0;width:"+n.width+"px;height:"+n.height+"px",u.coordsize=Yt,u.coordorigin=n.coordorigin,_.src=o,u[O](_);var p=new K(_,u,n);return p.type="image",p.attrs.src=o,p.attrs.x=c,p.attrs.y=l,p.attrs.w=d,p.attrs.h=f,p.setBox({x:c,y:l,width:d,height:f}),n.canvas[O](u),p},Ce=function(n,o,c,l){var d=ot("group"),f=ot("shape"),u=f.style,_=ot("path");_.style;var p=ot("textpath");d.style.cssText="position:absolute;left:0;top:0;width:"+n.width+"px;height:"+n.height+"px",d.coordsize=Yt,d.coordorigin=n.coordorigin,_.v=i.format("m{0},{1}l{2},{1}",st(o*10),st(c*10),st(o*10)+1),_.textpathok=!0,u.width=n.width,u.height=n.height,p.string=H(l),p.on=!0,f[O](p),f[O](_),d[O](f);var E=new K(p,d,n);return E.shape=f,E.textpath=_,E.type="text",E.attrs.text=l,E.attrs.x=o,E.attrs.y=c,E.attrs.w=1,E.attrs.h=1,Nt(E,{font:zt.font,stroke:"none",fill:"#000"}),E.setBox(),n.canvas[O](d),E},De=function(n,o){var c=this.canvas.style;return n==+n&&(n+="px"),o==+o&&(o+="px"),c.width=n,c.height=o,c.clip="rect(0 "+n+" "+o+" 0)",this};var ot;T.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!T.namespaces.rvml&&T.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ot=function(n){return T.createElement("<rvml:"+n+' class="rvml">')}}catch{ot=function(n){return T.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}ce=function(){var n=ve[U](0,arguments),o=n.container,c=n.height,l=n.width,d=n.x,f=n.y;if(!o)throw new Error("VML container not found.");var u=new w,_=u.canvas=T.createElement("div"),p=_.style;return d=d||0,f=f||0,l=l||512,c=c||342,l==+l&&(l+="px"),c==+c&&(c+="px"),u.width=1e3,u.height=1e3,u.coordsize=wt*1e3+z+wt*1e3,u.coordorigin="0 0",u.span=T.createElement("span"),u.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",_[O](u.span),p.cssText=i.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",l,c),o==1?(T.body[O](_),p.left=d+"px",p.top=f+"px",p.position="absolute"):o.firstChild?o.insertBefore(_,o.firstChild):o[O](_),oe.call(u,u,i.fn),u},S.clear=function(){this.canvas.innerHTML=M,this.span=T.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[O](this.span),this.bottom=this.top=null},S.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=be(n);return!0}}var Ge=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(Ge&&Ge[1]<4||navigator.platform.slice(0,2)=="iP")?S.safari=function(){var r=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});v.setTimeout(function(){r.remove()})}:S.safari=function(){};for(var Ti=function(){this.returnValue=!1},Ei=function(){return this.originalEvent.preventDefault()},Si=function(){this.cancelBubble=!0},xi=function(){return this.originalEvent.stopPropagation()},yi=function(){{if(T.addEventListener)return function(r,n,o,c){var l=X&&Ct[n]?Ct[n]:n,d=function(f){if(X&&Ct[m](n)){for(var u=0,_=f.targetTouches&&f.targetTouches.length;u<_;u++)if(f.targetTouches[u].target==r){var p=f;f=f.targetTouches[u],f.originalEvent=p,f.preventDefault=Ei,f.stopPropagation=xi;break}}return o.call(c,f)};return r.addEventListener(l,d,!1),function(){return r.removeEventListener(l,d,!1),!0}};if(T.attachEvent)return function(r,n,o,c){var l=function(f){return f=f||v.event,f.preventDefault=f.preventDefault||Ti,f.stopPropagation=f.stopPropagation||Si,o.call(c,f)};r.attachEvent("on"+n,l);var d=function(){return r.detachEvent("on"+n,l),!0};return d}}}(),mt=[],le=function(r){for(var n=r.clientX,o=r.clientY,c=T.documentElement.scrollTop||T.body.scrollTop,l=T.documentElement.scrollLeft||T.body.scrollLeft,d,f=mt.length;f--;){if(d=mt[f],X){for(var u=r.touches.length,_;u--;)if(_=r.touches[u],_.identifier==d.el._drag.id){n=_.clientX,o=_.clientY,(r.originalEvent?r.originalEvent:r).preventDefault();break}}else r.preventDefault();n+=l,o+=c,d.move&&d.move.call(d.move_scope||d.el,n-d.el._drag.x,o-d.el._drag.y,n,o,r)}},ue=function(r){i.unmousemove(le).unmouseup(ue);for(var n=mt.length,o;n--;)o=mt[n],o.el._drag={},o.end&&o.end.call(o.end_scope||o.start_scope||o.move_scope||o.el,r);mt=[]},Ye=Bt[L];Ye--;)(function(r){i[r]=K[h][r]=function(n,o){return i.is(n,"function")&&(this.events=this.events||[],this.events.push({name:r,f:n,unbind:yi(this.shape||this.node||T,r,n,o||this)})),this},i["un"+r]=K[h]["un"+r]=function(n){for(var o=this.events,c=o[L];c--;)if(o[c].name==r&&o[c].f==n)return o[c].unbind(),o.splice(c,1),!o.length&&delete this.events,this;return this}})(Bt[Ye]);j.hover=function(r,n,o,c){return this.mouseover(r,o).mouseout(n,c||o)},j.unhover=function(r,n){return this.unmouseover(r).unmouseout(n)},j.drag=function(r,n,o,c,l,d){return this._drag={},this.mousedown(function(f){(f.originalEvent||f).preventDefault();var u=T.documentElement.scrollTop||T.body.scrollTop,_=T.documentElement.scrollLeft||T.body.scrollLeft;this._drag.x=f.clientX+_,this._drag.y=f.clientY+u,this._drag.id=f.identifier,n&&n.call(l||c||this,f.clientX+_,f.clientY+u,f),!mt.length&&i.mousemove(le).mouseup(ue),mt.push({el:this,move:r,end:o,move_scope:c,start_scope:l,end_scope:d})}),this},j.undrag=function(r,n,o){for(var c=mt.length;c--;)mt[c].el==this&&mt[c].move==r&&mt[c].end==o&&mt.splice(c++,1);!mt.length&&i.unmousemove(le).unmouseup(ue)},S.circle=function(r,n,o){return we(this,r||0,n||0,o||0)},S.rect=function(r,n,o,c,l){return Me(this,r||0,n||0,o||0,c||0,l||0)},S.ellipse=function(r,n,o,c){return Fe(this,r||0,n||0,o||0,c||0)},S.path=function(r){return r&&!i.is(r,It)&&!i.is(r[0],ut)&&(r+=M),Le(i.format[U](i,arguments),this)},S.image=function(r,n,o,c,l,d){return Be(this,r||"about:blank",n||0,o||0,c||0,l||0,d)},S.text=function(r,n,o){return Ce(this,r||0,n||0,H(o))},S.set=function(r){return arguments[L]>1&&(r=Array[h].splice.call(arguments,0,arguments[L])),new dt(r)},S.setSize=De,S.top=S.bottom=null,S.raphael=i;function He(){return this.x+z+this.y}j.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},j.scale=function(r,n,o,c){if(this.removed)return this;if(r==null&&n==null)return{x:this._.sx,y:this._.sy,toString:He};n=n||r,!+n&&(n=r);var l,d,f=this.attrs;if(r!=0){var u=this.getBBox(),_=u.x+u.width/2,p=u.y+u.height/2,E=et(r/this._.sx),A=et(n/this._.sy);o=+o||o==0?o:_,c=+c||c==0?c:p;var I=this._.sx>0,R=this._.sy>0,N=~~(r/et(r)),y=~~(n/et(n)),x=E*N,C=A*y,B=this.node.style,Y=o+et(_-o)*x*(_>o==I?1:-1),k=c+et(p-c)*C*(p>c==R?1:-1),q=r*N>n*y?A:E;switch(this.type){case"rect":case"image":var Z=f.width*E,$=f.height*A;this.attr({height:$,r:f.r*q,width:Z,x:Y-Z/2,y:k-$/2});break;case"circle":case"ellipse":this.attr({rx:f.rx*E,ry:f.ry*A,r:f.r*q,cx:Y,cy:k});break;case"text":this.attr({x:Y,y:k});break;case"path":for(var G=re(f.path),ht=!0,rt=I?x:E,xt=R?C:A,vt=0,At=G[L];vt<At;vt++){var ct=G[vt],Mt=Xt.call(ct[0]);{if(Mt=="M"&&ht)continue;ht=!1}if(Mt=="A")ct[G[vt][L]-2]*=rt,ct[G[vt][L]-1]*=xt,ct[1]*=E,ct[2]*=A,ct[5]=+(N+y?!!+ct[5]:!+ct[5]);else if(Mt=="H")for(var _t=1,Rt=ct[L];_t<Rt;_t++)ct[_t]*=rt;else if(Mt=="V")for(_t=1,Rt=ct[L];_t<Rt;_t++)ct[_t]*=xt;else for(_t=1,Rt=ct[L];_t<Rt;_t++)ct[_t]*=_t%2?rt:xt}var Lt=jt(G);l=Y-Lt.x-Lt.width/2,d=k-Lt.y-Lt.height/2,G[0][1]+=l,G[0][2]+=d,this.attr({path:G});break}this.type in{text:1,image:1}&&(N!=1||y!=1)?this.transformations?(this.transformations[2]="scale("[F](N,",",y,")"),this.node[ft]("transform",this.transformations[tt](z)),l=N==-1?-f.x-(Z||0):f.x,d=y==-1?-f.y-($||0):f.y,this.attr({x:l,y:d}),f.fx=N-1,f.fy=y-1):(this.node.filterMatrix=ie+".Matrix(M11="[F](N,", M12=0, M21=0, M22=",y,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),B.filter=(this.node.filterMatrix||M)+(this.node.filterOpacity||M)):this.transformations?(this.transformations[2]=M,this.node[ft]("transform",this.transformations[tt](z)),f.fx=0,f.fy=0):(this.node.filterMatrix=M,B.filter=(this.node.filterMatrix||M)+(this.node.filterOpacity||M)),f.scale=[r,n,o,c][tt](z),this._.sx=r,this._.sy=n}return this},j.clone=function(){if(this.removed)return null;var r=this.attr();return delete r.scale,delete r.translation,this.paper[this.type]().attr(r)};var de={},Jt=function(r,n,o,c,l,d,f,u,_){var p=0,E=100,A=[r,n,o,c,l,d,f,u].join(),I=de[A],R,N;if(!I&&(de[A]=I={data:[]}),I.timer&&clearTimeout(I.timer),I.timer=setTimeout(function(){delete de[A]},2e3),_!=null){var y=Jt(r,n,o,c,l,d,f,u);E=~~y*10}for(var x=0;x<E+1;x++){if(I.data[_]>x?N=I.data[x*E]:(N=i.findDotsAtSegment(r,n,o,c,l,d,f,u,x/E),I.data[x]=N),x&&(p+=W(W(R.x-N.x,2)+W(R.y-N.y,2),.5)),_!=null&&p>=_)return N;R=N}if(_==null)return p},ge=function(r,n){return function(o,c,l){o=Qt(o);for(var d,f,u,_,p="",E={},A,I=0,R=0,N=o.length;R<N;R++){if(u=o[R],u[0]=="M")d=+u[1],f=+u[2];else{if(_=Jt(d,f,u[1],u[2],u[3],u[4],u[5],u[6]),I+_>c){if(n&&!E.start){if(A=Jt(d,f,u[1],u[2],u[3],u[4],u[5],u[6],c-I),p+=["C",A.start.x,A.start.y,A.m.x,A.m.y,A.x,A.y],l)return p;E.start=p,p=["M",A.x,A.y+"C",A.n.x,A.n.y,A.end.x,A.end.y,u[5],u[6]][tt](),I+=_,d=+u[5],f=+u[6];continue}if(!r&&!n)return A=Jt(d,f,u[1],u[2],u[3],u[4],u[5],u[6],c-I),{x:A.x,y:A.y,alpha:A.alpha}}I+=_,d=+u[5],f=+u[6]}p+=u}return E.end=p,A=r?I:n?E:i.findDotsAtSegment(d,f,u[1],u[2],u[3],u[4],u[5],u[6],1),A.alpha&&(A={x:A.x,y:A.y,alpha:A.alpha}),A}},Xe=ge(1),$t=ge(),fe=ge(0,1);j.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():Xe(this.attrs.path)},j.getPointAtLength=function(r){if(this.type=="path")return $t(this.attrs.path,r)},j.getSubpath=function(r,n){if(this.type=="path"){if(et(this.getTotalLength()-n)<"1e-6")return fe(this.attrs.path,r).end;var o=fe(this.attrs.path,n,1);return r?fe(o,r).end:o}},i.easing_formulas={linear:function(r){return r},"<":function(r){return W(r,3)},">":function(r){return W(r-1,3)+1},"<>":function(r){return r=r*2,r<1?W(r,3)/2:(r-=2,(W(r,3)+2)/2)},backIn:function(r){var n=1.70158;return r*r*((n+1)*r-n)},backOut:function(r){r=r-1;var n=1.70158;return r*r*((n+1)*r+n)+1},elastic:function(r){if(r==0||r==1)return r;var n=.3,o=n/4;return W(2,-10*r)*P.sin((r-o)*(2*lt)/n)+1},bounce:function(r){var n=7.5625,o=2.75,c;return r<1/o?c=n*r*r:r<2/o?(r-=1.5/o,c=n*r*r+.75):r<2.5/o?(r-=2.25/o,c=n*r*r+.9375):(r-=2.625/o,c=n*r*r+.984375),c}};var pt=[],ze=function(){for(var r=+new Date,n=0;n<pt[L];n++){var o=pt[n];if(!(o.stop||o.el.removed)){var c=r-o.start,l=o.ms,d=o.easing,f=o.from,u=o.diff,_=o.to,p=o.t,E=o.el,A={},I;if(c<l){var R=d(c/l);for(var N in f)if(f[m](N)){switch(ne[N]){case"along":I=R*l*u[N],_.back&&(I=_.len-I);var y=$t(_[N],I);E.translate(u.sx-u.x||0,u.sy-u.y||0),u.x=y.x,u.y=y.y,E.translate(y.x-u.sx,y.y-u.sy),_.rot&&E.rotate(u.r+y.alpha,y.x,y.y);break;case nt:I=+f[N]+R*l*u[N];break;case"colour":I="rgb("+[_e(st(f[N].r+R*l*u[N].r)),_e(st(f[N].g+R*l*u[N].g)),_e(st(f[N].b+R*l*u[N].b))][tt](",")+")";break;case"path":I=[];for(var x=0,C=f[N][L];x<C;x++){I[x]=[f[N][x][0]];for(var B=1,Y=f[N][x][L];B<Y;B++)I[x][B]=+f[N][x][B]+R*l*u[N][x][B];I[x]=I[x][tt](z)}I=I[tt](z);break;case"csv":switch(N){case"translation":var k=R*l*u[N][0]-p.x,q=R*l*u[N][1]-p.y;p.x+=k,p.y+=q,I=k+z+q;break;case"rotation":I=+f[N][0]+R*l*u[N][0],f[N][1]&&(I+=","+f[N][1]+","+f[N][2]);break;case"scale":I=[+f[N][0]+R*l*u[N][0],+f[N][1]+R*l*u[N][1],2 in _[N]?_[N][2]:M,3 in _[N]?_[N][3]:M][tt](z);break;case"clip-rect":for(I=[],x=4;x--;)I[x]=+f[N][x]+R*l*u[N][x];break}break;default:var Z=[].concat(f[N]);for(I=[],x=E.paper.customAttributes[N].length;x--;)I[x]=+Z[x]+R*l*u[N][x];break}A[N]=I}E.attr(A),E._run&&E._run.call(E)}else _.along&&(y=$t(_.along,_.len*!_.back),E.translate(u.sx-(u.x||0)+y.x-u.sx,u.sy-(u.y||0)+y.y-u.sy),_.rot&&E.rotate(u.r+y.alpha,y.x,y.y)),(p.x||p.y)&&E.translate(-p.x,-p.y),_.scale&&(_.scale+=M),E.attr(_),pt.splice(n--,1)}}i.svg&&E&&E.paper&&E.paper.safari(),pt[L]&&setTimeout(ze)},Oi=function(r,n,o,c,l){var d=o-c;n.timeouts.push(setTimeout(function(){i.is(l,"function")&&l.call(n),n.animate(r,d,r.easing)},c))},_e=function(r){return it(gt(r,255),0)},te=function(r,n){if(r==null)return{x:this._.tx,y:this._.ty,toString:He};switch(this._.tx+=+r,this._.ty+=+n,this.type){case"circle":case"ellipse":this.attr({cx:+r+this.attrs.cx,cy:+n+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+r+this.attrs.x,y:+n+this.attrs.y});break;case"path":var o=re(this.attrs.path);o[0][1]+=+r,o[0][2]+=+n,this.attr({path:o});break}return this};j.animateWith=function(r,n,o,c,l){for(var d=0,f=pt.length;d<f;d++)pt[d].el.id==r.id&&(n.start=pt[d].start);return this.animate(n,o,c,l)},j.animateAlong=We(),j.animateAlongBack=We(1);function We(r){return function(n,o,c,l){var d={back:r};return i.is(c,"function")?l=c:d.rot=c,n&&n.constructor==K&&(n=n.attrs.path),n&&(d.along=n),this.animate(d,o,l)}}function vi(r,n,o,c,l,d){var f=3*n,u=3*(c-n)-f,_=1-f-u,p=3*o,E=3*(l-o)-p,A=1-p-E;function I(y){return((_*y+u)*y+f)*y}function R(y,x){var C=N(y,x);return((A*C+E)*C+p)*C}function N(y,x){var C,B,Y,k,q,Z;for(Y=y,Z=0;Z<8;Z++){if(k=I(Y)-y,et(k)<x)return Y;if(q=(3*_*Y+2*u)*Y+f,et(q)<1e-6)break;Y=Y-k/q}if(C=0,B=1,Y=y,Y<C)return C;if(Y>B)return B;for(;C<B;){if(k=I(Y),et(k-y)<x)return Y;y>k?C=Y:B=Y,Y=(B-C)/2+C}return Y}return R(r,1/(200*d))}j.onAnimation=function(r){return this._run=r||0,this},j.animate=function(r,n,o,c){var l=this;if(l.timeouts=l.timeouts||[],(i.is(o,"function")||!o)&&(c=o||null),l.removed)return c&&c.call(l),l;var d={},f={},u=!1,_={};for(var p in r)if(r[m](p)&&(ne[m](p)||l.paper.customAttributes[m](p)))switch(u=!0,d[p]=l.attr(p),d[p]==null&&(d[p]=zt[p]),f[p]=r[p],ne[p]){case"along":var E=Xe(r[p]),A=$t(r[p],E*!!r.back),I=l.getBBox();_[p]=E/n,_.tx=I.x,_.ty=I.y,_.sx=A.x,_.sy=A.y,f.rot=r.rot,f.back=r.back,f.len=E,r.rot&&(_.r=V(l.rotate())||0);break;case nt:_[p]=(f[p]-d[p])/n;break;case"colour":d[p]=i.getRGB(d[p]);var R=i.getRGB(f[p]);_[p]={r:(R.r-d[p].r)/n,g:(R.g-d[p].g)/n,b:(R.b-d[p].b)/n};break;case"path":var N=Qt(d[p],f[p]);d[p]=N[0];var y=N[1];_[p]=[];for(var x=0,C=d[p][L];x<C;x++){_[p][x]=[0];for(var B=1,Y=d[p][x][L];B<Y;B++)_[p][x][B]=(y[x][B]-d[p][x][B])/n}break;case"csv":var k=H(r[p])[Q](t),q=H(d[p])[Q](t);switch(p){case"translation":d[p]=[0,0],_[p]=[k[0]/n,k[1]/n];break;case"rotation":d[p]=q[1]==k[1]&&q[2]==k[2]?q:[0,k[1],k[2]],_[p]=[(k[0]-d[p][0])/n,0,0];break;case"scale":r[p]=k,d[p]=H(d[p])[Q](t),_[p]=[(k[0]-d[p][0])/n,(k[1]-d[p][1])/n,0,0];break;case"clip-rect":for(d[p]=H(d[p])[Q](t),_[p]=[],x=4;x--;)_[p][x]=(k[x]-d[p][x])/n;break}f[p]=k;break;default:for(k=[].concat(r[p]),q=[].concat(d[p]),_[p]=[],x=l.paper.customAttributes[p][L];x--;)_[p][x]=((k[x]||0)-(q[x]||0))/n;break}if(u){var Z=i.easing_formulas[o];if(!Z)if(Z=H(o).match(ni),Z&&Z[L]==5){var $=Z;Z=function(xt){return vi(xt,+$[1],+$[2],+$[3],+$[4],n)}}else Z=function(xt){return xt};pt.push({start:r.start||+new Date,ms:n,easing:Z,from:d,diff:_,to:f,el:l,t:{x:0,y:0}}),i.is(c,"function")&&(l._ac=setTimeout(function(){c.call(l)},n)),pt[L]==1&&setTimeout(ze)}else{var G=[],ht;for(var rt in r)r[m](rt)&&si.test(rt)&&(p={value:r[rt]},rt=="from"&&(rt=0),rt=="to"&&(rt=100),p.key=Ot(rt,10),G.push(p));for(G.sort(ci),G[0].key&&G.unshift({key:0,value:l.attrs}),x=0,C=G[L];x<C;x++)Oi(G[x].value,l,n/100*G[x].key,n/100*(G[x-1]&&G[x-1].key||0),G[x-1]&&G[x-1].value.callback);ht=G[G[L]-1].value.callback,ht&&l.timeouts.push(setTimeout(function(){ht.call(l)},n))}return this},j.stop=function(){for(var r=0;r<pt.length;r++)pt[r].el.id==this.id&&pt.splice(r--,1);for(r=0,ii=this.timeouts&&this.timeouts.length;r<ii;r++)clearTimeout(this.timeouts[r]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},j.translate=function(r,n){return this.attr({translation:r+" "+n})},j[Et]=function(){return"Raphaël’s object"},i.ae=pt;var dt=function(r){if(this.items=[],this[L]=0,this.type="set",r)for(var n=0,o=r[L];n<o;n++)r[n]&&(r[n].constructor==K||r[n].constructor==dt)&&(this[this.items[L]]=this.items[this.items[L]]=r[n],this[L]++)};dt[h][J]=function(){for(var r,n,o=0,c=arguments[L];o<c;o++)r=arguments[o],r&&(r.constructor==K||r.constructor==dt)&&(n=this.items[L],this[n]=this.items[n]=r,this[L]++);return this},dt[h].pop=function(){return delete this[this[L]--],this.items.pop()};for(var me in j)j[m](me)&&(dt[h][me]=function(r){return function(){for(var n=0,o=this.items[L];n<o;n++)this.items[n][r][U](this.items[n],arguments);return this}}(me));dt[h].attr=function(r,n){if(r&&i.is(r,ut)&&i.is(r[0],"object"))for(var o=0,c=r[L];o<c;o++)this.items[o].attr(r[o]);else for(var l=0,d=this.items[L];l<d;l++)this.items[l].attr(r,n);return this},dt[h].animate=function(r,n,o,c){(i.is(o,"function")||!o)&&(c=o||null);var l=this.items[L],d=l,f,u=this,_;for(c&&(_=function(){!--l&&c.call(u)}),o=i.is(o,It)?o:_,f=this.items[--d].animate(r,n,o,_);d--;)this.items[d]&&!this.items[d].removed&&this.items[d].animateWith(f,r,n,o,_);return this},dt[h].insertAfter=function(r){for(var n=this.items[L];n--;)this.items[n].insertAfter(r);return this},dt[h].getBBox=function(){for(var r=[],n=[],o=[],c=[],l=this.items[L];l--;){var d=this.items[l].getBBox();r[J](d.x),n[J](d.y),o[J](d.x+d.width),c[J](d.y+d.height)}return r=gt[U](0,r),n=gt[U](0,n),{x:r,y:n,width:it[U](0,o)-r,height:it[U](0,c)-n}},dt[h].clone=function(r){r=new dt;for(var n=0,o=this.items[L];n<o;n++)r[J](this.items[n].clone());return r},i.registerFont=function(r){if(!r.face)return r;this.fonts=this.fonts||{};var n={w:r.w,face:{},glyphs:{}},o=r.face["font-family"];for(var c in r.face)r.face[m](c)&&(n.face[c]=r.face[c]);if(this.fonts[o]?this.fonts[o][J](n):this.fonts[o]=[n],!r.svg){n.face["units-per-em"]=Ot(r.face["units-per-em"],10);for(var l in r.glyphs)if(r.glyphs[m](l)){var d=r.glyphs[l];if(n.glyphs[l]={w:d.w,k:{},d:d.d&&"M"+d.d[at](/[mlcxtrv]/g,function(u){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[u]||"M"})+"z"},d.k)for(var f in d.k)d[m](f)&&(n.glyphs[l].k[f]=d.k[f])}}return r},S.getFont=function(r,n,o,c){if(c=c||"normal",o=o||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,!!i.fonts){var l=i.fonts[r];if(!l){var d=new RegExp("(^|\\s)"+r[at](/[^\w\d\s+!~.:_-]/g,M)+"(\\s|$)","i");for(var f in i.fonts)if(i.fonts[m](f)&&d.test(f)){l=i.fonts[f];break}}var u;if(l)for(var _=0,p=l[L];_<p&&(u=l[_],!(u.face["font-weight"]==n&&(u.face["font-style"]==o||!u.face["font-style"])&&u.face["font-stretch"]==c));_++);return u}},S.print=function(r,n,o,c,l,d,f){d=d||"middle",f=it(gt(f||0,1),-1);var u=this.set(),_=H(o)[Q](M),p=0,E;if(i.is(c,o)&&(c=this.getFont(c)),c){E=(l||16)/c.face["units-per-em"];for(var A=c.face.bbox.split(t),I=+A[0],R=+A[1]+(d=="baseline"?A[3]-A[1]+ +c.face.descent:(A[3]-A[1])/2),N=0,y=_[L];N<y;N++){var x=N&&c.glyphs[_[N-1]]||{},C=c.glyphs[_[N]];p+=N?(x.w||c.w)+(x.k&&x.k[_[N]]||0)+c.w*f:0,C&&C.d&&u[J](this.path(C.d).attr({fill:"#000",stroke:"none",translation:[p,0]}))}u.scale(E,E,I,R).translate(r-I,n-R)}return u},i.format=function(r,n){var o=i.is(n,ut)?[0][F](n):arguments;return r&&i.is(r,It)&&o[L]-1&&(r=r[at](s,function(c,l){return o[++l]==null?M:o[l]})),r||M},i.ninja=function(){return b.was?v.Raphael=b.is:window.Raphael=void 0,i},i.el=j,i.st=dt[h],b.was?v.Raphael=i:window.Raphael=i})();const FruitTypes={BOOM:"boom",FIRST:"first",SECOND:"second",THIRD:"third",FOURTH:"fourth",FIFTH:"fifth"},GameStates={PLAYING:"playing",OVER:"over"},InteractionModes={TOUCH:"touch",SLICE:"slice"},JuiceShapes={CIRCLE:"circle",SQUARE:"square",DIAMOND:"diamond",STAR:"star"},Layers={PRELOAD:"preload",DEFAULT:"default",FRUIT:"fruit",JUICE:"juice",MASK:"mask",LIGHT:"light",FLASH:"flash",KNIFE:"knife",START_SCREEN:"start-screen",RESULT_SCREEN:"result-screen",BRAND_INTRO:"brand-intro",BRAND_QUESTION:"brand-question"},Messages={CLICK:"click",SLICE:"slice",TOUCH:"touch",FRUIT_FALL_OFF:"fruit.fallOff",FRUIT_FALL_OUT_OF_VIEWER:"fruit.fallOutOfViewer",FRUIT_REMOVE:"fruit.remove",HOME_MENU:"home-menu",SCENE_SWITCH_SCENE:"scene.switchScene",GAME_OVER:"game.over",OVER_WHITE_LIGHT_SHOW:"overWhiteLight.show",SLICE_AT:"slice.at",TOUCH_AT:"touch.at",START_GAME:"start.game",VIBRATE:"vibrate",TOGGLE_SOUND:"toggle.sound"},Modes={SHOW:"show",HIDE:"hide"},Scenes={HOME_MENU:"home-menu",GAME_BODY:"game-body",GAME_OVER:"game-over",GAME_RESULT:"game-result",BRAND_INTRO:"brand-intro",BRAND_QUESTION:"brand-question"},SceneStates={READY:"ready",ENTERING:"entering",EXITING:"exiting"},SoundNames={BOOM:"boom",MENU:"menu",OVER:"over",SPLATTER:"splatter",START:"start",THROW:"throw"},StateKeys={CLICK_ENABLE:"click-enable",GAME_STATE:"game-state",SCENE_NAME:"scene-name",SCENE_STATE:"scene-state"},TextWeight={BOLD:"bold",NORMAL:"normal"},TextAnchor={MIDDLE:"middle",START:"start",END:"end"},MAX_VIEWPORT_HEIGHT=932,MAX_VIEWPORT_WIDTH=640,HORIZONTAL_BASE=393,VERTICAL_BASE=852,BASE_RESULT_CHARS_NUMBER=6,BACKGROUND_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/background.webp",BOTTOM_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/bottom.webp",BOTTOM_HEIGHT=139,BOTTOM_DURATION=1e3,BRAND_QUESTION_FILL="#fff",BRAND_QUESTION_ANIMATION_LENGTH=500,BRAND_ANSWER_BUTTON1_END_Y=531,BRAND_ANSWER_BUTTON1_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",BRAND_ANSWER_BUTTON1_WIDTH=325,BRAND_ANSWER_BUTTON1_HEIGHT=90,BRAND_ANSWER_BUTTON1_X=42,BRAND_ANSWER_TEXT1_VALUE="Нет",BRAND_ANSWER_TEXT1_SIZE=30,BRAND_ANSWER_BUTTON2_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",BRAND_ANSWER_BUTTON2_WIDTH=325,BRAND_ANSWER_BUTTON2_HEIGHT=90,BRAND_ANSWER_BUTTON2_X=42,BRAND_ANSWER_TEXT2_SIZE=30,BRAND_ANSWER_TEXT2_VALUE="Да",BRAND_INTRO_FILL="#fff",BRAND_INTRO_ANIMATION_LENGTH=500,BRAND_INTRO_BUTTON_X=42,BRAND_INTRO_BUTTON_END_Y=531,BRAND_INTRO_BUTTON_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",BRAND_INTRO_BUTTON_TEXT_SIZE=30,BRAND_INTRO_TEXT_VALUE=`Ответь на вопрос
Программы, чтобы
получить приз`,BRAND_INTRO_TEXT_SIZE=26,BRAND_INTRO_TEXT_START_Y=-400,BRAND_INTRO_TEXT_END_Y=250,BRAND_INTRO_BUTTON_HEIGHT=90,BRAND_INTRO_BUTTON_WIDTH=325,BRAND_INTRO_BUTTON_TEXT_VALUE="Ответить",BRAND_QUESTION_TEXT1_VALUE="",BRAND_QUESTION_TEXT1_SIZE=26,BRAND_QUESTION_TEXT1_Y=150,BRAND_QUESTION_TEXT2_VALUE=`Знаешь ли ты,
что табак для бренда
L&M собирается
с 4-х континентов?`,BRAND_QUESTION_TEXT2_SIZE=26,BRAND_QUESTION_TEXT2_Y=260,CONSOLE_X=16,CONSOLE_Y=0,FIRST_SAFE_FRUIT_NUMBER=10,FONT_FAMILY="lm",FLASH_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/flash.webp",FLASH_DURATION=100,FLASH_WIDTH=358,FLASH_HEIGHT=20,FPS_PREFIX="FPS: ",FPS_FILL="#fff",FPS_X=4,FPS_Y=10,INTERACTION_MODE=InteractionModes.SLICE,FRUIT_DROP_TIME={[InteractionModes.TOUCH]:2e3,[InteractionModes.SLICE]:1200},FRUIT_DROP_X_SCOPE=200,FRUIT_SHADOW_POS=50,FRUIT_SHADOW_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/shadow.webp",FRUIT_INFOS={[FruitTypes.BOOM]:{cutImages:[],fixAngle:-21,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/boom.webp",isReverse:!1,juiceColor:null,radius:50,width:100},[FruitTypes.FIRST]:{cutImages:["https://pmi-static.alvs.tech/ninja/default/images/fruit/mango-1.webp","https://pmi-static.alvs.tech/ninja/default/images/fruit/mango-2.webp"],fixAngle:-50,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/mango.webp",isReverse:!1,juiceColor:"#e6c731",radius:50,width:100},[FruitTypes.SECOND]:{cutImages:["https://pmi-static.alvs.tech/ninja/default/images/fruit/watermelon-1.webp","https://pmi-static.alvs.tech/ninja/default/images/fruit/watermelon-2.webp"],fixAngle:-100,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/watermelon.webp",isReverse:!1,juiceColor:"#c00",radius:50,width:100},[FruitTypes.THIRD]:{cutImages:["https://pmi-static.alvs.tech/ninja/default/images/fruit/apple-1.webp","https://pmi-static.alvs.tech/ninja/default/images/fruit/apple-2.webp"],fixAngle:-54,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/apple.webp",isReverse:!1,juiceColor:"#c8e925",radius:50,width:100},[FruitTypes.FOURTH]:{cutImages:["https://pmi-static.alvs.tech/ninja/default/images/fruit/melon-1.webp","https://pmi-static.alvs.tech/ninja/default/images/fruit/melon-2.webp"],fixAngle:90,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/melon.webp",isReverse:!1,juiceColor:"#e6c731",radius:50,width:100},[FruitTypes.FIFTH]:{cutImages:["https://pmi-static.alvs.tech/ninja/default/images/fruit/raspberry-1.webp","https://pmi-static.alvs.tech/ninja/default/images/fruit/raspberry-2.webp"],fixAngle:-135,height:100,image:"https://pmi-static.alvs.tech/ninja/default/images/fruit/raspberry.webp",isReverse:!1,juiceColor:"#c00",radius:50,width:100}},GAME_OVER_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/game-over.webp",GAME_OVER_HEIGHT=145,GAME_OVER_WIDTH=250,HOME_LOGO_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/logo.webp",HOME_LOGO_WIDTH=335,HOME_LOGO_HEIGHT=200,HOME_LOGO_ORIG_X=38,HOME_LOGO_TARGET_Y=41,HOME_LOGO_DURATION=1e3,HOME_MASK_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/blank.png",HOME_MASK_DURATION=1e3,HOME_TEXT1_VALUE=`Тропическое путешествие
в самом разгаре!`,HOME_TEXT_FILL="#fff",HOME_TEXT1_SIZE=22,HOME_TEXT2_VALUE=`Разрежь как можно больше
экзотических фруктов`,HOME_TEXT2_SIZE=22,HOME_TEXT3_VALUE=`Осторожно:
избегай игрушечную
снежинку`,HOME_TEXT3_SIZE=22,HOME_TEXT_ANIM_LENGTH=500,JUICE_DURATION=1500,JUICE_RADIUS=15,JUICE_NUMBER=10,KNIFE_PART_COLOR="#cbd3db",KNIFE_PART_STROKE=10,KNIFE_PART_LIFE=200,LIGHTS_NUMBER=10,LIGHTS_FILL="#fff",LIGHTS_APPEARANCE_TIME=120,LIGHTS_MASK_APPEARANCE_TIME=1e3,LOSE_NUMBER=3,LOSE_ANIMATION_LENGTH=500,LOSE_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/x.webp",LOSE_F_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/xf.webp",LOSE_WIDTH=45.2,LOSE_HEIGHT=37.6,RESULT_BUTTON_ANIMATION_LENGTH=500,RESULT_BUTTON_NEXT_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",RESULT_BUTTON_NEXT_ORIG_X=42,RESULT_BUTTON_NEXT_TARGET_Y=360,RESULT_BUTTON_NEXT_WIDTH=325,RESULT_BUTTON_NEXT_HEIGHT=90,RESULT_BUTTON_NEXT_TEXT_VALUE="Далее",RESULT_BUTTON_NEXT_TEXT_FILL="#fff",RESULT_BUTTON_NEXT_TEXT_SIZE=30,RESULT_BUTTON_REPLAY_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",RESULT_BUTTON_REPLAY_ORIG_X=42,RESULT_BUTTON_REPLAY_WIDTH=325,RESULT_BUTTON_REPLAY_HEIGHT=90,RESULT_BUTTON_REPLAY_TEXT_VALUE="Начать заново",RESULT_BUTTON_REPLAY_TEXT_FILL="#fff",RESULT_BUTTON_REPLAY_TEXT_SIZE=30,RESULT_LOGO_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/logo.webp",RESULT_LOGO_WIDTH=244,RESULT_LOGO_HEIGHT=147,RESULT_LOGO_ORIG_X=81,RESULT_LOGO_TARGET_Y=24,RESULT_LOGO_DURATION=1e3,RESULT_TEXT1_VALUE="",RESULT_TEXT1_FILL="#fff",RESULT_TEXT1_SIZE=17.8,RESULT_TEXT2_VALUE="Твой счёт:",RESULT_TEXT2_FILL="#fff",RESULT_TEXT2_SIZE=30,RESULT_TEXT3_VALUE="5432",RESULT_TEXT3_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT4_VALUE=`Твой
рекорд`,RESULT_TEXT4_FILL="#fff",RESULT_TEXT4_SIZE=18,RESULT_TEXT5_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT5_SIZE=44,RESULT_TEXT6_VALUE=`Общий
рекорд`,RESULT_TEXT6_FILL="#fff",RESULT_TEXT6_SIZE=18,RESULT_TEXT7_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT7_SIZE=44,RESULT_TEXT_ANIM_LENGTH=500,SCORE_TEXT_FILL="#fff",SCORE_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/score.webp",SCORE_IMAGE_SX=-94,SCORE_IMAGE_EX=23,SCORE_IMAGE_Y=8,SCORE_IMAGE_W=40,SCORE_IMAGE_H=40,SCORE_TEXT1_SX=-59,SCORE_TEXT1_SIZE=45,SCORE_TEXT1_VALUE="0",SCORE_TEXT2_SX=-93,SCORE_TEXT2_Y=65,SCORE_TEXT2_PREFIX="Рекорд: ",SCORE_TEXT2_SIZE=16,SCORE_ANIM_LENGTH=500,SCORE_MULTIPLIER=50,SCORE_DEFAULT={user_record:0,global_record:0},SOUNDS={[SoundNames.BOOM]:"https://pmi-static.alvs.tech/ninja/default/sound/boom",[SoundNames.MENU]:"https://pmi-static.alvs.tech/ninja/default/sound/menu",[SoundNames.OVER]:"",[SoundNames.SPLATTER]:"https://pmi-static.alvs.tech/ninja/default/sound/splatter",[SoundNames.START]:"https://pmi-static.alvs.tech/ninja/default/sound/start",[SoundNames.THROW]:"https://pmi-static.alvs.tech/ninja/default/sound/throw"},SOUND_TEXT_SIZE=16,SOUND_BUTTON_TEXT_VALUE_ON="Вкл. звук",SOUND_BUTTON_TEXT_VALUE_OFF="Откл. звук",SOUND_BUTTON_TEXT_FILL="#fff",SOUND_BUTTON_IMAGE_ON="https://pmi-static.alvs.tech/ninja/default/images/sound-on.svg",SOUND_BUTTON_IMAGE_OFF="https://pmi-static.alvs.tech/ninja/default/images/sound-off.svg",SOUND_BUTTON_IMAGE_WIDTH=26,SOUND_BUTTON_IMAGE_HEIGHT=26,SOUND_BUTTON_IMAGE_HOME_END_Y=13,SOUND_BUTTON_ANIMATION_LENGTH=500,START_BUTTON_IMAGE="https://pmi-static.alvs.tech/ninja/default/images/green-button.webp",START_BUTTON_ORIG_X=42,START_BUTTON_WIDTH=325,START_BUTTON_HEIGHT=90,START_BUTTON_ANIMATION_LENGTH=500,START_BUTTON_TEXT_VALUE="Начать",START_BUTTON_TEXT_FILL="#fff",START_BUTTON_TEXT_SIZE=30,viewportSize={viewportHeight:window.innerHeight,viewportWidth:window.innerWidth},adjustView=i=>{const t=window.innerHeight,e=window.innerWidth,s=MAX_VIEWPORT_WIDTH<e,h=MAX_VIEWPORT_HEIGHT<t,m=s?MAX_VIEWPORT_WIDTH+"px":"100%",T=h?MAX_VIEWPORT_HEIGHT+"px":"100%",v=s||h,b=v?"absolute":"static",w=v?"translate(-50%, -50%)":"none";i.style.position=b,i.style.width=m,i.style.height=T,i.style.transform=w;const{width:S,height:O}=i.getBoundingClientRect();viewportSize.viewportHeight=O,viewportSize.viewportWidth=S};function g(i){return i instanceof HTMLElement}function a(){}const calcSize=i=>{const{viewportWidth:t}=viewportSize;typeof i=="string"&&(i=Number(i));const e=t/HORIZONTAL_BASE;return i*e},calcVerticalSize=i=>{const{viewportHeight:t}=viewportSize;typeof i=="string"&&(i=Number(i));const e=t/VERTICAL_BASE;return i*e},calcResultFontSize=(i,t)=>{const e=calcVerticalSize(t),s=i.length,h=s>BASE_RESULT_CHARS_NUMBER?s:BASE_RESULT_CHARS_NUMBER;return e*BASE_RESULT_CHARS_NUMBER/h},convertBackgroundConfig=(i={})=>({height:viewportSize.viewportHeight,image:i.image||BACKGROUND_IMAGE,preserveAspectRatio:"xMidYMid slice",width:viewportSize.viewportWidth,x:0,y:0}),convertBottomConfig=(i={})=>{const t=calcSize(i.height||BOTTOM_HEIGHT);return{duration:BOTTOM_DURATION,endX:0,endY:viewportSize.viewportHeight-t,height:t,image:i.image||BOTTOM_IMAGE,startX:0,startY:viewportSize.viewportHeight,width:viewportSize.viewportWidth}},convertBrandAnswer1ButtonConfig=(i={})=>{const t=calcVerticalSize(i.buttonEndY||BRAND_ANSWER_BUTTON1_END_Y),e=calcSize(i.height||BRAND_ANSWER_BUTTON1_HEIGHT);return{animLength:BRAND_QUESTION_ANIMATION_LENGTH,buttonEndY:t,buttonStartY:viewportSize.viewportHeight,buttonX:calcSize(i.buttonX||BRAND_ANSWER_BUTTON1_X),height:e,image:i.image||BRAND_ANSWER_BUTTON1_IMAGE,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndY:t-calcVerticalSize(6)+e/2,textFill:i.textFill||BRAND_QUESTION_FILL,textSize:calcVerticalSize(i.textSize||BRAND_ANSWER_TEXT1_SIZE)+"px",textStartY:viewportSize.viewportHeight+e,textValue:i.textValue||BRAND_ANSWER_TEXT1_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textX:viewportSize.viewportWidth/2,width:calcSize(i.width||BRAND_ANSWER_BUTTON1_WIDTH)}},convertBrandAnswer2ButtonConfig=(i={},t)=>{const e=calcSize(i.height||BRAND_ANSWER_BUTTON2_HEIGHT),s=t.buttonEndY+e;return{animLength:BRAND_QUESTION_ANIMATION_LENGTH,buttonEndY:s,buttonStartY:viewportSize.viewportHeight,buttonX:calcSize(i.buttonX||BRAND_ANSWER_BUTTON2_X),height:e,image:i.image||BRAND_ANSWER_BUTTON2_IMAGE,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndY:s-calcVerticalSize(6)+e/2,textFill:i.textFill||BRAND_QUESTION_FILL,textSize:calcVerticalSize(i.textSize||BRAND_ANSWER_TEXT2_SIZE)+"px",textStartY:viewportSize.viewportHeight+e,textValue:i.textValue||BRAND_ANSWER_TEXT2_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textX:viewportSize.viewportWidth/2,width:calcSize(i.width||BRAND_ANSWER_BUTTON2_WIDTH)}},convertBrandIntroButtonConfig=(i={})=>{const t=calcVerticalSize(i.buttonEndY||BRAND_INTRO_BUTTON_END_Y),e=calcSize(i.height||BRAND_INTRO_BUTTON_HEIGHT);return{animLength:BRAND_QUESTION_ANIMATION_LENGTH,buttonEndY:t,buttonStartY:viewportSize.viewportHeight,buttonX:calcSize(i.buttonX||BRAND_INTRO_BUTTON_X),height:e,image:i.image||BRAND_INTRO_BUTTON_IMAGE,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndY:t-calcVerticalSize(6)+e/2,textFill:i.textFill||BRAND_QUESTION_FILL,textSize:calcVerticalSize(i.textSize||BRAND_INTRO_BUTTON_TEXT_SIZE)+"px",textStartY:viewportSize.viewportHeight+e,textValue:i.textValue||BRAND_INTRO_BUTTON_TEXT_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textX:viewportSize.viewportWidth/2,width:calcSize(i.width||BRAND_INTRO_BUTTON_WIDTH)}},convertBrandIntroConfig=(i={})=>({animLength:BRAND_INTRO_ANIMATION_LENGTH,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndY:calcVerticalSize(i.textEndY||BRAND_INTRO_TEXT_END_Y),textFill:i.textFill||BRAND_INTRO_FILL,textSize:calcVerticalSize(i.textSize||BRAND_INTRO_TEXT_SIZE)+"px",textStartY:BRAND_INTRO_TEXT_START_Y,textValue:i.textValue||BRAND_INTRO_TEXT_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textX:viewportSize.viewportWidth/2}),convertBrandQuestionText1=(i={})=>({animLength:BRAND_QUESTION_ANIMATION_LENGTH,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndX:viewportSize.viewportWidth/2,textFill:i.textFill||BRAND_QUESTION_FILL,textSize:calcVerticalSize(i.textSize||BRAND_QUESTION_TEXT1_SIZE)+"px",textStartX:-viewportSize.viewportWidth,textValue:i.textValue||BRAND_QUESTION_TEXT1_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textY:calcVerticalSize(i.textY||BRAND_QUESTION_TEXT1_Y)}),convertBrandQuestionText2=(i={})=>({animLength:BRAND_QUESTION_ANIMATION_LENGTH,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndX:viewportSize.viewportWidth/2,textFill:i.textFill||BRAND_QUESTION_FILL,textSize:calcVerticalSize(i.textSize||BRAND_QUESTION_TEXT2_SIZE)+"px",textStartX:viewportSize.viewportWidth*2,textValue:i.textValue||BRAND_QUESTION_TEXT2_VALUE,textWeight:i.textWeight||TextWeight.BOLD,textY:calcVerticalSize(i.textY||BRAND_QUESTION_TEXT2_Y)}),convertConsoleConfig=()=>({x:CONSOLE_X,y:CONSOLE_Y}),convertFlashConfig=(i={})=>({duration:FLASH_DURATION,height:calcSize(FLASH_HEIGHT),image:i.image||FLASH_IMAGE,width:calcSize(FLASH_WIDTH)}),convertFPSConfig=()=>({fill:FPS_FILL,prefix:FPS_PREFIX,x:FPS_X,y:viewportSize.viewportHeight-FPS_Y}),convertFruitInfo=(i={},t)=>({cutImages:i.cutImages&&i.cutImages.filter(Boolean).length>0&&i.cutImages||t.cutImages,fixAngle:t.fixAngle,height:calcSize(i.height||t.height),image:i.image||t.image,isReverse:t.isReverse,juiceColor:i.juiceColor||t.juiceColor,radius:calcSize(i.radius||t.radius),width:calcSize(i.width||t.width)}),convertFruitsConfig=(i={},t)=>{const e=i.infos||FRUIT_INFOS;return{dropTime:FRUIT_DROP_TIME[t],dropXScope:FRUIT_DROP_X_SCOPE,shadowPos:FRUIT_SHADOW_POS,shadowImage:i.shadowImage||FRUIT_SHADOW_IMAGE,types:FruitTypes,infos:Object.keys(e).reduce((s,h)=>(s[h]=convertFruitInfo(e[h],FRUIT_INFOS[h]),s),{})}},convertGameOverConfig=(i={})=>{const t=calcSize(i.height||GAME_OVER_HEIGHT),e=calcSize(i.width||GAME_OVER_WIDTH);return{height:t,image:i.image||GAME_OVER_IMAGE,width:e,x:viewportSize.viewportWidth/2-e/2+calcSize(6),y:viewportSize.viewportHeight/2-t/2}},convertHomeLogoConfig=(i={})=>{const t=calcSize(i.startX||HOME_LOGO_ORIG_X),e=calcSize(i.height||HOME_LOGO_HEIGHT);return{duration:HOME_LOGO_DURATION,endX:t,endY:calcSize(i.endY||HOME_LOGO_TARGET_Y),height:e,image:i.image||HOME_LOGO_IMAGE,startX:t,startY:-e,width:calcSize(i.width||HOME_LOGO_WIDTH)}},convertHomeMaskConfig=()=>({duration:HOME_MASK_DURATION,endX:0,endY:0,height:183,image:HOME_MASK_IMAGE,startX:0,startY:-183,width:viewportSize.viewportWidth}),convertHomeTextConfig=(i={},t)=>({animLength:HOME_TEXT_ANIM_LENGTH,text1Anchor:i.text1Anchor||TextAnchor.MIDDLE,text1Ex:viewportSize.viewportWidth/2,text1Fill:i.text1Fill||HOME_TEXT_FILL,text1Size:calcVerticalSize(i.text1Size||HOME_TEXT1_SIZE)+"px",text1Sx:-viewportSize.viewportWidth,text1Value:i.text1Value||HOME_TEXT1_VALUE,text1Weight:i.text1Weight||TextWeight.BOLD,text1Y:i.text1Y?calcVerticalSize(i.text1Y):t.endY+t.height+calcVerticalSize(28),text2Anchor:i.text2Anchor||TextAnchor.MIDDLE,text2Ex:viewportSize.viewportWidth/2,text2Fill:i.text2Fill||HOME_TEXT_FILL,text2Size:calcVerticalSize(i.text2Size||HOME_TEXT2_SIZE)+"px",text2Sx:-viewportSize.viewportWidth,text2Value:i.text2Value||HOME_TEXT2_VALUE,text2Weight:i.text2Weight||TextWeight.BOLD,text2Y:i.text2Y?calcVerticalSize(i.text2Y):t.endY+t.height+calcVerticalSize(148),text3Anchor:i.text3Anchor||TextAnchor.MIDDLE,text3Ex:viewportSize.viewportWidth/2,text3Fill:i.text3Fill||HOME_TEXT_FILL,text3Size:calcVerticalSize(i.text3Size||HOME_TEXT3_SIZE)+"px",text3Sx:-viewportSize.viewportWidth,text3Value:i.text3Value||HOME_TEXT3_VALUE,text3Weight:i.text3Weight||TextWeight.BOLD,text3Y:i.text3Y?calcVerticalSize(i.text3Y):t.endY+t.height+calcVerticalSize(235)}),convertJuiceConfig=(i={})=>({duration:JUICE_DURATION,number:JUICE_NUMBER,radius:JUICE_RADIUS,shape:i.shape||JuiceShapes.DIAMOND,shapes:JuiceShapes}),convertKnifePartConfig=()=>({color:KNIFE_PART_COLOR,life:KNIFE_PART_LIFE,stroke:KNIFE_PART_STROKE}),convertLightsConfig=()=>({appearanceTime:LIGHTS_APPEARANCE_TIME,fill:LIGHTS_FILL,maskAppearanceTime:LIGHTS_MASK_APPEARANCE_TIME,number:LIGHTS_NUMBER}),convertLose=(i,t,e)=>{const s=calcSize(i.width||LOSE_WIDTH),h=viewportSize.viewportWidth-t.imageEx-s-e*s;return{ex:h,h:calcSize(i.height||LOSE_HEIGHT),src:i.emptyImage||LOSE_IMAGE,srcF:i.fullImage||LOSE_F_IMAGE,sx:h+200,w:s,y:t.imageY}},convertLoseConfig=(i={},t)=>{const e=[];for(let s=0;s<LOSE_NUMBER;s++)e.push(convertLose(i,t,s));return{animLength:LOSE_ANIMATION_LENGTH,conf:e}},convertScoreConfig=(i={},t)=>{const e=calcSize(i.imageEx||SCORE_IMAGE_EX),s=calcSize(i.imageH||SCORE_IMAGE_H),h=calcSize(i.imageW||SCORE_IMAGE_W),m=calcSize(i.imageY||SCORE_IMAGE_Y);return{animLength:SCORE_ANIM_LENGTH,image:i.image||SCORE_IMAGE,imageEx:e,imageH:s,imageSx:SCORE_IMAGE_SX,imageW:h,imageY:calcSize(i.imageY||SCORE_IMAGE_Y),text1Ex:e+h+calcSize(12),text1Fill:i.text1Fill||SCORE_TEXT_FILL,text1Size:calcVerticalSize(i.text1Size||SCORE_TEXT1_SIZE)+"px",text1Sx:SCORE_TEXT1_SX,text1Value:i.text1Value||SCORE_TEXT1_VALUE,text1Weight:i.text1Weight||TextWeight.BOLD,text1Y:m+s-calcSize(14),text2Ex:e,text2Fill:i.text2Fill||SCORE_TEXT_FILL,text2Prefix:i.text2Prefix||SCORE_TEXT2_PREFIX,text2Size:calcVerticalSize(i.text2Size||SCORE_TEXT2_SIZE)+"px",text2Sx:SCORE_TEXT2_SX,text2Value:t.user_record.toString(),text2Weight:i.text2Weight||TextWeight.BOLD,text2Y:calcSize(i.text2Y||SCORE_TEXT2_Y)}},convertResultButtonNextConfig=(i={},t)=>{const e=calcSize(i.startX||RESULT_BUTTON_NEXT_ORIG_X),s=t.endY+t.height+calcVerticalSize(i.endY||RESULT_BUTTON_NEXT_TARGET_Y),h=calcSize(i.height||RESULT_BUTTON_NEXT_HEIGHT);return{animLength:RESULT_BUTTON_ANIMATION_LENGTH,endX:e,endY:s,height:h,image:i.image||RESULT_BUTTON_NEXT_IMAGE,startX:e,startY:viewportSize.viewportHeight,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndX:e,textEndY:s-calcSize(8)+h/2,textFill:i.textFill||RESULT_BUTTON_NEXT_TEXT_FILL,textSize:calcSize(i.textSize||RESULT_BUTTON_NEXT_TEXT_SIZE)+"px",textStartX:viewportSize.viewportWidth/2,textStartY:viewportSize.viewportHeight+h,textValue:i.textValue||RESULT_BUTTON_NEXT_TEXT_VALUE,textWeight:i.textWeight||TextWeight.BOLD,width:calcSize(i.width||RESULT_BUTTON_NEXT_WIDTH)}},convertResultButtonReplayConfig=(i={},t)=>{const e=calcSize(i.startX||RESULT_BUTTON_REPLAY_ORIG_X),s=t.endY+t.height,h=calcSize(i.height||RESULT_BUTTON_REPLAY_HEIGHT);return{animLength:RESULT_BUTTON_ANIMATION_LENGTH,endX:e,endY:s,height:h,image:i.image||RESULT_BUTTON_REPLAY_IMAGE,startX:e,startY:viewportSize.viewportHeight,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndX:e,textEndY:s-calcSize(8)+h/2,textFill:i.textFill||RESULT_BUTTON_REPLAY_TEXT_FILL,textSize:calcSize(i.textSize||RESULT_BUTTON_REPLAY_TEXT_SIZE)+"px",textStartX:viewportSize.viewportWidth/2,textStartY:viewportSize.viewportHeight+h,textValue:i.textValue||RESULT_BUTTON_REPLAY_TEXT_VALUE,textWeight:i.textWeight||TextWeight.BOLD,width:calcSize(i.width||RESULT_BUTTON_REPLAY_WIDTH)}},convertResultLogoConfig=(i={})=>{const t=calcSize(i.startX||RESULT_LOGO_ORIG_X),e=calcSize(i.height||RESULT_LOGO_HEIGHT);return{duration:RESULT_LOGO_DURATION,endX:t,endY:calcSize(i.endY||RESULT_LOGO_TARGET_Y),height:e,image:i.image||RESULT_LOGO_IMAGE,startX:t,startY:-e,width:calcSize(i.width||RESULT_LOGO_WIDTH)}},convertResultTextConfig=(i={},t,e)=>({animLength:RESULT_TEXT_ANIM_LENGTH,text1Anchor:i.text1Anchor||TextAnchor.MIDDLE,text1Ey:t.endY+t.height+calcVerticalSize(4),text1Fill:i.text1Fill||RESULT_TEXT1_FILL,text1Size:calcVerticalSize(i.text1Size||RESULT_TEXT1_SIZE)+"px",text1Sy:-200,text1Value:i.text1Value||RESULT_TEXT1_VALUE,text1Weight:i.text1Weight||TextWeight.BOLD,text1X:viewportSize.viewportWidth/2,text2Anchor:i.text2Anchor||TextAnchor.MIDDLE,text2Ey:t.endY+t.height+calcVerticalSize(60),text2Fill:i.text2Fill||RESULT_TEXT2_FILL,text2Size:calcVerticalSize(i.text2Size||RESULT_TEXT2_SIZE)+"px",text2Sy:-200,text2Value:i.text2Value||RESULT_TEXT2_VALUE,text2Weight:i.text2Weight||TextWeight.BOLD,text2X:viewportSize.viewportWidth/2,text3Anchor:i.text3Anchor||TextAnchor.MIDDLE,text3Ey:t.endY+t.height+calcVerticalSize(140),text3Fill:i.text3Fill||RESULT_TEXT3_FILL,text3Size:calcVerticalSize(calcResultFontSize(RESULT_TEXT3_VALUE,115))+"px",text3Sy:-200,text3Value:i.text3Value||RESULT_TEXT3_VALUE,text3Weight:i.text3Weight||TextWeight.BOLD,text3X:viewportSize.viewportWidth/2,text4Anchor:i.text4Anchor||TextAnchor.MIDDLE,text4Ex:viewportSize.viewportWidth/4+calcSize(10),text4Fill:i.text4Fill||RESULT_TEXT4_FILL,text4Size:calcVerticalSize(i.text4Size||RESULT_TEXT4_SIZE)+"px",text4Sx:-viewportSize.viewportWidth,text4Value:i.text4Value||RESULT_TEXT4_VALUE,text4Weight:i.text4Weight||TextWeight.BOLD,text4Y:t.endY+t.height+calcVerticalSize(245),text5Anchor:i.text5Anchor||TextAnchor.MIDDLE,text5Ex:viewportSize.viewportWidth/4+calcSize(10),text5Fill:i.text5Fill||RESULT_TEXT5_FILL,text5Size:calcVerticalSize(i.text5Size||RESULT_TEXT5_SIZE)+"px",text5Sx:-viewportSize.viewportWidth,text5Value:e.user_record.toString(),text5Weight:i.text5Weight||TextWeight.BOLD,text5Y:t.endY+t.height+calcVerticalSize(295),text6Anchor:i.text6Anchor||TextAnchor.MIDDLE,text6Ex:3*(viewportSize.viewportWidth/4)-calcSize(10),text6Fill:i.text6Fill||RESULT_TEXT6_FILL,text6Size:calcVerticalSize(i.text6Size||RESULT_TEXT6_SIZE)+"px",text6Sx:viewportSize.viewportWidth*2,text6Value:i.text6Value||RESULT_TEXT6_VALUE,text6Weight:i.text6Weight||TextWeight.BOLD,text6Y:t.endY+t.height+calcVerticalSize(245),text7Anchor:i.text7Anchor||TextAnchor.MIDDLE,text7Ex:3*(viewportSize.viewportWidth/4)-calcSize(10),text7Fill:i.text7Fill||RESULT_TEXT7_FILL,text7Size:calcVerticalSize(i.text7Size||RESULT_TEXT7_SIZE)+"px",text7Sx:viewportSize.viewportWidth*2,text7Value:e.global_record.toString(),text7Weight:i.text7Weight||TextWeight.BOLD,text7Y:t.endY+t.height+calcVerticalSize(295)}),convertSounds=(i={})=>Object.keys(SOUNDS).reduce((t,e)=>(t[e]=i[e]||SOUNDS[e],t),{}),convertScore=i=>({user_record:i&&i.user_record||SCORE_DEFAULT.user_record,global_record:i&&i.global_record||SCORE_DEFAULT.global_record}),convertSoundButtonConfig=(i={},t)=>{const e=calcVerticalSize(i.textSize||SOUND_TEXT_SIZE),s=calcSize(i.imageWidth||SOUND_BUTTON_IMAGE_WIDTH),h=viewportSize.viewportWidth-s-calcSize(38);return{animLength:SOUND_BUTTON_ANIMATION_LENGTH,imageGameEndY:t.imageY+t.imageH+calcSize(4),imageHeight:calcSize(i.imageHeight||SOUND_BUTTON_IMAGE_HEIGHT),imageHomeEndY:calcVerticalSize(i.imageHomeEndY||SOUND_BUTTON_IMAGE_HOME_END_Y),imageOff:i.imageOff||SOUND_BUTTON_IMAGE_OFF,imageOn:i.imageOn||SOUND_BUTTON_IMAGE_ON,imageResultEndY:e/2+calcSize(2),imageStartY:-100,imageWidth:s,imageX:viewportSize.viewportWidth-s-calcSize(38),textAnchor:i.textAnchor||TextAnchor.END,textFill:i.textFill||SOUND_BUTTON_TEXT_FILL,textGameEndY:t.text2Y,textHomeEndY:e/2+calcSize(18),textResultEndY:e/2+calcSize(15),textSize:e+"px",textStartY:-100,textValueOff:i.textValueOff||SOUND_BUTTON_TEXT_VALUE_OFF,textValueOn:i.textValueOn||SOUND_BUTTON_TEXT_VALUE_ON,textWeight:i.textWeight||TextWeight.BOLD,textX:h-calcSize(10)}},convertStartButtonConfig=(i={},t)=>{const e=calcSize(i.startX||START_BUTTON_ORIG_X),s=t.endY+t.height+calcVerticalSize(327),h=calcSize(i.height||START_BUTTON_HEIGHT);return{animLength:START_BUTTON_ANIMATION_LENGTH,endX:e,endY:s,height:h,image:i.image||START_BUTTON_IMAGE,startX:e,startY:viewportSize.viewportHeight,textAnchor:i.textAnchor||TextAnchor.MIDDLE,textEndX:e,textEndY:s-calcVerticalSize(8)+h/2,textFill:i.textFill||START_BUTTON_TEXT_FILL,textSize:calcSize(i.textSize||START_BUTTON_TEXT_SIZE)+"px",textStartX:viewportSize.viewportWidth/2,textStartY:viewportSize.viewportHeight+h,textValue:i.textValue||START_BUTTON_TEXT_VALUE,textWeight:i.textWeight||TextWeight.BOLD,width:calcSize(i.width||START_BUTTON_WIDTH)}};class Config{constructor(t,e){this._params=t,this._logger=e,this.setScore=s=>{this._options.SCORE=s},this._onReady=this._params.onReady??a,this._onReplay=this._params.onReplay??a,this._onGameOver=this._params.onGameOver??Promise.resolve,this._onComplete=this._params.onComplete??Promise.resolve,this._onError=this._params.onError??a,this._rootElement=this.getRoot(this._params.rootElement),this._logger.debug("Setting config start"),this._options=this.convertOptions(this._params),this._logger.debug("Setting config end")}convertOptions(t){const e=t.INTERACTION_MODE||INTERACTION_MODE,s=convertHomeLogoConfig(t.HOME_LOGO_CONFIG),h=convertScore(t.SCORE),m=convertScoreConfig(t.SCORE_CONFIG,h),T=convertResultLogoConfig(t.RESULT_LOGO_CONFIG),v=convertResultButtonNextConfig(t.RESULT_BUTTON_NEXT_CONFIG,T),b=convertBrandAnswer1ButtonConfig(t.BRAND_ANSWER1_CONFIG);return{BACKGROUND_CONFIG:convertBackgroundConfig(t.BACKGROUND_CONFIG),BOTTOM_CONFIG:convertBottomConfig(t.BOTTOM_CONFIG),BRAND_ANSWER1_CONFIG:b,BRAND_ANSWER2_CONFIG:convertBrandAnswer2ButtonConfig(t.BRAND_ANSWER2_CONFIG,b),BRAND_INTRO_BUTTON_CONFIG:convertBrandIntroButtonConfig(t.BRAND_INTRO_BUTTON_CONFIG),BRAND_INTRO_CONFIG:convertBrandIntroConfig(t.BRAND_INTRO_CONFIG),BRAND_QUESTION_TEXT1_CONFIG:convertBrandQuestionText1(t.BRAND_QUESTION_TEXT1_CONFIG),BRAND_QUESTION_TEXT2_CONFIG:convertBrandQuestionText2(t.BRAND_QUESTION_TEXT2_CONFIG),CONSOLE_CONFIG:convertConsoleConfig(),FIRST_SAFE_FRUIT_NUMBER:t.FIRST_SAFE_FRUIT_NUMBER&&Number(t.FIRST_SAFE_FRUIT_NUMBER)||FIRST_SAFE_FRUIT_NUMBER,FONT_FAMILY:t.FONT_FAMILY||FONT_FAMILY,FLASH_CONFIG:convertFlashConfig(t.FLASH_CONFIG),FPS_CONFIG:convertFPSConfig(),FRUIT_CONFIG:convertFruitsConfig(t.FRUIT_CONFIG,e),GAME_OVER_CONFIG:convertGameOverConfig(t.GAME_OVER_CONFIG),GAME_STATES:GameStates,HOME_LOGO_CONFIG:s,HOME_MASK_CONFIG:convertHomeMaskConfig(),HOME_TEXT_CONFIG:convertHomeTextConfig(t.HOME_TEXT_CONFIG,s),INTERACTION_MODE:e,INTERACTION_MODES:InteractionModes,IS_TOUCH:e===InteractionModes.TOUCH,IS_DEBUG:new URLSearchParams(window.location.search).has("debug"),JUICE_CONFIG:convertJuiceConfig(t.JUICE_CONFIG),KNIFE_PART_CONFIG:convertKnifePartConfig(),LAYERS:Layers,LIGHTS_CONFIG:convertLightsConfig(),LOSE_CONFIG:convertLoseConfig(t.LOSE_CONFIG,m),MESSAGES:Messages,MODES:Modes,RESULT_BUTTON_NEXT_CONFIG:v,RESULT_BUTTON_REPLAY_CONFIG:convertResultButtonReplayConfig(t.RESULT_BUTTON_REPLAY_CONFIG,v),RESULT_LOGO_CONFIG:T,RESULT_TEXT_CONFIG:convertResultTextConfig(t.RESULT_TEXT_CONFIG,T,h),SCENES:Scenes,SCENE_STATES:SceneStates,SCORE:h,SCORE_CONFIG:m,SCORE_MULTIPLIER:t.SCORE_MULTIPLIER&&Number(t.SCORE_MULTIPLIER)||SCORE_MULTIPLIER,SOUNDS:convertSounds(t.SOUNDS),SOUND_BUTTON_CONFIG:convertSoundButtonConfig(t.SOUND_BUTTON_CONFIG,m),START_BUTTON_CONFIG:convertStartButtonConfig(t.START_BUTTON_CONFIG,s),STATE_KEYS:StateKeys}}getRoot(t){return(!g(t)||t.tagName!=="DIV")&&(this._logger.error("Root element is not an HTMLDivElement"),this.onError("config.rootElement.error")),t}set options(t){this._options=t}get options(){return this._options}get onReady(){return this._onReady}get onReplay(){return this._onReplay}get onGameOver(){return this._onGameOver}get onComplete(){return this._onComplete}get onError(){return this._onError}get rootElement(){return this._rootElement}}let addingTasks=[],adding=0,tasks=[];class Timeline{constructor(){Ke(this,"_requestAnimationFrame",function(t){return t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||function(e){setTimeout(e,1)}}(window)),this.startTime=0,this.count=0}now(){return new Date().getTime()}init(){this.startTime=this.now(),this.count=0,setInterval(()=>{this.count++,this.update(this.now())},1)}createTask(t){const e=this._createTask(t);return addingTasks.unshift(e),adding=1,t.recycle&&this.taskList(t.recycle,e),e}taskList(t,e){return t.clear||(t.clear=function(){for(let s,h=this.length-1;h>=0;h--)s=this[h],s.stop(),this.splice(h,1);return this}),e&&t.unshift(e),t}setTimeout(t,e){return this.createTask({start:e,duration:0,onTimeStart:t})}_setInterval(t,e){const s=setInterval(t,e);return{stop:function(){clearInterval(s)}}}getFPS(){const t=this.now(),e=this.count/(t-this.startTime)*1e3;return this.count>1e3&&(this.count=0,this.startTime=t),e}_createTask(t){const e=t.object||{};return t.start=t.start||0,{start:t.start+this.now(),duration:t.duration===-1?864e5:t.duration,data:t.data?[0].concat(t.data):[0],started:0,object:e,onTimeStart:t.onTimeStart||e.onTimeStart||nul,onTimeUpdate:t.onTimeUpdate||e.onTimeUpdate||nul,onTimeEnd:t.onTimeEnd||e.onTimeEnd||nul,stop:function(){this.stopped=1}}}updateTask(t,e){const s=t.data;s[0]=e,t.onTimeUpdate.apply(t.object,s)}checkStartTask(t){t.started||(t.started=1,t.onTimeStart.apply(t.object,t.data.slice(1)),this.updateTask(t,0))}update(t){let e=tasks.length,s,h,m,T;for(;e--;)if(h=tasks[e],m=h.start,T=h.duration,t>=m){if(h.stopped){tasks.splice(e,1);continue}this.checkStartTask(h),(s=t-m)<T?this.updateTask(h,s):(this.updateTask(h,T),h.onTimeEnd.apply(h.object,h.data.slice(1)),tasks.splice(e,1))}adding&&(tasks.unshift.apply(tasks,addingTasks),addingTasks.length=adding=0)}}const timeline=new Timeline;class Displacement{constructor(t,e,{layer:s,imageSrc:h,width:m,height:T,startX:v,startY:b,endX:w,endY:S,animMap:O,duration:U}){this._config=t,this._layerManager=e,this.anim={},this.anims=[],this.layer=s,this.imageSrc=h,this.width=m,this.height=T,this.startX=v,this.startY=b,this.endX=w,this.endY=S,typeof O=="function"?this.anim.show=this.anim.hide=O:this.anim=O,this.duration=U}createTask(t,e,s,h,m,T,v,b){timeline.createTask({start:t,duration:e,object:this,data:[s,h,m,T,v,b],onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}set(){this.image=this._layerManager.createImage(this.layer,this.imageSrc,this.startX,this.startY,this.width,this.height)}show(t=0){const{MODES:e}=this._config.options;this.createTask(t,this.duration,this.startX,this.startY,this.endX,this.endY,this.anim.show,e.SHOW)}hide(){const{MODES:t}=this._config.options;this.anims.clear(),this.createTask(0,this.duration,this.endX,this.endY,this.startX,this.startY,this.anim.hide,t.HIDE)}onTimeUpdate(t,e,s,h,m,T){this.image.attr({x:T(t,e,h-e,this.duration),y:T(t,s,m-s,this.duration)})}onTimeStart(){}onTimeEnd(t,e,s,h,m){const{MODES:T}=this._config.options;m===T.HIDE&&this.image.hide()}}class DisplacementFactory{constructor(t,e){this._config=t,this._layerManager=e}create(t){return new Displacement(this._config,this._layerManager,t)}}function exponential(){}exponential.co=function(i,t,e,s){return i==s?t+e:e*(-Math.pow(2,-10*i/s)+1)+t};exponential.ci=function(i,t,e,s){return i==0?t:e*Math.pow(2,10*(i/s-1))+t};function quadratic(){}quadratic.ci=function(i,t,e,s){return e*(i/=s)*i+t};quadratic.co=function(i,t,e,s){return-e*(i/=s)*(i-2)+t};quadratic.cio=function(i,t,e,s){return(i/=s/2)<1?e/2*i*i+t:-e/2*(--i*(i-2)-1)+t};function linear(i,t,e,s){return e*i/s+t}function back(){}back.ci=function(i,t,e,s,h){return h=1.70158,e*((i=i/s-1)*i*((h+1)*i+h)+1)+t};back.co=function(i,t,e,s,h){return h=1.70158,e*(i/=s)*i*((h+1)*i-h)+t};const blankArray=[],slice=blankArray.slice,join=blankArray.join,Ucren={isIe:/msie/i.test(navigator.userAgent),isIe6:/msie 6/i.test(navigator.userAgent),isFirefox:/firefox/i.test(navigator.userAgent),isSafari:/version\/[\d.]+\s+safari/i.test(navigator.userAgent),isOpera:/opera/i.test(navigator.userAgent),isChrome:/chrome/i.test(navigator.userAgent),isStrict:document.compatMode==="CSS1Compat",tempDom:document.createElement("div"),apply,appendStyle:function(i){var t;arguments.length>1&&(i=join.call(arguments,"")),document.createStyleSheet?(t=document.createStyleSheet(),t.cssText=i):(t=document.createElement("style"),t.type="text/css",t.appendChild(document.createTextNode(i)),document.getElementsByTagName("head")[0].appendChild(t))},addEvent:function(i,t,e){var s=function(){e.apply(i,arguments)};return i.dom&&(i=i.dom),window.attachEvent?i.attachEvent("on"+t,s):window.addEventListener?i.addEventListener(t,s,!1):i["on"+t]=s,s},delEvent:function(i,t,e){window.detachEvent?i.detachEvent("on"+t,e):window.removeEventListener?i.removeEventListener(t,e,!1):i["on"+t]===e&&(i["on"+t]=null)},Class:function(i,t,e,s){var h,m;return i=i||function(){},t=t||{},h=function(){this.instanceId=Ucren.id(),i.apply(this,arguments)},m=h.prototype,Ucren.registerClassEvent.call(m),Ucren.each(t,function(T,v){m[v]=function(b,w){return typeof b=="function"?function(){var S,O;if(S=slice.call(arguments,0),!(e&&e.apply(this,[w].concat(S))===!1))return this.fireEvent("before"+w,S),O=b.apply(this,S),s&&s.apply(this,[w].concat(S)),this.fireEvent(w,S),O}:b}(T,v)}),m.getOriginMethod=function(T){return t[T]},h},registerClassEvent:function(){this.on=function(i,t){var e=this.instanceId;Ucren.dispatch(e+i,t.bind(this))},this.onbefore=function(i,t){var e=this.instanceId;Ucren.dispatch(e+"before"+i,t.bind(this))},this.un=function(i,t){},this.fireEvent=function(i,t){var e=this.instanceId;Ucren.dispatch(e+i,t)}},createFuze:function(){var i,t,e;return i=[],t=function(s){e?s():i.push(s)},t.fire=function(){for(;i.length;)i.shift()();e=!0},t.extinguish=function(){e=!1},t.wettish=function(){i.length&&i.shift()()},t},dispatch:function(){var i={},t,e;return t=function(s,h,m){var T;(T=i[s])&&Ucren.each(T,function(v){v.apply(m,h)})},e=function(s,h){i[s]||(i[s]=[]),i[s].push(h)},function(s,h,m){typeof h>"u"&&(h=[]),h instanceof Array?t.apply(this,arguments):typeof h=="function"&&e.apply(this,arguments)}}(),each,Element:function(i,t){var e,s;return i&&i.isUcrenElement?t?i.dom:i:(i=typeof i=="string"?document.getElementById(i):i,i?t?i:(s=i.getAttribute("handleId"),typeof s=="string"?Ucren.handle(s-0):(e=new Ucren.BasicElement(i),s=Ucren.handle(e),i.setAttribute("handleId",s+""),e)):null)},Event:function(i){if(i=i||window.event,!i)for(var t=this.caller;t;){if(t.arguments&&t.arguments[0]&&typeof t.arguments[0].altKey=="boolean"){i=t.arguments[0];break}t=t.caller}return i},fixNumber:function(i,t){return typeof i=="number"?i:t},fixString:function(i,t){return typeof i=="string"?i:t},fixConfig:function(i){var t;return t={},typeof i>"u"?t:typeof i=="function"?new i:i},handle:function i(t){var e,s,h;if(e=i,e.cache||(e.cache={}),typeof e.number>"u"&&(e.number=0),s=typeof t,s==="number")return e.cache[t.toString()];if(s==="object"||s==="function")return h=e.number++,e.cache[h.toString()]=t,h},id:function i(){return i.number=++i.number||0,"_"+i.number},loadImage:function(i,t){var e=i.length,s=0,h=function(){s===e&&t&&t()};Ucren.each(i,function(m){var T=document.createElement("img");T.onload=T.onerror=function(){this.onload=this.onerror=null,s++,h()},Ucren.tempDom.appendChild(T),T.src=m})},loadScript:function(src,callback){Ucren.request(src,function(text){eval(text),callback&&callback(text)})},makeElement,nul,randomNumber:function(i){return Math.floor(Math.random()*i)},randomWord:function(){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return function(t,e){var s,h=[];return s=e||i,Ucren.each(t,(function(m){h[m]=s.charAt(this.randomNumber(s.length))}).bind(this)),h.join("")}}(),request:function(i,t){var e=Ucren.request,s=e.xhr;e.xhr||(window.XMLHttpRequest?s=e.xhr=new XMLHttpRequest:s=e.xhr=new ActiveXObject("Microsoft.XMLHTTP")),s.open("GET",i,!0),s.onreadystatechange=function(){s.readyState===4&&s.status===200&&t(s.responseText)},s.send(null)}};Ucren.BasicDrag=Ucren.Class(function(i){i=Ucren.fixConfig(i),this.type=Ucren.fixString(i.type,"normal");var t=this.isTouch="ontouchstart"in window;this.TOUCH_START=t?"touchstart":"mousedown",this.TOUCH_MOVE=t?"touchmove":"mousemove",this.TOUCH_END=t?"touchend":"mouseup"},{bind:function(i,t){i=Ucren.Element(i),t=Ucren.Element(t)||i;var e={};e[this.TOUCH_START]=(function(s){return s=Ucren.Event(s),this.startDrag(),s.cancelBubble=!0,s.stopPropagation&&s.stopPropagation(),s.returnValue=!1}).bind(this),t.addEvents(e),this.target=i},getCoors:function(i){var t=[];if(i.targetTouches&&i.targetTouches.length){var e=i.targetTouches[0];t[0]=e.clientX,t[1]=e.clientY}else t[0]=i.clientX,t[1]=i.clientY;return t},startDrag:function(){var i,t,e;i=this.target,t=i.draging={},this.isDraging=!0,t.x=parseInt(i.style("left"),10)||0,t.y=parseInt(i.style("top"),10)||0,e=Ucren.Event();var s=this.getCoors(e);t.mouseX=s[0],t.mouseY=s[1],this.registerDocumentEvent()},endDrag:function(){this.isDraging=!1,this.unRegisterDocumentEvent()},registerDocumentEvent:function(){var i,t;i=this.target,t=i.draging,t.documentSelectStart=Ucren.addEvent(document,"selectstart",function(e){return e=e||event,e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1}),t.documentMouseMove=Ucren.addEvent(document,this.TOUCH_MOVE,(function(e){var s,h;e=e||event,s=Ucren.isIe&&e.button!==1,h=!Ucren.isIe&&e.button!==0,(s||h)&&!this.isTouch&&this.endDrag();var m=this.getCoors(e);return t.newMouseX=m[0],t.newMouseY=m[1],e.stopPropagation&&e.stopPropagation(),e.returnValue=!1}).bind(this)),t.documentMouseUp=Ucren.addEvent(document,this.TOUCH_END,(function(){this.endDrag()}).bind(this)),clearInterval(t.timer),t.timer=setInterval((function(){var e,s,h,m;t.newMouseX&&(h=t.newMouseX-t.mouseX,m=t.newMouseY-t.mouseY,e=t.x+h,s=t.y+m,this.type==="calc"?this.returnValue(h,m,t.newMouseX,t.newMouseY):i.left(e).top(s))}).bind(this),10)},unRegisterDocumentEvent:function(){var i=this.target.draging;Ucren.delEvent(document,this.TOUCH_MOVE,i.documentMouseMove),Ucren.delEvent(document,this.TOUCH_END,i.documentMouseUp),Ucren.delEvent(document,"selectstart",i.documentSelectStart),clearInterval(i.timer)},returnValue:function(i,t,e,s){}});Ucren.Template=Ucren.Class(function(){this.string=join.call(arguments,"")},{apply:function(i){return this.string.format(i)}});Ucren.BasicElement=Ucren.Class(function(i){this.dom=i,this.countMapping={}},{isUcrenElement:!0,attr:function(i,t){if(typeof t=="string")this.dom.setAttribute(i,t);else return this.dom.getAttribute(i);return this},style:function(){var i=Ucren.isIe?function(t){return this.dom.currentStyle[t]}:function(t){var e;return e=document.defaultView.getComputedStyle(this.dom,null),e.getPropertyValue(t)};return function(t,e){if(typeof t=="object")Ucren.each(t,(function(s,h){this[h]=s}).bind(this.dom.style));else{if(typeof t=="string"&&typeof e>"u")return i.call(this,t);typeof t=="string"&&typeof e<"u"&&(this.dom.style[t]=e)}return this}}(),hasClass:function(i){var t=" "+this.dom.className+" ";return t.indexOf(" "+i+" ")>-1},setClass:function(i){return typeof i=="string"&&(this.dom.className=i.trim()),this},addClass:function(i){var t,e;return t=this.dom,e=" "+t.className+" ",e.indexOf(" "+i+" ")===-1&&(e+=i,e=e.trim(),e=e.replace(/ +/g," "),t.className=e),this},delClass:function(i){var t,e;return t=this.dom,e=" "+t.className+" ",e.indexOf(" "+i+" ")>-1&&(e=e.replace(" "+i+" "," "),e=e.trim(),e=e.replace(/ +/g," "),t.className=e),this},html:function(i){var t=this.dom;if(typeof i=="string")t.innerHTML=i;else if(i instanceof Array)t.innerHTML=i.join("");else return t.innerHTML;return this},left:function(i){var t=this.dom;if(typeof i=="number")t.style.left=i+"px",this.fireEvent("infect",[{left:i}]);else return this.getPos().x;return this},top:function(i){var t=this.dom;if(typeof i=="number")t.style.top=i+"px",this.fireEvent("infect",[{top:i}]);else return this.getPos().y;return this},width:function(i){var t=this.dom;if(typeof i=="number")t.style.width=i+"px",this.fireEvent("infect",[{width:i}]);else if(typeof i=="string")t.style.width=i,this.fireEvent("infect",[{width:i}]);else return this.getSize().width;return this},height:function(i){var t=this.dom;if(typeof i=="number")t.style.height=i+"px",this.fireEvent("infect",[{height:i}]);else if(typeof i=="string")t.style.height=i,this.fireEvent("infect",[{height:i}]);else return this.getSize().height;return this},count:function(i){return this.countMapping[i]=++this.countMapping[i]||1},display:function(i){var t=this.dom;if(typeof i=="boolean")t.style.display=i?"block":"none",this.fireEvent("infect",[{display:i}]);else return this.style("display")!=="none";return this},first:function(){for(var i=this.dom.firstChild;i&&!i.tagName&&i.nextSibling;)i=i.nextSibling;return i},add:function(i){var t;return t=Ucren.Element(i),this.dom.appendChild(t.dom),this},remove:function(i){var t;return i?(t=Ucren.Element(i),t.html(""),this.dom.removeChild(t.dom)):(t=Ucren.Element(this.dom.parentNode),t.remove(this)),this},insert:function(i){var t;return t=this.dom,t.firstChild?t.insertBefore(i,t.firstChild):this.add(i),this},addEvents:function(i){var t,e;return e={},t=this.dom,Ucren.each(i,function(s,h){e[h]=Ucren.addEvent(t,h,s)}),e},removeEvents:function(i){var t;return t=this.dom,Ucren.each(i,function(e,s){Ucren.delEvent(t,s,e)}),this},getPos:function(){var i,t,e,s,h;if(i=this.dom,e={},i.getBoundingClientRect){s=i.getBoundingClientRect(),h=Ucren.isIe?2:0;var m=document,T=Math.max(m.documentElement.scrollTop,m.body.scrollTop),v=Math.max(m.documentElement.scrollLeft,m.body.scrollLeft);return{x:s.left+v-h,y:s.top+T-h}}else{if(e={x:i.offsetLeft,y:i.offsetTop},t=i.offsetParent,t!==i)for(;t;)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;Ucren.isSafari&&this.style("position")==="absolute"&&(e.x-=document.body.offsetLeft,e.y-=document.body.offsetTop)}for(i.parentNode?t=i.parentNode:t=null;t&&t.tagName.toUpperCase()!=="BODY"&&t.tagName.toUpperCase()!=="HTML";)e.x-=t.scrollLeft,e.y-=t.scrollTop,t.parentNode?t=t.parentNode:t=null;return e},getSize:function(){var i=this.dom,t=this.style("display");if(t&&t!=="none")return{width:i.offsetWidth,height:i.offsetHeight};var e=i.style,s={visibility:e.visibility,position:e.position,display:e.display},h={visibility:"hidden",display:"block"};s.position!=="fixed"&&(h.position="absolute"),this.style(h);var m={width:i.offsetWidth,height:i.offsetHeight};return this.style(s),m},observe:function(i,t){return i=Ucren.Element(i),i.on("infect",t.bind(this)),this},usePNGbackground:function(i){var t;return t=this.dom,/\.png$/i.test(i)&&Ucren.isIe6?t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"',sizingMethod='scale');":t.style.backgroundImage="url("+i+")",this},setAlpha:function(){var i=/alpha\s*\(\s*opacity\s*=\s*([^)]+)\)/;return function(t){var e=this.dom,s=e.style;return Ucren.isIe?(e.currentStyle&&!e.currentStyle.hasLayout&&(s.zoom=1),i.test(s.filter)?(t=t>=99.99?"":"alpha(opacity="+t+")",s.filter=s.filter.replace(i,t)):s.filter+=" alpha(opacity="+t+")"):s.opacity=t/100,this}}(),fadeIn:function(i){typeof this.fadingNumber>"u"&&(this.fadingNumber=0),this.setAlpha(this.fadingNumber);var t=(function(){this.setAlpha(this.fadingNumber),this.fadingNumber===100?(clearInterval(this.fadingInterval),i&&i()):this.fadingNumber+=10}).bind(this);return this.display(!0),clearInterval(this.fadingInterval),this.fadingInterval=setInterval(t,Ucren.isIe?20:30),this},fadeOut:function(i){typeof this.fadingNumber>"u"&&(this.fadingNumber=100),this.setAlpha(this.fadingNumber);var t=(function(){this.setAlpha(this.fadingNumber),this.fadingNumber===0?(clearInterval(this.fadingInterval),this.display(!1),i&&i()):this.fadingNumber-=10}).bind(this);return clearInterval(this.fadingInterval),this.fadingInterval=setInterval(t,Ucren.isIe?20:30),this},useMouseAction:function(i,t){return this.MouseAction||(this.MouseAction=new Ucren.MouseAction({element:this})),this.MouseAction.use(i,t),this}});function postMessage(i,...t){Ucren.dispatch(i,t)}function addEventListener(i,t){Ucren.dispatch(i,t)}const message={postMessage,addEventListener};function unsetObject(i){for(const t in i)i.hasOwnProperty(t)&&typeof i[t]=="function"&&(i[t]=function(){})}function getAngleByRadian(i){return i*180/Math.PI}function pointToRadian(i,t){if(t[0]===i[0])return t[1]>i[1]?Math.PI*.5:Math.PI*1.5;if(t[1]===i[1])return t[0]>i[0]?0:Math.PI;const e=Math.atan((i[1]-t[1])/(i[0]-t[0]));return t[0]>i[0]&&t[1]<i[1]?e+2*Math.PI:t[0]>i[0]&&t[1]>i[1]?e:e+Math.PI}const average=function(i,t){return(i+t)/2>>0};class Juice{constructor(t,e,s,h,m,T){this._config=t,this._layerManager=e,this.originX=s,this.originY=h,this.color=m,this.anim=exponential.co,this.dropAnim=quadratic.co;const{JUICE_CONFIG:v}=this._config.options;this.shape=T||v.shapes.CIRCLE,this.radius=v.radius,this.distance=randomNumber(200)+100,this.dir=randomNumber(360)*Math.PI/180,this.dur=v.duration,this.shape=T}render(){const{LAYERS:t,JUICE_CONFIG:e}=this._config.options,s=this._layerManager.getLayer(t.JUICE);if(this.shape===e.shapes.CIRCLE)this.figure=s.circle(this.originX,this.originY,this.radius).attr({fill:this.color,stroke:"none"});else if(this.shape===e.shapes.SQUARE)this.figure=s.rect(this.originX-this.radius,this.originY-this.radius,this.radius*2,this.radius*2).attr({fill:this.color,stroke:"none"});else if(this.shape===e.shapes.DIAMOND){const h=this.createStarPath(this.originX,this.originY,this.radius,4);this.figure=s.path(h).attr({fill:this.color,stroke:"none"})}else if(this.shape===e.shapes.STAR){const h=this.createStarPath(this.originX,this.originY,this.radius,5);this.figure=s.path(h).attr({fill:this.color,stroke:"none"})}}createStarPath(t,e,s,h){const m=Math.PI/h;let T="";for(let v=0;v<2*h;v++){const b=v*m,w=v%2===0?s:s/2,S=t+w*Math.sin(b),O=e-w*Math.cos(b);T+=v===0?`M ${S} ${O}`:`L ${S} ${O}`}return T+="Z",T}sputter(){timeline.createTask({start:0,duration:this.dur,object:this,onTimeUpdate:this.onTimeUpdate,onTimeEnd:this.onTimeEnd})}onTimeUpdate(t){const{JUICE_CONFIG:e}=this._config.options,s=this.anim(t,0,this.distance,this.dur),h=this.originX+s*Math.cos(this.dir),m=this.originY+s*Math.sin(this.dir)+this.dropAnim(t,0,200,this.dur),T=this.anim(t,1,-1,this.dur);this.shape===e.shapes.CIRCLE?this.figure.attr({cx:h,cy:m}).scale(T,T):this.shape===e.shapes.SQUARE?this.figure.attr({x:h-this.radius*T,y:m-this.radius*T}).scale(T,T):this.shape===e.shapes.DIAMOND?this.figure.attr({path:this.createStarPath(h,m,this.radius*T,4)}).scale(T,T):this.shape===e.shapes.STAR&&this.figure.attr({path:this.createStarPath(h,m,this.radius*T,5)}).scale(T,T)}onTimeEnd(){this.figure.remove(),unsetObject(this)}}class JuiceFactory{constructor(t,e){this._config=t,this._layerManager=e;const{JUICE_CONFIG:s}=this._config.options;this.num=s.number}create(t,e,s){for(let h=0;h<this.num;h++)this.createOne(t,e,s)}createOne(t,e,s){if(!s)return;const{JUICE_CONFIG:h}=this._config.options,m=new Juice(this._config,this._layerManager,t,e,s,h.shape);m.render(),m.sputter()}}class Fruit{constructor(t,e,s,h,m){this._config=t,this._control=e,this._layerManager=s,this._flash=h,this.conf=m,this.zoomAnim=exponential.co,this.linearAnim=linear,this.dropAnim=quadratic.ci,this.fallOffAnim=quadratic.co,this.rotateSpeed=[60,50,40,-40,-50,-60],this.brokend=!1,this.apartAngle=0,this.aparted=!1,this.shotOutStartX=0,this.shotOutStartY=0,this.shotOutEndX=0,this.shotOutEndY=0,this.fallOffToX=0,this.fallTargetX=0,this.fallTargetY=0,this.touchedPosX=0,this.touchedPosY=0,this.brokenPosX=0,this.brokenPosY=0,this.brokenTargetX1=0,this.brokenTargetY1=0,this.brokenTargetX2=0,this.brokenTargetY2=0,this.touchedTargetX=0,this.touchedTargetY=0,this.bImage1RotateAngle=0,this.bImage2RotateAngle=0,this.fallOutOfViewerCalled=0,this.fallOffing=0,this.shotOut=(()=>{const b=[-1,1],{FRUIT_CONFIG:w}=this._config.options;return(S,O)=>(this.shotOutStartX=this.originX,this.shotOutStartY=this.originY,this.shotOutEndX=average(this.originX,O),this.shotOutEndY=Math.min(this.startY-randomNumber(this.startY-100),200),this.fallOffToX=O,timeline.createTask({start:S,duration:w.dropTime,object:this,onTimeUpdate:this.onShotOuting,onTimeStart:this.onShotOutStart,onTimeEnd:this.onShotOutEnd,recycle:this.anims}),this.type!==w.types.BOOM&&this.rotate(0,(randomNumber(180)+90)*b[randomNumber(2)]),this)})(),this.fallOff=(()=>{const b=[-1,1],{FRUIT_CONFIG:w}=this._config.options;let S=0;return(O,U)=>{if(this.aparted||this.brokend)return;const{viewportHeight:F}=viewportSize;this.fallOffing=1;const X=F+calcSize(120);typeof U!="number"&&(U=this.originX+randomNumber(w.dropXScope)*b[S++%2]),this.fallTargetX=U,this.fallTargetY=X,timeline.createTask({start:O,duration:w.dropTime,object:this,onTimeUpdate:this.onFalling,onTimeStart:this.onFallStart,onTimeEnd:this.onFallEnd,recycle:this.anims})}})(),this.clickHandler=b=>{const{MESSAGES:w}=this._config.options,S=b.clientX-this._control.canvasLeft,O=b.clientY-this._control.canvasTop;message.postMessage(w.TOUCH,[S,O])},this._config=t,this._control=e,this._layerManager=s,this._juiceFactory=new JuiceFactory(t,s),this._flash=h;const{FRUIT_CONFIG:T}=this._config.options;this.type=this.conf.type,this.originX=this.conf.originX,this.originY=this.conf.originY;const{radius:v}=T.infos[this.type];this.radius=v,this.startX=this.conf.originX,this.startY=this.conf.originY,this.anims=[]}set(t){const{IS_DEBUG:e,IS_TOUCH:s,LAYERS:h,FRUIT_CONFIG:m}=this._config.options,{radius:T,image:v,width:b,height:w,fixAngle:S}=m.infos[this.type];return this.shadow=this._layerManager.createImage(h.FRUIT,m.shadowImage,this.startX-T,this.startY-T+m.shadowPos,106,77),this.image=this._layerManager.createImage(h.FRUIT,v,this.startX-T,this.startY-T,b,w),s&&this.addClickHandler(),this.type===m.types.BOOM&&this.image.rotate(S),t&&(this.image.hide(),this.shadow.hide()),e&&this.showDebugCatchArea(),this}addClickHandler(){this.image.node.addEventListener("pointerdown",this.clickHandler)}removeClickHandler(){this.image.node.removeEventListener("pointerdown",this.clickHandler)}showDebugCatchArea(){const{originX:t,originY:e,radius:s}=this;this.debugArea=this.image.paper.circle(t,e,s).attr({stroke:"mediumblue","stroke-width":2,"stroke-dasharray":"- ",opacity:.5}),this.debugArea.insertBefore(this.image)}pos(t,e){const{IS_DEBUG:s,MESSAGES:h,FRUIT_CONFIG:m}=this._config.options,{viewportHeight:T}=viewportSize,v=this.radius;this.originX=t,this.originY=e,this.image.attr({x:t-=v,y:e-=v}),this.shadow.attr({x:t,y:e+m.shadowPos}),s&&this.debugArea.attr({cx:t+v,cy:e+v}),this.fallOffing&&!this.fallOutOfViewerCalled&&e>T+this.radius&&(this.fallOutOfViewerCalled=1,message.postMessage(h.FRUIT_FALL_OUT_OF_VIEWER,this))}show(t){const{MODES:e}=this._config.options;timeline.createTask({start:t,duration:500,data:[1e-5,1,e.SHOW],object:this,onTimeUpdate:this.onScaling,onTimeStart:this.onShowStart,recycle:this.anims})}hide(t){const{MODES:e,FRUIT_CONFIG:s}=this._config.options;this.type===s.types.BOOM&&(this.anims.clear&&this.anims.clear(),timeline.createTask({start:t,duration:500,data:[1,1e-5,e.HIDE],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd,recycle:this.anims}))}rotate(t,e){this.rotateSpeed=e||Array.isArray(this.rotateSpeed)?this.rotateSpeed[randomNumber(this.rotateSpeed.length)]:this.rotateSpeed,timeline.createTask({start:t,duration:-1,object:this,onTimeUpdate:this.onRotating,recycle:this.anims})}broken(t){if(this.brokend)return;this.brokend=!0;const{IS_TOUCH:e,FRUIT_CONFIG:s}=this._config.options,h=FruitFactory.fruitCache.indexOf(this);h>-1&&FruitFactory.fruitCache.splice(h,1),this.type!==s.types.BOOM?(this._flash.showAt(this.originX,this.originY,t),this._juiceFactory.create(this.originX,this.originY,s.infos[this.type].juiceColor),e?this.touched():this.apart(t)):this.hide()}pause(){this.brokend||this.anims.clear&&this.anims.clear()}touched(){const{MODES:t,FRUIT_CONFIG:e}=this._config.options;this.anims.clear&&this.anims.clear(),this.shadow.hide(),timeline.createTask({start:0,duration:e.dropTime,data:[1,1e-5,t.HIDE,1500],object:this,onTimeUpdate:this.onScaling,onTimeStart:this.onTouchedDropStart,onTimeEnd:this.onTouchedDropEnd,recycle:this.anims}),this.debugArea&&this.debugArea.remove()}apart(t){const{LAYERS:e,FRUIT_CONFIG:s}=this._config.options;this.anims.clear&&this.anims.clear(),this.image.hide(),this.shadow.hide(),this.aparted=!0;const h=s.infos[this.type],{cutImages:m,width:T,height:v,radius:b,fixAngle:w}=h,S=this._layerManager.createImage.saturate(this._layerManager,this.startX-b,this.startY-b,T,v);t=(t%180+360+w)%360,this.bImage1=S(e.FRUIT,m[0]),this.bImage2=S(e.FRUIT,m[1]),[this.bImage1,this.bImage2].invoke("rotate",t),this.apartAngle=t,timeline.createTask({start:0,duration:s.dropTime,object:this,onTimeUpdate:this.onBrokenDropUpdate,onTimeStart:this.onBrokenDropStart,onTimeEnd:this.onBrokenDropEnd,recycle:this.anims}),this.debugArea&&this.debugArea.remove()}remove(){const{IS_TOUCH:t,MESSAGES:e}=this._config.options;t&&this.removeClickHandler(),this.anims.clear&&this.anims.clear(),this.image&&(this.image.remove(),this.shadow.remove(),this.debugArea&&this.debugArea.remove()),this.bImage1&&(this.bImage1.remove(),this.bImage2.remove());const s=FruitFactory.fruitCache.indexOf(this);s>-1&&FruitFactory.fruitCache.splice(s,1);for(const h in this)typeof this[h]=="function"?this[h]=function(m){return function(){throw new Error("method "+m+" has been removed")}}(h):delete this[h];message.postMessage(e.FRUIT_REMOVE,this)}onShowStart(){this.image.show(),this.shadow.show()}onScaling(t,e,s,h,m=500){this.image.scale(h=this.zoomAnim(t,e,s-e,m),h),this.shadow.scale(h,h)}onHideEnd(){this.remove()}onRotating(t){const e=Array.isArray(this.rotateSpeed)?this.rotateSpeed[randomNumber(this.rotateSpeed.length)]:this.rotateSpeed;this.image.rotate(e*t/1e3%360,!0)}onTouchedDropStart(){const{viewportHeight:t,viewportWidth:e}=viewportSize;this.touchedTargetX=randomNumber(e)-175,this.touchedTargetY=t,this.touchedPosX=this.originX,this.touchedPosY=this.originY;for(let s=FruitFactory.fruitCache.length-1;s>=0;s--)FruitFactory.fruitCache[s]===this&&FruitFactory.fruitCache.splice(s,1)}onTouchedDropEnd(){this.remove()}onBrokenDropUpdate(t){const{FRUIT_CONFIG:e}=this._config.options,s=this.radius;this.bImage1.attr({x:this.linearAnim(t,this.brokenPosX-s,this.brokenTargetX1,e.dropTime),y:this.dropAnim(t,this.brokenPosY-s,this.brokenTargetY1-this.brokenPosY+s,e.dropTime)}).rotate(this.linearAnim(t,this.apartAngle,this.bImage1RotateAngle,e.dropTime),!0),this.bImage2.attr({x:this.linearAnim(t,this.brokenPosX-s,this.brokenTargetX2,e.dropTime),y:this.dropAnim(t,this.brokenPosY-s,this.brokenTargetY2-this.brokenPosY+s,e.dropTime)}).rotate(this.linearAnim(t,this.apartAngle,this.bImage2RotateAngle,e.dropTime),!0)}onBrokenDropStart(){const{FRUIT_CONFIG:t}=this._config.options,{viewportHeight:e}=viewportSize;this.brokenTargetX1=-(randomNumber(t.dropXScope)+75),this.brokenTargetX2=randomNumber(t.dropXScope+75),this.brokenTargetY1=e,this.brokenTargetY2=e,this.brokenPosX=this.originX,this.brokenPosY=this.originY,this.bImage1RotateAngle=-randomNumber(150)-50,this.bImage2RotateAngle=randomNumber(150)+50;for(let s=FruitFactory.fruitCache.length-1;s>=0;s--)FruitFactory.fruitCache[s]===this&&FruitFactory.fruitCache.splice(s,1)}onBrokenDropEnd(){this.remove()}onShotOuting(t){const{FRUIT_CONFIG:e}=this._config.options;this.pos(this.linearAnim(t,this.shotOutStartX,this.shotOutEndX-this.shotOutStartX,e.dropTime),this.fallOffAnim(t,this.shotOutStartY,this.shotOutEndY-this.shotOutStartY,e.dropTime))}onShotOutStart(){}onShotOutEnd(){this.fallOff(0,this.fallOffToX)}onFalling(t){const{FRUIT_CONFIG:e}=this._config.options;this.pos(this.linearAnim(t,this.brokenPosX,this.fallTargetX-this.brokenPosX,e.dropTime),this.dropAnim(t,this.brokenPosY,this.fallTargetY-this.brokenPosY,e.dropTime))}onFallStart(){this.brokenPosX=this.originX,this.brokenPosY=this.originY}onFallEnd(){const{MESSAGES:t}=this._config.options;message.postMessage(t.FRUIT_FALL_OFF,this),this.remove()}}const kt=class pe{constructor(t,e,s,h){this._config=t,this._control=e,this._layerManager=s,this._flash=h,this._safeNumber=0,this.safeNumber=this._config.options.FIRST_SAFE_FRUIT_NUMBER}get safeNumber(){return this._safeNumber}set safeNumber(t){this._safeNumber=Math.max(t,0)}create(t,e){const s=this.getType(),h=new Fruit(this._config,this._control,this._layerManager,this._flash,{type:s,originX:t,originY:e}).set();return pe.fruitCache.unshift(h),h}getType(){const{FRUIT_CONFIG:{types:t}}=this._config.options,e=[t.FIRST,t.SECOND,t.THIRD,t.FOURTH,t.FIFTH],s=randomNumber(8)===4&&!this.safeNumber;return this.safeNumber=this.safeNumber-1,s?t.BOOM:e[randomNumber(e.length)]}getFruitInView(){return pe.fruitCache}};kt.fruitCache=[];let FruitFactory=kt;function init$1(){const i={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,e){e=e||{};let s=0,h=[],m={},T=i.isSupported();this.load=function(){return T?(this.sound.load(),this):this},this.play=function(){return T?(this.sound.play().catch(console.warn),this):this},this.togglePlay=function(){return T?(this.sound.paused?this.sound.play().catch(console.warn):this.sound.pause(),this):this},this.pause=function(){return T?(this.sound.pause(),this):this},this.isPaused=function(){return T?this.sound.paused:null},this.stop=function(){return T?(this.setTime(this.getDuration()),this.sound.pause(),this):this},this.isEnded=function(){return T?this.sound.ended:null},this.loop=function(){return T?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return T?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return T?(this.sound.muted=!0,this):this},this.unmute=function(){return T?(this.sound.muted=!1,this):this},this.toggleMute=function(){return T?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return T?this.sound.muted:null},this.setVolume=function(S){return T?(S<0&&(S=0),S>100&&(S=100),this.volume=S,this.sound.volume=S/100,this):this},this.getVolume=function(){return T?this.volume:this},this.increaseVolume=function(S){return this.setVolume(this.volume+(S||1))},this.decreaseVolume=function(S){return this.setVolume(this.volume-(S||1))},this.setTime=function(S){return T?(this.whenReady(function(){this.sound.currentTime=S}),this):this},this.getTime=function(){if(!T)return null;const S=Math.round(this.sound.currentTime*100)/100;return isNaN(S)?i.defaults.placeholder:S},this.setPercent=function(S){return T?this.setTime(i.fromPercent(S,this.sound.duration)):this},this.getPercent=function(){if(!T)return null;const S=Math.round(i.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(S)?i.defaults.placeholder:S},this.setSpeed=function(S){if(!T)return this;this.sound.playbackRate=S},this.getSpeed=function(){return T?this.sound.playbackRate:null},this.getDuration=function(){if(!T)return null;const S=Math.round(this.sound.duration*100)/100;return isNaN(S)?i.defaults.placeholder:S},this.getPlayed=function(){return T?v(this.sound.played):null},this.getBuffered=function(){return T?v(this.sound.buffered):null},this.getSeekable=function(){return T?v(this.sound.seekable):null},this.getErrorCode=function(){return T&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!T)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return T?this.sound.readyState:null},this.getStateMessage=function(){if(!T)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return T?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!T)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(S,O){return T?(this.sound[S]=O,this):this},this.get=function(S){return T?S?this.sound[S]:this.sound:null},this.bind=function(S,O){if(!T)return this;S=S.split(" ");const U=this,F=function(X){O.call(U,X)};for(let X=0;X<S.length;X++){let M=S[X],z=M;M=z.split(".")[0],h.push({idx:z,func:F}),this.sound.addEventListener(M,F,!0)}return this},this.unbind=function(S){if(!T)return this;S=S.split(" ");for(let O=0;O<S.length;O++){const U=S[O],F=U.split(".")[0];for(let X=0;X<h.length;X++){const M=h[X].idx.split(".");(h[X].idx===U||M[1]&&M[1]===U.replace(".",""))&&(this.sound.removeEventListener(F,h[X].func,!0),h.splice(X,1))}}return this},this.bindOnce=function(S,O){if(!T)return this;const U=this;m[s++]=!1,this.bind(s+S,function(){m[s]||(m[s]=!0,O.call(U)),U.unbind(s+S)})},this.trigger=function(S){if(!T)return this;S=S.split(" ");for(let O=0;O<S.length;O++){const U=S[O];for(let F=0;F<h.length;F++){const X=h[F].idx.split(".");if(h[F].idx===U||X[0]&&X[0]===U.replace(".","")){const M=document.createEvent("HTMLEvents");M.initEvent(X[0],!1,!0),this.sound.dispatchEvent(M)}}}return this},this.fadeTo=function(S,O,U){if(!T)return this;O instanceof Function?(U=O,O=i.defaults.duration):O=O||i.defaults.duration;const F=this.volume,X=O/Math.abs(F-S),M=this;this.play();function z(){setTimeout(function(){F<S&&M.volume<S?(M.setVolume(M.volume+=1),z()):F>S&&M.volume>S?(M.setVolume(M.volume-=1),z()):U instanceof Function&&U.apply(M)},X)}return this.whenReady(function(){z()}),this},this.fadeIn=function(S,O){return T?this.setVolume(0).fadeTo(100,S,O):this},this.fadeOut=function(S,O){return T?this.fadeTo(0,S,O):this},this.fadeWith=function(S,O){return T?(this.fadeOut(O,function(){this.stop()}),S.play().fadeIn(O),this):this},this.whenReady=function(S){if(!T)return null;const O=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){S.call(O)}):S.call(O)};function v(S){const O=[],U=S.length-1;for(let F=0;F<=U;F++)O.push({start:S.start(U),end:S.end(U)});return O}function b(S){return S.split(".").pop()}function w(S,O){const U=document.createElement("source");U.src=O,i.types[b(O)]&&(U.type=i.types[b(O)]),S.appendChild(U)}if(T&&t){for(const S in i.defaults)i.defaults.hasOwnProperty(S)&&(e[S]=e[S]||i.defaults[S]);if(this.sound=document.createElement("audio"),t instanceof Array)for(const S in t)t.hasOwnProperty(S)&&w(this.sound,t[S]);else if(e.formats.length)for(const S in e.formats)e.formats.hasOwnProperty(S)&&w(this.sound,t+"."+e.formats[S]);else w(this.sound,t);e.loop&&this.loop(),e.autoplay&&(this.sound.autoplay="autoplay"),e.preload===!0?this.sound.preload="auto":e.preload===!1?this.sound.preload="none":this.sound.preload=e.preload,this.setVolume(e.volume),i.sounds.push(this)}},group:function(t){t=s(t,arguments),this.getSounds=function(){return t},this.add=function(h){h=s(h,arguments);for(let m=0;m<h.length;m++)t.push(h[m])},this.remove=function(h){h=s(h,arguments);for(let m=0;m<h.length;m++)for(let T=0;T<t.length;T++)if(t[T]==h[m]){delete t[T];break}},this.load=function(){return e("load"),this},this.play=function(){return e("play"),this},this.togglePlay=function(){return e("togglePlay"),this},this.pause=function(h){return e("pause",h),this},this.stop=function(){return e("stop"),this},this.mute=function(){return e("mute"),this},this.unmute=function(){return e("unmute"),this},this.toggleMute=function(){return e("toggleMute"),this},this.setVolume=function(h){return e("setVolume",h),this},this.increaseVolume=function(h){return e("increaseVolume",h),this},this.decreaseVolume=function(h){return e("decreaseVolume",h),this},this.loop=function(){return e("loop"),this},this.unloop=function(){return e("unloop"),this},this.setTime=function(h){return e("setTime",h),this},this.setduration=function(h){return e("setduration",h),this},this.set=function(h,m){return e("set",h,m),this},this.bind=function(h,m){return e("bind",h,m),this},this.unbind=function(h){return e("unbind",h),this},this.bindOnce=function(h,m){return e("bindOnce",h,m),this},this.trigger=function(h){return e("trigger",h),this},this.fade=function(h,m,T,v){return e("fade",h,m,T,v),this},this.fadeIn=function(h,m){return e("fadeIn",h,m),this},this.fadeOut=function(h,m){return e("fadeOut",h,m),this};function e(){const h=s(null,arguments),m=h.shift();for(let T=0;T<t.length;T++)t[T][m].apply(t[T],h)}function s(h,m){return h instanceof Array?h:Array.prototype.slice.call(m)}},all:function(){return new i.group(i.sounds)},isSupported:function(){return!!i.el.canPlayType},isOGGSupported:function(){return!!i.el.canPlayType&&i.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!i.el.canPlayType&&i.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!i.el.canPlayType&&i.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!i.el.canPlayType&&(i.el.canPlayType("audio/x-m4a;")||i.el.canPlayType("audio/aac;"))},toTimer:function(t,e){let s,h,m;return s=Math.floor(t/3600),s=isNaN(s)?"--":s>=10?s:"0"+s,h=Math.floor(e?t/60%60:t/60),h=isNaN(h)?"--":h>=10?h:"0"+h,m=Math.floor(t%60),m=isNaN(m)?"--":m>=10?m:"0"+m,e?s+":"+h+":"+m:h+":"+m},fromTimer:function(t){const e=t.toString().split(":");return e&&e.length===3&&(t=parseInt(e[0],10)*3600+parseInt(e[1],10)*60+parseInt(e[2],10)),e&&e.length===2&&(t=parseInt(e[0],10)*60+parseInt(e[1],10)),t},toPercent:function(t,e,s){const h=Math.pow(10,s||0);return Math.round(t*100/e*h)/h},fromPercent:function(t,e,s){const h=Math.pow(10,s||0);return Math.round(e/100*t*h)/h}};return i}const buzz=init$1();class Sound{constructor(t,e){this._src=t,this._soundButton=e,this.sound=new buzz.sound(this.getBasePath(this._src),{formats:["ogg","mp3"],preload:!0,autoload:!0,loop:!1})}play(){this.sound.setPercent(0),this._soundButton.isOn&&this.sound.play(),this._soundButton.isOn&&this.sound.fadeIn(500)}stop(){this._soundButton.isOn?this.sound.fadeOut(1e3,this.sound.pause.bind(this.sound)):this.sound.stop()}getBasePath(t){return t.replace(/\.(ogg|mp3)$/,"")}}class SoundFactory{constructor(t){this._soundButton=t}create(t){return t?new Sound(t,this._soundButton):null}}class LayerManager{constructor(t){this._config=t,this.num=2,this.layers={};const{LAYERS:e}=this._config.options;this.zIndexes={[e.PRELOAD]:this.zi(),[e.DEFAULT]:this.zi(),[e.FLASH]:this.zi(),[e.JUICE]:this.zi(),[e.KNIFE]:this.zi(),[e.LIGHT]:this.zi(),[e.FRUIT]:this.zi(),[e.MASK]:this.zi(),[e.START_SCREEN]:this.zi(),[e.RESULT_SCREEN]:this.zi(),[e.BRAND_INTRO]:this.zi(),[e.BRAND_QUESTION]:this.zi()}}createText(t,e,s,h,m="#fff",T="14px",v="normal",b="start"){const w=this.getLayer(t),{FONT_FAMILY:S}=this._config.options;return w.text(s,h,e).attr({"font-family":S,fill:m,"font-size":T,"font-weight":v,"text-anchor":b})}getLayer(t){const{viewportHeight:e,viewportWidth:s}=viewportSize,{rootElement:h}=this._config,{LAYERS:m}=this._config.options;t=t||m.DEFAULT;let T=this.layers[t],v;return T||(v=makeElement("div",{class:"layer","data-name":t,style:"z-index: "+(this.zIndexes[t]||0)+";"}),Ucren.Element(h).add(v),T=this.layers[t]=Raphael(v,s,e),T)}createImage(t,e,s,h,m,T,v="none"){return this.getLayer(t).image(e,s,h,m,T,v)}hideLayer(t){const e=this.getLayer(t);e&&e.canvas&&e.canvas.parentNode&&(e.canvas.parentNode.style.display="none")}showLayer(t){const e=this.getLayer(t);e&&e.canvas&&e.canvas.parentNode&&(e.canvas.parentNode.style.display="block")}zi(){return this.num=++this.num||2}}class Background{constructor(t,e){this._config=t,this._layerManager=e,this.time=null,this.getWobble=()=>{const s=randomNumber(12)-6,h=randomNumber(12)-6;this.image.attr({x:s,y:h})},this.stop=()=>{this.time&&this.time.stop(),this.image.attr({x:0,y:0})}}set(){const{BACKGROUND_CONFIG:t,LAYERS:e}=this._config.options;this.image=this._layerManager.createImage(e.DEFAULT,t.image,t.x,t.y,t.width,t.height,t.preserveAspectRatio)}wobble(){this.time=timeline._setInterval(this.getWobble,50)}}class Flash{constructor(t,e,s){this._config=t,this._layerManager=e,this._soundFactory=s,this.xDiff=0,this.yDiff=0,this.switchOn=!0,this.anim=quadratic.cio,this.anims=[];const{SOUNDS:h}=this._config.options;this.snd=this._soundFactory.create(h[SoundNames.SPLATTER])}set(){if(!this.switchOn)return!1;const{LAYERS:t,FLASH_CONFIG:e}=this._config.options;this.image=this._layerManager.createImage(t.FLASH,e.image,0,0,e.width,e.height).hide()}showAt(t,e,s){const{FLASH_CONFIG:h}=this._config.options;if(!this.switchOn)return!1;this.image&&this.image.rotate(s,!0).scale(1e-5,1e-5).attr({x:t+this.xDiff,y:e+this.yDiff}).show(),this.anims.clear&&this.anims.clear(),this.snd&&this.snd.play(),timeline.createTask({start:0,duration:h.duration,data:[1e-5,1],object:this,onTimeUpdate:this.onTimeUpdate,recycle:this.anims}),timeline.createTask({start:h.duration,duration:h.duration,data:[1,1e-5],object:this,onTimeUpdate:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,s,h){if(!this.switchOn)return!1;const{FLASH_CONFIG:m}=this._config.options;this.image.scale(h=this.anim(t,e,s-e,m.duration),h)}}class KnifePart{constructor(t,e,s,h){this._config=t,this._layerManager=e,this._knifes=s,this.conf=h,this.sx=this.conf.sx,this.sy=this.conf.sy,this.ex=this.conf.ex,this.ey=this.conf.ey}set(){const{KNIFE_PART_CONFIG:t,LAYERS:e}=this._config.options,s=this._layerManager.getLayer(e.KNIFE);let h,m,T,v,b,w,S,O;return h=this.sx,m=this.sy,T=this.ex,v=this.ey,b=h-T,w=m-v,S=Math.abs(b),O=Math.abs(w),S>O?(h+=b<0?-1:1,m+=w<0?-(O/S):O/S):(h+=b<0?-(S/O):S/O,m+=w<0?-1:1),this.line=s.path("M"+h+","+m+"L"+T+","+v).attr({stroke:t.color,"stroke-width":t.stroke+"px"}),timeline.createTask({start:0,duration:t.life,object:this,onTimeUpdate:this.update,onTimeEnd:this.end,recycle:this._knifes.anims}),this}update(t){const{KNIFE_PART_CONFIG:e}=this._config.options;this.line.attr("stroke-width",e.stroke*(1-t/e.life)+"px")}end(){this.line.remove();const t=this._knifes.indexOf(this);t&&this._knifes.splice(t,1)}}class Knifes{constructor(t,e){this._config=t,this._layerManager=e,this._knifeParts=[],this.lastX=null,this.lastY=null,this.switchState=!0,this._anims=[]}get anims(){return this._anims}newKnife(){this.lastX=null,this.lastY=null}through(t,e){if(!this.switchState)return;let s=null;return this.lastX!==null&&(this.lastX!==t||this.lastY!==e)&&(this.push(new KnifePart(this._config,this._layerManager,this,{sx:this.lastX,sy:this.lastY,ex:t,ey:e}).set()),s=[this.lastX,this.lastY,t,e]),this.lastX=t,this.lastY=e,s}pause(){this.anims.clear&&this.anims.clear(),this.switchOff()}switchOff(){this.switchState=!1,this.endAll()}switchOn(){this.switchState=!0,this.endAll()}endAll(){for(let t=this._knifeParts.length-1;t>=0;t--)this._knifeParts[t].end()}push(t){this._knifeParts.push(t)}indexOf(t){return this._knifeParts.indexOf(t)}splice(t,e){this._knifeParts.splice(t,e)}}const VIBRATION_PATTERNS={DEFAULT:[100],SOUND_BUTTON:[30],FRUIT:[30],GAME_OVER:[10,0,10,0,100,0,600],BOOM:[10,0,10,0,100,0,600,0,10,0,10,0,100,0,400]};class Vibration{vibrate(t=VIBRATION_PATTERNS.DEFAULT){navigator.vibrate&&navigator.vibrate(t)}soundButton(){this.vibrate(VIBRATION_PATTERNS.SOUND_BUTTON)}fruit(){this.vibrate(VIBRATION_PATTERNS.FRUIT)}gameOver(){this.vibrate(VIBRATION_PATTERNS.GAME_OVER)}boom(){this.vibrate(VIBRATION_PATTERNS.BOOM)}}const vibration=new Vibration;class Lose{constructor(t,e){this._config=t,this._layerManager=e,this.anim=exponential.co,this.back=back.co,this.info=[],this.number=0,this.anims=[],this.animLength=this._config.options.LOSE_CONFIG.animLength}set(){const{LAYERS:t,LOSE_CONFIG:e}=this._config.options;this.o1=this._layerManager.createImage(t.DEFAULT,e.conf[0].src,e.conf[0].sx,e.conf[0].y,e.conf[0].w,e.conf[0].h).hide(),this.o2=this._layerManager.createImage(t.DEFAULT,e.conf[1].src,e.conf[1].sx,e.conf[1].y,e.conf[1].w,e.conf[1].h).hide(),this.o3=this._layerManager.createImage(t.DEFAULT,e.conf[2].src,e.conf[2].sx,e.conf[2].y,e.conf[2].w,e.conf[2].h).hide(),this.info=[{image:this.o1,config:e.conf[0]},{image:this.o2,config:e.conf[1]},{image:this.o3,config:e.conf[2]}]}show(t){const{LOSE_CONFIG:e,MODES:s}=this._config.options;this.number=0,timeline.createTask({start:t,duration:this.animLength,data:[s.SHOW,e.conf[0].sx,e.conf[0].ex,e.conf[1].sx,e.conf[1].ex,e.conf[2].sx,e.conf[2].ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){const{LOSE_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:this.animLength,data:[s.HIDE,e.conf[0].ex,e.conf[0].sx,e.conf[1].ex,e.conf[1].sx,e.conf[2].ex,e.conf[2].sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}showLoseAt(){const{MESSAGES:t,SCENES:e}=this._config.options,{image:s,config:h}=this.info[this.number]||{},m=!!s&&s.attr("src")!==h.srcF;m&&s.attr("src",h.srcF).scale(1e-5,1e-5),m&&this.scaleImage(s),m&&vibration.vibrate(),this.number<3&&(this.number++,this.number===3&&(vibration.gameOver(),timeline.setTimeout(()=>{message.postMessage(t.GAME_OVER),message.postMessage(t.SCENE_SWITCH_SCENE,e.GAME_OVER)},1e3)))}scaleImage(t){t.myOnScaling=t.myOnScaling||((e,s)=>{t.scale(s=this.back(e,1e-5,1-1e-5,500),s)}),t.myOnScaleEnd=t.myOnScaleEnd||function(){t.scale(1,1)},timeline.createTask({start:0,duration:500,object:t,onTimeUpdate:t.myOnScaling,onTimeEnd:t.myOnScaleEnd,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T,v,b){this.o1.attr("x",this.anim(t,s,h-s,this.animLength)),this.o2.attr("x",this.anim(t,m,T-m,this.animLength)),this.o3.attr("x",this.anim(t,v,b-v,this.animLength))}onTimeStart(t){const{MODES:e}=this._config.options;t===e.SHOW&&([this.o1,this.o2,this.o3].invoke(t),this.resurrect())}onTimeEnd(t){const{MODES:e}=this._config.options;t===e.HIDE&&([this.o1,this.o2,this.o3].invoke(t),this.die())}resurrect(){this.info.forEach(({image:t,config:e})=>{t.attr("src",e.src)})}die(){this.info.forEach(({image:t,config:e})=>{t.attr("src",e.srcF)})}}class Score{constructor(t,e){this._config=t,this._layerManager=e,this.setTimeout=timeline.setTimeout.bind(timeline),this.anim=exponential.co,this.anims=[]}set(){const{LAYERS:t,SCORE_CONFIG:e,SCORE:s}=this._config.options;this.image=this._layerManager.createImage(t.DEFAULT,e.image,e.imageSx,e.imageY,e.imageW,e.imageH).hide(),this.text1=this._layerManager.createText(t.DEFAULT,e.text1Value,e.text1Sx,e.text1Y,e.text1Fill,e.text1Size,e.text1Weight).hide(),this.text2=this._layerManager.createText(t.DEFAULT,[e.text2Prefix.trim(),s.user_record.toString()].join(" "),e.text2Sx,e.text2Y,e.text2Fill,e.text2Size,e.text2Weight).hide()}show(t){const{MODES:e,SCORE_CONFIG:s}=this._config.options;timeline.createTask({start:t,duration:s.animLength,data:[e.SHOW,s.imageSx,s.imageEx,s.text1Sx,s.text1Ex,s.text2Sx,s.text2Ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTime,onTimeEnd:this.onTime,recycle:this.anims})}hide(t){const{MODES:e,SCORE_CONFIG:s}=this._config.options;timeline.createTask({start:t,duration:s.animLength,data:[e.HIDE,s.imageEx,s.imageSx,s.text1Ex,s.text1Sx,s.text2Ex,s.text2Sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTime,onTimeEnd:this.onTime,recycle:this.anims})}number(t){this.text1.attr("text",t||0),this.image.scale(1.2,1.2),this.setTimeout(()=>{this.image.scale(1,1)},60)}onTimeUpdate(t,e,s,h,m,T,v,b){const{SCORE_CONFIG:w}=this._config.options;this.image.attr("x",this.anim(t,s,h-s,w.animLength)),this.text1.attr("x",this.anim(t,m,T-m,w.animLength)),this.text2.attr("x",this.anim(t,v,b-v,w.animLength))}onTime(t){[this.image,this.text1,this.text2].invoke(t)}}class SoundButton{constructor(t,e){this._config=t,this._layerManager=e,this.anims=[],this.anim=exponential.co,this.isOn=!1}set(){const{LAYERS:t,SOUND_BUTTON_CONFIG:e,MESSAGES:s}=this._config.options;this.startSoundButton=this._layerManager.createImage(t.START_SCREEN,this.isOn?e.imageOn:e.imageOff,e.imageX,e.imageStartY,e.imageWidth,e.imageHeight).hide(),this.startText=this._layerManager.createText(t.START_SCREEN,this.isOn?e.textValueOff:e.textValueOn,e.textX,e.textStartY,e.textFill,e.textSize,e.textWeight,e.textAnchor),this.startGroup=this._layerManager.getLayer(t.START_SCREEN).set(),this.startGroup.push(this.startSoundButton,this.startText),this.startGroup.click(()=>{this.toggle(),message.postMessage(s.TOGGLE_SOUND,null),vibration.soundButton()}),this.gameSoundButton=this._layerManager.createImage(t.FRUIT,this.isOn?e.imageOn:e.imageOff,e.imageX,e.imageStartY,e.imageWidth,e.imageHeight).hide(),this.gameText=this._layerManager.createText(t.FRUIT,this.isOn?e.textValueOff:e.textValueOn,e.textX,e.textStartY,e.textFill,e.textSize,e.textWeight,e.textAnchor),this.gameGroup=this._layerManager.getLayer(t.FRUIT).set(),this.gameGroup.push(this.gameSoundButton,this.gameText),this.gameGroup.click(()=>{this.toggle(),message.postMessage(s.TOGGLE_SOUND,null),vibration.soundButton()}),this.resultSoundButton=this._layerManager.createImage(t.RESULT_SCREEN,this.isOn?e.imageOn:e.imageOff,e.imageX,e.imageStartY,e.imageWidth,e.imageHeight).hide(),this.resultText=this._layerManager.createText(t.RESULT_SCREEN,this.isOn?e.textValueOff:e.textValueOn,e.textX,e.textStartY,e.textFill,e.textSize,e.textWeight,e.textAnchor),this.resultGroup=this._layerManager.getLayer(t.START_SCREEN).set(),this.resultGroup.push(this.resultSoundButton,this.resultText),this.resultGroup.click(()=>{this.toggle(),message.postMessage(s.TOGGLE_SOUND,null),vibration.soundButton()})}show(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.SHOW,e.imageStartY,e.imageHomeEndY,e.textStartY,e.textHomeEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hide(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.SHOW,e.imageHomeEndY,e.imageStartY,e.textHomeEndY,e.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showHomeSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.SHOW,e.imageStartY,e.imageHomeEndY,e.textStartY,e.textHomeEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showResultSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.SHOW,e.imageStartY,e.imageResultEndY,e.textStartY,e.textResultEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showGameSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.SHOW,e.imageStartY,e.imageGameEndY,e.textStartY,e.textGameEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideHomeSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.HIDE,e.imageHomeEndY,e.imageStartY,e.textHomeEndY,e.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideResultSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.HIDE,e.imageResultEndY,e.imageStartY,e.textResultEndY,e.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideGameSoundButton(t){const{SOUND_BUTTON_CONFIG:e,MODES:s}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[s.HIDE,e.imageGameEndY,e.imageStartY,e.textGameEndY,e.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T){const{HOME_TEXT_CONFIG:v}=this._config.options;this.startSoundButton.attr("y",this.anim(t,s,h-s,v.animLength)),this.startText.attr("y",this.anim(t,m,T-m,v.animLength)),this.gameSoundButton.attr("y",this.anim(t,s,h-s,v.animLength)),this.gameText.attr("y",this.anim(t,m,T-m,v.animLength)),this.resultSoundButton.attr("y",this.anim(t,s,h-s,v.animLength)),this.resultText.attr("y",this.anim(t,m,T-m,v.animLength))}onTimeStart(t){const{MODES:e}=this._config.options;t===e.SHOW&&[this.startSoundButton,this.startText,this.gameSoundButton,this.gameText,this.resultSoundButton,this.resultText].invoke(t)}onTimeEnd(t){const{MODES:e}=this._config.options;t===e.HIDE&&[this.startSoundButton,this.startText,this.gameSoundButton,this.gameText,this.resultSoundButton,this.resultText].invoke(t)}toggle(){this.isOn?this.off():this.on()}on(){const{SOUND_BUTTON_CONFIG:t}=this._config.options;this.startText.attr("text",t.textValueOff),this.startSoundButton.attr("src",t.imageOn),this.gameText.attr("text",t.textValueOff),this.gameSoundButton.attr("src",t.imageOn),this.resultText.attr("text",t.textValueOff),this.resultSoundButton.attr("src",t.imageOn),this.isOn=!0}off(){const{SOUND_BUTTON_CONFIG:t}=this._config.options;this.startText.attr("text",t.textValueOn),this.startSoundButton.attr("src",t.imageOff),this.gameText.attr("text",t.textValueOn),this.gameSoundButton.attr("src",t.imageOff),this.resultText.attr("text",t.textValueOn),this.resultSoundButton.attr("src",t.imageOff),this.isOn=!1}}class PreloadFactory{constructor(t,e){this._config=t,this._displacementFactory=e,this.create=s=>{const{LAYERS:h}=this._config.options;this._displacementFactory.create({layer:h.PRELOAD,imageSrc:s,width:0,height:0,startX:0,startY:0,endX:0,endY:0,animMap:{},duration:0}).set()},this.URLs.forEach(this.create)}get URLs(){const{FRUIT_CONFIG:t,LOSE_CONFIG:e}=this._config.options;return[Object.values(t.infos).map(({image:s,cutImages:[h,m]})=>[s,h,m]).flat(),t.shadowImage,e.conf.map(({src:s})=>s)].flat().filter(Boolean)}}const stack={},cache={};class State{constructor(t){this.key=t}is(t){return stack[this.key]===t}isnot(t){return stack[this.key]!==t}ison(){return this.is(!0)}isoff(){return this.isnot(!0)}isunset(){return this.is(void 0)}set(t){stack[this.key]=t}get(){return stack[this.key]}on(){return this.set(!0),{keep:t=>{timeline.setTimeout(()=>this.set(!1),t)}}}off(){return this.set(!1),{keep:t=>{timeline.setTimeout(()=>this.set(!0),t)}}}}const state=i=>cache[i]?cache[i]:cache[i]=new State(i);class Collide{constructor(t){this._fruitFactory=t}checkSlice(t){const e=[];let s=0;return this._fruitFactory.getFruitInView().forEach(h=>{this.isLineIntersectingEllipse(t.slice(0,2),t.slice(2,4),[h.originX,h.originY],h.radius)&&(e[s++]=h)}),e}checkTouch(t){const e=[];let s=0;return this._fruitFactory.getFruitInView().forEach(h=>{this.isPointInsideEllipse(t,[h.originX,h.originY],h.radius)&&(e[s++]=h)}),e}isPointInsideEllipse(t,e,s){const h=t[0]-e[0],m=t[1]-e[1];return h*h+m*m<=s*s}isLineIntersectingEllipse(t,e,s,h,m=1){const T=this.calculateLineEllipseIntersections(t,e,s,h,m);return T&&(T[0]||T[1])}calculateLineEllipseIntersections(t,e,s,h,m=1){if(h<=0)return;const T=h,v=h*m,b=this.square(v)*this.square(t[0]-e[0])+this.square(T)*this.square(t[1]-e[1]);if(b<=0)return;const w=2*this.square(v)*(e[0]-t[0])*(t[0]-s[0])+2*this.square(T)*(e[1]-t[1])*(t[1]-s[1]),S=this.square(v)*this.square(t[0]-s[0])+this.square(T)*this.square(t[1]-s[1])-this.square(T)*this.square(v),O=this.solveQuadraticEquation(b,w,S);if(!O)return;const U=[[t[0]+O[0]*(e[0]-t[0]),t[1]+O[0]*(e[1]-t[1])],[t[0]+O[1]*(e[0]-t[0]),t[1]+O[1]*(e[1]-t[1])]];return this.isPointOnSegment(U[0],t,e)||(U[0]=null),this.isPointOnSegment(U[1],t,e)||(U[1]=null),U}isPointOnSegment(t,e,s){return t?this.getSign(t[0]-e[0])*this.getSign(t[0]-s[0])<=0&&this.getSign(t[1]-e[1])*this.getSign(t[1]-s[1])<=0:!1}square(t){return Math.pow(t,2)}getSign(t){return t<0?-1:t>0?1:0}solveQuadraticEquation(t,e,s){if(t===0)return;const h=e*e-4*t*s;if(h===0){const m=-e/(2*t);return[m,m]}else if(h>0){const m=Math.sqrt(h);return[(-e+m)/(2*t),(-e-m)/(2*t)]}}}class Control{constructor(t,e){this._config=t,this._knifes=e,this.canvasTop=0,this.canvasLeft=0,this.fix=()=>{const{viewportWidth:s,viewportHeight:h}=viewportSize;this.canvasLeft=(document.documentElement.clientWidth-s)/2,this.canvasTop=(document.documentElement.clientHeight-h)/2},this.dragHandler=(s,h,m,T,v)=>{const{MESSAGES:b,INTERACTION_MODE:w,INTERACTION_MODES:S}=this._config.options,O=m-this.canvasLeft,U=T-this.canvasTop;if(w===S.SLICE){const F=this._knifes.through(O,U);F&&message.postMessage(b.SLICE,F)}else w===S.TOUCH&&message.postMessage(b.TOUCH,[O,U])},this.startDragHandler=()=>{this._knifes.newKnife()}}init(){this.fixCanvasPos(),this.installDragger()}fixCanvasPos(){this.fix(),Ucren.addEvent(window,"resize",this.fix)}installDragger(){const t=new Ucren.BasicDrag({type:"calc"});t.on("returnValue",this.dragHandler),t.on("startDrag",this.startDragHandler),t.bind(document.documentElement)}}class Light{constructor(t,e){this._config=t,this._layerManager=e,this.lights=[],this.indexes=[],this.overWhiteLight=()=>{const{LAYERS:m,LIGHTS_CONFIG:T,MESSAGES:v,SCENES:b}=this._config.options,w=this._layerManager.getLayer(m.MASK),{viewportHeight:S,viewportWidth:O}=viewportSize;message.postMessage(v.OVER_WHITE_LIGHT_SHOW),this.removeLights();const U=T.maskAppearanceTime,F=w.rect(0,0,O,S).attr({fill:T.fill,stroke:"none"}),X={onTimeUpdate:function(M){F.attr("opacity",1-M/U)},onTimeEnd:()=>{F.remove(),message.postMessage(v.GAME_OVER),message.postMessage(v.SCENE_SWITCH_SCENE,b.GAME_OVER),this._layerManager.hideLayer(m.LIGHT),this._layerManager.hideLayer(m.MASK)}};this._layerManager.showLayer(m.MASK),timeline.createTask({start:0,duration:U,object:X,onTimeUpdate:X.onTimeUpdate,onTimeEnd:X.onTimeEnd})};const{LAYERS:s,LIGHTS_CONFIG:h}=this._config.options;for(let m=0;m<h.number;m++)this.indexes[m]=m;this._layerManager.hideLayer(s.LIGHT),this._layerManager.hideLayer(s.MASK)}start(t,e){const{LIGHTS_CONFIG:s}=this._config.options,h=t.originX,m=t.originY,T=this.indexes.random();let v=0;const b=w=>{this.build(h,m,T[w])};for(let w=0;w<s.number;w++)timeline.setTimeout(()=>b(w),v+=s.appearanceTime);timeline.setTimeout(()=>{this.overWhiteLight(),e&&e()},v)}removeLights(){const t=this.lights.length;for(let e=0;e<t;e++)this.lights[e].remove();this.lights.length=0}build(t,e,s){const{LAYERS:h,LIGHTS_CONFIG:m}=this._config.options,T=this._layerManager.getLayer(h.LIGHT),{viewportWidth:v}=viewportSize;let b=s*36+randomNumber(10),w=b+5;b=Math.PI*b/180,w=Math.PI*w/180;const S=t+2*v*Math.cos(b),O=e+2*v*Math.sin(b),U=t+2*v*Math.cos(w),F=e+2*v*Math.sin(w),X=T.path(["M",t,e,"L",S,O,"L",U,F,"Z"]).attr({stroke:"none",fill:m.fill});this._layerManager.showLayer(h.LIGHT),this.lights.push(X)}}class Game{constructor(t,e,s,h,m,T,v,b){this._config=t,this._fruitFactory=e,this._layerManager=s,this._knifes=h,this._soundFactory=m,this._score=T,this._lose=v,this._background=b,this.scoreNumber=0,this.volleyNum=3,this.volleyMultipleNumber=5,this.fruits=[],this.gameInterval=null,this.barbette=()=>{if(this.fruits.length>=this.volleyNum)return;const{viewportHeight:U,viewportWidth:F}=viewportSize,X=randomNumber(F),M=randomNumber(F),z=U,H=this._fruitFactory.create(X,z).shotOut(0,M);this.fruits.push(H),this.snd&&this.snd.play(),this.barbette()},this._light=new Light(this._config,this._layerManager);const{FRUIT_CONFIG:w,MESSAGES:S,SOUNDS:O}=this._config.options;this.snd=this._soundFactory.create(O[SoundNames.THROW]),this.boomSnd=this._soundFactory.create(O[SoundNames.BOOM]),message.addEventListener(S.FRUIT_REMOVE,U=>{const F=this.fruits.indexOf(U);F>-1&&this.fruits.splice(F,1)}),message.addEventListener(S.FRUIT_FALL_OUT_OF_VIEWER,U=>{U.type!==w.types.BOOM&&this._lose.number<3&&this._lose.showLoseAt()}),message.addEventListener(S.GAME_OVER,()=>{this.gameOver(),this._knifes.switchOn()}),message.addEventListener(S.OVER_WHITE_LIGHT_SHOW,()=>{this._knifes.endAll();for(let U=this.fruits.length-1;U>=0;U--)this.fruits[U].remove();this._background.stop()})}start(){const{STATE_KEYS:t,GAME_STATES:e,FIRST_SAFE_FRUIT_NUMBER:s}=this._config.options;this._fruitFactory.safeNumber=s,this.scoreNumber=0,this.volleyNum=2,this._score.number(this.scoreNumber),timeline.setTimeout(()=>{state(t.GAME_STATE).set(e.PLAYING),this.gameInterval=timeline._setInterval(this.barbette,1e3)},500)}gameOver(){const{STATE_KEYS:t,GAME_STATES:e}=this._config.options;this._config.onGameOver(this.scoreNumber).then(this._config.setScore),state(t.GAME_STATE).set(e.OVER),this.gameInterval&&this.gameInterval.stop(),this.fruits.length=0}applyScore(t){t>this.volleyNum*this.volleyMultipleNumber&&this.volleyNum++,this.volleyMultipleNumber+=50}sliceAt(t,e){const{FRUIT_CONFIG:s,STATE_KEYS:h,GAME_STATES:m}=this._config.options;state(h.GAME_STATE).isnot(m.PLAYING)||(t.type===s.types.BOOM?this.onHitBoom(t):this.onHitFruit(t,e))}catchFruit(t){const{FRUIT_CONFIG:e,STATE_KEYS:s,GAME_STATES:h}=this._config.options;state(s.GAME_STATE).isnot(h.PLAYING)||(t.type===e.types.BOOM?this.onHitBoom(t):this.onHitFruit(t))}onHitFruit(t,e=0){const s=this.fruits.indexOf(t),{SCORE_MULTIPLIER:h}=this._config.options;t.broken(e),vibration.fruit(),s&&this.fruits.splice(s,1),this.scoreNumber+=h||0,this._score.number(this.scoreNumber),this.applyScore(this.scoreNumber)}onHitBoom(t){this._knifes.switchOn(),this._lose.die(),this.pauseAllFruit(),this.boomSnd&&this.boomSnd.play(),vibration.boom(),this._light.start(t,this._background.stop)}pauseAllFruit(){this.gameInterval&&this.gameInterval.stop(),this._knifes.pause(),this.fruits.invoke("pause")}}class HomeScene{constructor(t,e){this._config=t,this._layerManager=e,this.anims=[],this.anim=exponential.co}set(){const{LAYERS:t,HOME_LOGO_CONFIG:e,HOME_MASK_CONFIG:s,HOME_TEXT_CONFIG:h,START_BUTTON_CONFIG:m,MESSAGES:T}=this._config.options;e.image&&(this.logo=this._layerManager.createImage(t.START_SCREEN,e.image,e.startX,e.startY,e.width,e.height).hide()),s.image&&(this.mask=this._layerManager.createImage(t.START_SCREEN,s.image,s.startX,s.startY,s.width,s.height).hide()),h.text1Value&&(this.text1=this._layerManager.createText(t.START_SCREEN,h.text1Value,h.text1Sx,h.text1Y,h.text1Fill,h.text1Size,h.text1Weight,h.text1Anchor).hide()),h.text2Value&&(this.text2=this._layerManager.createText(t.START_SCREEN,h.text2Value,h.text2Sx,h.text2Y,h.text2Fill,h.text2Size,h.text2Weight,h.text2Anchor).hide()),h.text3Value&&(this.text3=this._layerManager.createText(t.START_SCREEN,h.text3Value,h.text3Sx,h.text3Y,h.text3Fill,h.text3Size,h.text3Weight,h.text3Anchor).hide()),this.button=this._layerManager.createImage(t.START_SCREEN,m.image,m.startX,m.startY,m.width,m.height).hide(),this.buttonText=this._layerManager.createText(t.START_SCREEN,m.textValue,m.textStartX,m.textStartY,m.textFill,m.textSize,m.textWeight,m.textAnchor),this._group=this._layerManager.getLayer(t.START_SCREEN).set(),this._group.push(this.button,this.buttonText),this._group.click(()=>{message.postMessage(T.START_GAME),vibration.vibrate()}),this._layerManager.hideLayer(t.START_SCREEN)}show(t){const{MODES:e,HOME_LOGO_CONFIG:s,HOME_TEXT_CONFIG:h,START_BUTTON_CONFIG:m}=this._config.options;timeline.createTask({start:t,duration:s.duration,data:[e.SHOW,s.startY,s.endY,h.text1Sx,h.text1Ex,h.text2Sx,h.text2Ex,h.text3Sx,h.text3Ex,m.startY,m.endY,m.textStartY,m.textEndY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){const{MODES:e,HOME_LOGO_CONFIG:s,HOME_TEXT_CONFIG:h,START_BUTTON_CONFIG:m}=this._config.options;timeline.createTask({start:t,duration:s.duration,data:[e.SHOW,s.endY,s.startY,h.text1Ex,h.text1Sx,h.text2Ex,h.text2Sx,h.text3Ex,h.text3Sx,m.endY,m.startY,m.textEndY,m.textStartY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T,v,b,w,S,O,U,F,X){const{HOME_LOGO_CONFIG:M,HOME_TEXT_CONFIG:z}=this._config.options;this.logo&&this.logo.attr("y",this.anim(t,s,h-s,M.duration)),this.text1&&this.text1.attr("x",this.anim(t,m,T-m,z.animLength)),this.text2&&this.text2.attr("x",this.anim(t,v,b-v,z.animLength)),this.text3&&this.text3.attr("x",this.anim(t,w,S-w,z.animLength)),this.button.attr("y",this.anim(t,O,U-O,z.animLength)),this.buttonText.attr("y",this.anim(t,F,X-F,z.animLength))}onTimeStart(t){const{MODES:e}=this._config.options,s=[this.button,this.buttonText];this.logo&&s.push(this.logo),this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),t===e.SHOW&&s.invoke(t)}onTimeEnd(t){const{MODES:e}=this._config.options,s=[this.button,this.buttonText];this.logo&&s.push(this.logo),this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),t===e.HIDE&&s.invoke(t)}}class GameOverScene{constructor(t,e){this._config=t,this._layerManager=e,this.anims=[]}set(){const{LAYERS:t,GAME_OVER_CONFIG:e}=this._config.options;this.image=this._layerManager.createImage(t.DEFAULT,e.image,e.x,e.y,e.width,e.height).hide().scale(1e-5,1e-5)}show(t){const{MODES:e}=this._config.options;timeline.createTask({start:t,duration:500,data:[1e-5,1,e.SHOW],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})}hide(t){const{MODES:e}=this._config.options;timeline.createTask({start:t,duration:500,data:[1,1e-5,e.HIDE],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})}onZoomStart(t,e,s){const{MODES:h}=this._config.options;s===h.SHOW&&this.image.show()}onZooming(t,e,s,h){this.image.scale(h=exponential.co(t,e,s-e,500),h)}onZoomEnd(t,e,s){const{MODES:h,STATE_KEYS:m}=this._config.options;s===h.SHOW?state(m.CLICK_ENABLE).on():s===h.HIDE&&this.image.hide()}}class ResultScene{constructor(t,e,s){this._config=t,this._layerManager=e,this._game=s,this.anims=[],this.anim=exponential.co}set(){const{LAYERS:t,RESULT_LOGO_CONFIG:e,RESULT_TEXT_CONFIG:s,RESULT_BUTTON_NEXT_CONFIG:h,MESSAGES:m,SCENES:T,RESULT_BUTTON_REPLAY_CONFIG:v,SCORE:b}=this._config.options;e.image&&(this.logo=this._layerManager.createImage(t.RESULT_SCREEN,e.image,e.startX,e.startY,e.width,e.height).hide()),s.text1Value&&(this.text1=this._layerManager.createText(t.RESULT_SCREEN,s.text1Value,s.text1X,s.text1Sy,s.text1Fill,s.text1Size,s.text1Weight,s.text1Anchor).hide()),s.text2Value&&(this.text2=this._layerManager.createText(t.RESULT_SCREEN,s.text2Value,s.text2X,s.text2Sy,s.text2Fill,s.text2Size,s.text2Weight,s.text2Anchor).hide()),this.text3=this._layerManager.createText(t.RESULT_SCREEN,this._game.scoreNumber.toString(),s.text3X,s.text3Sy,s.text3Fill,s.text3Size,s.text3Weight,s.text3Anchor).attr("stroke","white").attr("stroke-width",3).hide(),s.text4Value&&(this.text4=this._layerManager.createText(t.RESULT_SCREEN,s.text4Value,s.text4Sx,s.text4Y,s.text4Fill,s.text4Size,s.text4Weight,s.text4Anchor).hide()),s.text5Value&&(this.text5=this._layerManager.createText(t.RESULT_SCREEN,b.user_record.toString(),s.text5Sx,s.text5Y,s.text5Fill,s.text5Size,s.text5Weight,s.text5Anchor).attr("stroke","white").attr("stroke-width",2).hide()),s.text6Value&&(this.text6=this._layerManager.createText(t.RESULT_SCREEN,s.text6Value,s.text6Sx,s.text6Y,s.text6Fill,s.text6Size,s.text6Weight,s.text6Anchor).hide()),s.text7Value&&(this.text7=this._layerManager.createText(t.RESULT_SCREEN,b.global_record.toString(),s.text7Sx,s.text7Y,s.text7Fill,s.text7Size,s.text7Weight,s.text7Anchor).attr("stroke","white").attr("stroke-width",2).hide()),this.nextButton=this._layerManager.createImage(t.RESULT_SCREEN,h.image,h.startX,h.startY,h.width,h.height).hide(),this.nextButtonText=this._layerManager.createText(t.RESULT_SCREEN,h.textValue,h.textStartX,h.textStartY,h.textFill,h.textSize,h.textWeight,h.textAnchor),this.replayButton=this._layerManager.createImage(t.RESULT_SCREEN,v.image,v.startX,v.startY,v.width,v.height).hide(),this.replayButtonText=this._layerManager.createText(t.RESULT_SCREEN,v.textValue,v.textStartX,v.textStartY,v.textFill,v.textSize,v.textWeight,v.textAnchor),this._group1=this._layerManager.getLayer(t.RESULT_SCREEN).set(),this._group1.push(this.nextButton,this.nextButtonText),this._group1.click(()=>{vibration.vibrate(),message.postMessage(m.SCENE_SWITCH_SCENE,T.BRAND_INTRO)}),this._group2=this._layerManager.getLayer(t.RESULT_SCREEN).set(),this._group2.push(this.replayButton,this.replayButtonText),this._group2.click(()=>{message.postMessage(m.START_GAME),vibration.vibrate()}),this._layerManager.hideLayer(t.RESULT_SCREEN)}show(t){const{MODES:e,RESULT_LOGO_CONFIG:s,RESULT_TEXT_CONFIG:h,RESULT_BUTTON_NEXT_CONFIG:m,RESULT_BUTTON_REPLAY_CONFIG:T}=this._config.options;this.updateText(),timeline.createTask({start:t,duration:s.duration,data:[e.SHOW,s.startY,s.endY,h.text1Sy,h.text1Ey,h.text2Sy,h.text2Ey,h.text3Sy,h.text3Ey,h.text4Sx,h.text4Ex,h.text5Sx,h.text5Ex,h.text6Sx,h.text6Ex,h.text7Sx,h.text7Ex,m.startY,m.endY,m.textStartY,m.textEndY,T.startY,T.endY,T.textStartY,T.textEndY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}updateText(){const{SCORE:t}=this._config.options,e=this._game.scoreNumber.toString(),s=calcVerticalSize(calcResultFontSize(e,115))+"px",h=t.user_record.toString(),m=calcVerticalSize(calcResultFontSize(h,44)),T=t.global_record.toString(),v=calcVerticalSize(calcResultFontSize(T,44)),b=Math.min(m,v)+"px";this.text3.attr("text",this._game.scoreNumber.toString()),this.text3.attr("font-size",s),this.text5.attr("text",t.user_record.toString()),this.text5.attr("font-size",b),this.text7.attr("text",t.global_record.toString()),this.text7.attr("font-size",b)}hide(t){const{MODES:e,RESULT_LOGO_CONFIG:s,RESULT_TEXT_CONFIG:h,RESULT_BUTTON_NEXT_CONFIG:m,RESULT_BUTTON_REPLAY_CONFIG:T}=this._config.options;timeline.createTask({start:t,duration:s.duration,data:[e.SHOW,s.endY,s.startY,h.text1Ey,h.text1Sy,h.text2Ey,h.text2Sy,h.text3Ey,h.text3Sy,h.text4Ex,h.text4Sx,h.text5Ex,h.text5Sx,h.text6Ex,h.text6Sx,h.text7Ex,h.text7Sx,m.endY,m.startY,m.textEndY,m.textStartY,T.endY,T.startY,T.textEndY,T.textStartY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T,v,b,w,S,O,U,F,X,M,z,H,Q,Bt,Ct,tt,L,Tt,P,it,gt){const{RESULT_LOGO_CONFIG:et,RESULT_TEXT_CONFIG:W}=this._config.options;this.logo&&this.logo.attr("y",this.anim(t,s,h-s,et.duration)),this.text1&&this.text1.attr("y",this.anim(t,m,T-m,W.animLength)),this.text2&&this.text2.attr("y",this.anim(t,v,b-v,W.animLength)),this.text3&&this.text3.attr("y",this.anim(t,w,S-w,W.animLength)),this.text4&&this.text4.attr("x",this.anim(t,O,U-O,W.animLength)),this.text5&&this.text5.attr("x",this.anim(t,F,X-F,W.animLength)),this.text6&&this.text6.attr("x",this.anim(t,M,z-M,W.animLength)),this.text7&&this.text7.attr("x",this.anim(t,H,Q-H,W.animLength)),this.nextButton.attr("y",this.anim(t,Bt,Ct-Bt,W.animLength)),this.nextButtonText.attr("y",this.anim(t,tt,L-tt,W.animLength)),this.replayButton.attr("y",this.anim(t,Tt,P-Tt,W.animLength)),this.replayButtonText.attr("y",this.anim(t,it,gt-it,W.animLength))}onTimeStart(t){const{MODES:e}=this._config.options,s=[this.nextButton,this.nextButtonText,this.replayButton,this.replayButtonText];this.logo&&s.push(this.logo),this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),this.text4&&s.push(this.text4),this.text5&&s.push(this.text5),this.text6&&s.push(this.text6),this.text7&&s.push(this.text7),t===e.SHOW&&s.invoke(t)}onTimeEnd(t){const{MODES:e}=this._config.options,s=[this.nextButton,this.nextButtonText,this.replayButton,this.replayButtonText];this.logo&&s.push(this.logo),this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),this.text4&&s.push(this.text4),this.text5&&s.push(this.text5),this.text6&&s.push(this.text6),this.text7&&s.push(this.text7),t===e.HIDE&&s.invoke(t)}}class BrandIntroScene{constructor(t,e){this._config=t,this._layerManager=e,this.setTimeout=timeline.setTimeout.bind(timeline),this.anim=exponential.co,this.anims=[],this._group1=[]}set(){const{LAYERS:t,BRAND_INTRO_CONFIG:e,BRAND_INTRO_BUTTON_CONFIG:s,SCENES:h,MESSAGES:m}=this._config.options;e.textValue&&(this.text=this._layerManager.createText(t.BRAND_INTRO,e.textValue,e.textX,e.textStartY,e.textFill,e.textSize,e.textWeight,e.textAnchor).hide()),s.image&&(this.answerButton=this._layerManager.createImage(t.BRAND_INTRO,s.image,s.buttonX,s.buttonStartY,s.width,s.height).hide()),s.textValue&&(this.answerText=this._layerManager.createText(t.BRAND_INTRO,s.textValue,s.textX,s.textStartY,s.textFill,s.textSize,s.textWeight,s.textAnchor).hide()),this._group1=this._layerManager.getLayer(t.BRAND_INTRO).set(),this.answerText&&this._group1.push(this.answerText),this.answerButton&&this._group1.push(this.answerButton),this._group1.click(()=>{vibration.vibrate(),message.postMessage(m.SCENE_SWITCH_SCENE,h.BRAND_QUESTION)}),this._layerManager.hideLayer(t.BRAND_INTRO)}show(t){const{BRAND_INTRO_CONFIG:e,BRAND_INTRO_BUTTON_CONFIG:s,MODES:h}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[h.SHOW,e.textStartY,e.textEndY,s.textStartY,s.textEndY,s.buttonStartY,s.buttonEndY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){const{BRAND_INTRO_CONFIG:e,BRAND_INTRO_BUTTON_CONFIG:s,MODES:h}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[h.HIDE,e.textEndY,e.textStartY,s.textEndY,s.textStartY,s.buttonEndY,s.buttonStartY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T,v,b){const{BRAND_INTRO_CONFIG:w,BRAND_ANSWER1_CONFIG:S}=this._config.options;this.text&&this.text.attr("y",this.anim(t,s,h-s,w.animLength)),this.answerText&&this.answerText.attr("y",this.anim(t,m,T-m,S.animLength)),this.answerButton&&this.answerButton.attr("y",this.anim(t,v,b-v,S.animLength))}onTimeStart(t){const{MODES:e}=this._config.options,s=[];this.text&&s.push(this.text),this.answerText&&s.push(this.answerText),this.answerButton&&s.push(this.answerButton),t===e.SHOW&&s.invoke(t)}onTimeEnd(t){const{MODES:e}=this._config.options,s=[];this.text&&s.push(this.text),this.answerText&&s.push(this.answerText),this.answerButton&&s.push(this.answerButton),t===e.HIDE&&s.invoke(t)}}class BrandQuestionScene{constructor(t,e){this._config=t,this._layerManager=e,this.setTimeout=timeline.setTimeout.bind(timeline),this.anim=exponential.co,this.anims=[],this._group1=[],this._group2=[]}set(){const{LAYERS:t,BRAND_QUESTION_TEXT1_CONFIG:e,BRAND_QUESTION_TEXT2_CONFIG:s,BRAND_ANSWER1_CONFIG:h,BRAND_ANSWER2_CONFIG:m,MESSAGES:T,SCENES:v}=this._config.options;e.textValue&&(this.text1=this._layerManager.createText(t.BRAND_QUESTION,e.textValue,e.textStartX,e.textY,e.textFill,e.textSize,e.textWeight,e.textAnchor).hide()),s.textValue&&(this.text2=this._layerManager.createText(t.BRAND_QUESTION,s.textValue,s.textStartX,s.textY,s.textFill,s.textSize,s.textWeight,s.textAnchor).hide()),h.image&&(this.answer1=this._layerManager.createImage(t.BRAND_QUESTION,h.image,h.buttonX,h.buttonStartY,h.width,h.height).hide()),h.textValue&&(this.text3=this._layerManager.createText(t.BRAND_QUESTION,h.textValue,h.textX,h.textStartY,h.textFill,h.textSize,h.textWeight,h.textAnchor).hide()),m.image&&(this.answer2=this._layerManager.createImage(t.BRAND_QUESTION,m.image,m.buttonX,m.buttonStartY,m.width,m.height).hide()),m.textValue&&(this.text4=this._layerManager.createText(t.BRAND_QUESTION,m.textValue,m.textX,m.textStartY,m.textFill,m.textSize,m.textWeight,m.textAnchor).hide()),this._group1=this._layerManager.getLayer(t.BRAND_QUESTION).set(),this.answer1&&this._group1.push(this.answer1),this.text3&&this._group1.push(this.text3),this._group2=this._layerManager.getLayer(t.BRAND_QUESTION).set(),this.answer2&&this._group2.push(this.answer2),this.text4&&this._group2.push(this.text4),this._group1.click(async()=>{vibration.vibrate(),await this._config.onComplete(),message.postMessage(T.SCENE_SWITCH_SCENE,v.HOME_MENU)}),this._group2.click(async()=>{vibration.vibrate(),await this._config.onComplete(),message.postMessage(T.SCENE_SWITCH_SCENE,v.HOME_MENU)}),this._layerManager.hideLayer(t.BRAND_QUESTION)}show(t){const{BRAND_QUESTION_TEXT1_CONFIG:e,BRAND_QUESTION_TEXT2_CONFIG:s,MODES:h,BRAND_ANSWER1_CONFIG:m,BRAND_ANSWER2_CONFIG:T}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[h.SHOW,e.textStartX,e.textEndX,s.textStartX,s.textEndX,m.textStartY,m.textEndY,m.buttonStartY,m.buttonEndY,T.textStartY,T.textEndY,T.buttonStartY,T.buttonEndY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){const{BRAND_QUESTION_TEXT1_CONFIG:e,BRAND_QUESTION_TEXT2_CONFIG:s,MODES:h,BRAND_ANSWER1_CONFIG:m,BRAND_ANSWER2_CONFIG:T}=this._config.options;timeline.createTask({start:t,duration:e.animLength,data:[h.HIDE,e.textEndX,e.textStartX,s.textEndX,s.textStartX,m.textEndY,m.textStartY,m.buttonEndY,m.buttonStartY,T.textEndY,T.textStartY,T.buttonEndY,T.buttonStartY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,s,h,m,T,v,b,w,S,O,U,F,X){const{BRAND_QUESTION_TEXT1_CONFIG:M,BRAND_QUESTION_TEXT2_CONFIG:z,BRAND_ANSWER1_CONFIG:H,BRAND_ANSWER2_CONFIG:Q}=this._config.options;this.text1&&this.text1.attr("x",this.anim(t,s,h-s,M.animLength)),this.text2&&this.text2.attr("x",this.anim(t,m,T-m,z.animLength)),this.text3&&this.text3.attr("y",this.anim(t,v,b-v,H.animLength)),this.text4&&this.text4.attr("y",this.anim(t,O,U-O,Q.animLength)),this.answer1&&this.answer1.attr("y",this.anim(t,w,S-w,H.animLength)),this.answer2&&this.answer2.attr("y",this.anim(t,F,X-F,Q.animLength))}onTimeStart(t){const{MODES:e}=this._config.options,s=[];this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),this.text4&&s.push(this.text4),this.answer1&&s.push(this.answer1),this.answer2&&s.push(this.answer2),t===e.SHOW&&s.invoke(t)}onTimeEnd(t){const{MODES:e}=this._config.options,s=[];this.text1&&s.push(this.text1),this.text2&&s.push(this.text2),this.text3&&s.push(this.text3),this.text4&&s.push(this.text4),this.answer1&&s.push(this.answer1),this.answer2&&s.push(this.answer2),t===e.HIDE&&s.invoke(t)}}class FPS{constructor(t,e){this._config=t,this._layerManager=e,this.update=()=>{const{IS_DEBUG:s,FPS_CONFIG:h}=this._config.options;s&&this.text.attr("text",h.prefix+(timeline.getFPS()>>0))}}set(){const{IS_DEBUG:t,LAYERS:e,FPS_CONFIG:s}=this._config.options;t&&(this.text=this._layerManager.createText(e.DEFAULT,s.prefix+"0",s.x,s.y).attr("fill",s.fill))}}class ScenesManager{constructor(t,e,s,h,m,T,v,b,w,S){this._config=t,this._game=e,this._layerManager=s,this._soundButton=h,this._soundFactory=m,this._flash=T,this._score=v,this._lose=b,this._background=w,this._displacementFactory=S,this.setTimeout=timeline.setTimeout.bind(timeline),this.setInterval=timeline._setInterval.bind(timeline);const{LAYERS:O,BOTTOM_CONFIG:U}=this._config.options;this._bottom=this._displacementFactory.create({layer:O.DEFAULT,imageSrc:U.image,width:U.width,height:U.height,startX:U.startX,startY:U.startY,endX:U.endX,endY:U.endY,animMap:exponential.co,duration:U.duration}),this._startScene=new HomeScene(t,s),this._gameOverScene=new GameOverScene(t,s),this._resultScene=new ResultScene(t,s,e),this._brandIntroScene=new BrandIntroScene(t,s),this._brandQuestionScene=new BrandQuestionScene(t,s),this._fps=new FPS(t,s);const{SOUNDS:F,MESSAGES:X}=this._config.options;this.menuSnd=this._soundFactory.create(F[SoundNames.MENU]),this.gameStartSnd=this._soundFactory.create(F[SoundNames.START]),message.addEventListener(X.SCENE_SWITCH_SCENE,M=>{this.switchScene(M)}),message.addEventListener(X.TOGGLE_SOUND,()=>{this.toggleSound()})}init(){[this._background,this._startScene,this._score,this._lose,this._gameOverScene,this._flash,this._bottom,this._resultScene,this._soundButton,this._brandQuestionScene,this._brandIntroScene,this._fps].invoke("set"),this.setInterval(this._fps.update,500)}switchScene(t){const{SCENE_STATES:e,STATE_KEYS:s,SCENES:h}=this._config.options,m=()=>v.set(e.READY),T=state(s.SCENE_NAME),v=state(s.SCENE_STATE);if(T.is(t))return;const b=()=>{switch(T.set(t),v.set(e.ENTERING),t){case h.HOME_MENU:this.showMenu(m);break;case h.GAME_BODY:this.showGame(m);break;case h.GAME_OVER:this.showGameOver(m);break;case h.GAME_RESULT:this.showResult(m);break;case h.BRAND_INTRO:this.showBrandIntro(m);break;case h.BRAND_QUESTION:this.showBrandQuestion(m);break}};v.set(e.EXITING),T.isunset()?b():T.is(h.HOME_MENU)?this.hideMenu(b):T.is(h.GAME_BODY)?this.hideGame(b):T.is(h.GAME_OVER)?this.hideGameOver(b):T.is(h.GAME_RESULT)?this.hideResult(b):T.is(h.BRAND_INTRO)?this.hideBrandIntro(b):T.is(h.BRAND_QUESTION)&&this.hideBrandQuestion(b)}toggleSound(){const{SCENES:t,STATE_KEYS:e}=this._config.options,s=state(e.SCENE_NAME),h=this._soundButton.isOn?"play":"stop";s.is(t.HOME_MENU)&&this.menuSnd?this.menuSnd[h]():s.is(t.GAME_BODY)&&this.gameStartSnd?this.gameStartSnd[h]():s.is(t.GAME_RESULT)&&this.menuSnd&&this.menuSnd[h]()}showMenu(t){const{MODES:e,LAYERS:s}=this._config.options;this._layerManager.showLayer(s.START_SCREEN),[[this._startScene,0],[this._bottom,1e3]].invoke(e.SHOW),this.menuSnd&&this.menuSnd.play(),this._soundButton.showHomeSoundButton(1200),this.setTimeout(t,2500)}hideMenu(t){const{MODES:e,LAYERS:s}=this._config.options;[this._startScene].invoke(e.HIDE),this._soundButton.hideHomeSoundButton(),this.menuSnd&&this.menuSnd.stop(),this.setTimeout(()=>{t(),this._layerManager.hideLayer(s.START_SCREEN)},1200)}showGame(t){const{LAYERS:e}=this._config.options;this._layerManager.showLayer(e.FRUIT),this._score.show(),this._lose.show(),this._game.start(),this.gameStartSnd&&this.gameStartSnd.play(),this._soundButton.showGameSoundButton(),this.setTimeout(t,700)}hideGame(t){const{LAYERS:e}=this._config.options;this._score.hide(),this._lose.hide(),this._soundButton.hideGameSoundButton(),this.gameStartSnd&&this.gameStartSnd.stop(),this.setTimeout(()=>{t(),this._layerManager.hideLayer(e.FRUIT)},700)}showGameOver(t){const{SCENES:e,MODES:s}=this._config.options;[[this._gameOverScene,0]].invoke(s.SHOW),this.setTimeout(()=>{t(),this.switchScene(e.GAME_RESULT)},2e3)}hideGameOver(t){const{MODES:e}=this._config.options;[this._gameOverScene].invoke(e.HIDE),this.setTimeout(t,1e3)}showResult(t){const{LAYERS:e,MODES:s}=this._config.options;this._layerManager.showLayer(e.RESULT_SCREEN),[[this._resultScene,0]].invoke(s.SHOW),this.menuSnd&&this.menuSnd.play(),this._soundButton.showResultSoundButton(),this.setTimeout(t)}hideResult(t){const{LAYERS:e,MODES:s}=this._config.options;[this._resultScene].invoke(s.HIDE),this._soundButton.hideResultSoundButton(),this.menuSnd&&this.menuSnd.stop(),this.setTimeout(()=>{t(),this._layerManager.hideLayer(e.RESULT_SCREEN)},1e3)}showBrandIntro(t){const{LAYERS:e,MODES:s}=this._config.options;this._layerManager.showLayer(e.BRAND_INTRO),[[this._brandIntroScene,0]].invoke(s.SHOW),this._soundButton.showResultSoundButton(),this.setTimeout(t)}hideBrandIntro(t){const{LAYERS:e,MODES:s}=this._config.options;[this._brandIntroScene].invoke(s.HIDE),this._soundButton.hideResultSoundButton(),this.setTimeout(()=>{t(),this._layerManager.hideLayer(e.BRAND_INTRO)},1e3)}showBrandQuestion(t){const{LAYERS:e,MODES:s}=this._config.options;this._layerManager.showLayer(e.BRAND_QUESTION),[[this._brandQuestionScene,0]].invoke(s.SHOW),this._soundButton.showResultSoundButton(),this.setTimeout(t)}hideBrandQuestion(t){const{LAYERS:e,MODES:s}=this._config.options;[this._brandQuestionScene].invoke(s.HIDE),this._soundButton.hideResultSoundButton(),this.setTimeout(()=>{t(),this._layerManager.hideLayer(e.BRAND_QUESTION)},1e3)}}class Main{constructor(t){var e,s;this._config=t,this.setTimeout=timeline.setTimeout.bind(timeline),(s=(e=window.Telegram)==null?void 0:e.WebApp)!=null&&s.disableVerticalScroll&&window.Telegram.WebApp.disableVerticalScroll(!0);const{MESSAGES:h,SCENES:m,STATE_KEYS:T,SCENE_STATES:v}=this._config.options;this._layerManager=new LayerManager(this._config),this._displacementFactory=new DisplacementFactory(this._config,this._layerManager),this._knifes=new Knifes(this._config,this._layerManager),this._control=new Control(this._config,this._knifes),this._soundButton=new SoundButton(this._config,this._layerManager),this._soundFactory=new SoundFactory(this._soundButton),this._flash=new Flash(this._config,this._layerManager,this._soundFactory),this._fruitFactory=new FruitFactory(this._config,this._control,this._layerManager,this._flash),this._collide=new Collide(this._fruitFactory),this._score=new Score(this._config,this._layerManager),this._lose=new Lose(this._config,this._layerManager),this._background=new Background(this._config,this._layerManager),this._game=new Game(this._config,this._fruitFactory,this._layerManager,this._knifes,this._soundFactory,this._score,this._lose,this._background),this._scenesManager=new ScenesManager(this._config,this._game,this._layerManager,this._soundButton,this._soundFactory,this._flash,this._score,this._lose,this._background,this._displacementFactory),document.addEventListener("touchstart",b=>{b.preventDefault()},{passive:!1}),document.addEventListener("touchmove",b=>{b.preventDefault()},{passive:!1}),message.addEventListener(h.SLICE,b=>{const w=this._collide.checkSlice(b);if(w.length){const S=getAngleByRadian(pointToRadian(b.slice(0,2),b.slice(2,4)));w.forEach(O=>message.postMessage(h.SLICE_AT,O,S))}}),message.addEventListener(h.TOUCH,b=>{const w=this._collide.checkTouch(b);w.length&&w.forEach(S=>message.postMessage(h.TOUCH_AT,S))}),message.addEventListener(h.SLICE_AT,(b,w)=>{state(T.SCENE_STATE).isnot(v.READY)||state(T.SCENE_NAME).is(m.GAME_BODY)&&this._game.sliceAt(b,w)}),message.addEventListener(h.TOUCH_AT,b=>{state(T.SCENE_STATE).isnot(v.READY)||state(T.SCENE_NAME).is(m.GAME_BODY)&&this._game.catchFruit(b)}),message.addEventListener(h.START_GAME,()=>{this._scenesManager.switchScene(m.GAME_BODY)}),new PreloadFactory(this._config,this._displacementFactory)}start(){const{SCENES:t}=this._config.options;[timeline,this._scenesManager,this._control].invoke("init"),this.setTimeout(this._scenesManager.switchScene.saturate(this._scenesManager,t.HOME_MENU),3e3)}}function init(i,t=console){adjustView(i.rootElement);const e=new Config(i,t);new Main(e).start()}const getConfig=()=>({rootElement:document.getElementById("ninja_game")});init(getConfig());
//# sourceMappingURL=fruitNinja-Emmmr9Kk.js.map
