import"./modulepreload-polyfill-B5Qt9EMX.js";var I=Object.defineProperty,d=(i,t,e)=>t in i?I(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,a=(i,t,e)=>(d(i,typeof t!="symbol"?t+"":t,e),e);const randomNumber=i=>Math.floor(Math.random()*i),nul=()=>!1,each=(i,t)=>{if(Array.isArray(i))i=[...i],i.forEach(t);else if(typeof i=="object"){const e={};for(const T in i)if(!e[T]&&t(i[T],T)===!1)break}else if(typeof i=="number")for(let e=0;e<i&&t(e,e)!==!1;e++);else if(typeof i=="string")for(let e=0,T=i.length;e<T&&t(i.charAt(e),e)!==!1;e++);},apply=(i,t,e)=>(t||(t={}),e?each(i,(T,s)=>{s in e||(t[s]=T)}):each(i,(T,s)=>t[s]=T),t),makeElement=(i,t)=>{const e=document.createElement(i),T=s=>{typeof s=="string"?e.style.cssText=s:apply(s,e.style)};for(const s in t)s==="class"?e.className=t[s]:s==="for"?e.htmlFor=t[s]:s==="style"?T(t[s]):e.setAttribute(s,t[s]);return e};function addPonyfills(){String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/,"")},String.prototype.htmlEncode=String.prototype.htmlEncode||function(){const i=document.createElement("div");return function(){let t;return i.appendChild(document.createTextNode(this)),t=i.innerHTML,i.innerHTML="",t}}(),String.prototype.byteLength=String.prototype.byteLength||function(){return this.replace(/[^\x00-\xff]/g,"  ").length},String.prototype.subByte=String.prototype.subByte||function(i,t){let e=this;return e.byteLength()<=i?e:(t=t||"",i-=t.byteLength(),e=e.slice(0,i).replace(/([^\x00-\xff])/g,"$1 ").slice(0,i).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"$1")+t)},Function.prototype.defer=Function.prototype.defer||function(i,t){const e=this;return setTimeout(function(){e.apply(i,arguments)},t)},Function.prototype.bind=Function.prototype.bind||function(i){const t=this;return function(){return t.apply(i,arguments)}},Function.prototype.saturate=Function.prototype.saturate||function(i){const t=this,e=[].slice.call(arguments,1);return function(){return t.apply(i,[].slice.call(arguments,0).concat(e))}},Array.prototype.indexOf=Array.prototype.indexOf||function(i,t){const e=this.length;for(t||(t=0),t<0&&(t=e+t);t<e;t++)if(this[t]===i)return t;return-1},Array.prototype.every=Array.prototype.every||function(i,t){for(var e=0,T=this.length;e<T;e++)if(!i.call(t,this[e],e,this))return!1;return!0},Array.prototype.filter=Array.prototype.filter||function(i,t){let e=[],T;for(var s=0,n=this.length;s<n;s++)T=this[s],i.call(t,T,s,this)&&e.push(T);return e},Array.prototype.forEach=Array.prototype.forEach||function(i,t){for(var e=0,T=this.length;e<T;e++)i.call(t,this[e],e,this)},Array.prototype.map=Array.prototype.map||function(i,t){const e=[];for(var T=0,s=this.length;T<s;T++)e[T]=i.call(t,this[T],T,this);return e},Array.prototype.some=Array.prototype.some||function(i,t){for(var e=0,T=this.length;e<T;e++)if(i.call(t,this[e],e,this))return!0;return!1},Array.prototype.invoke=Array.prototype.invoke||function(i){const t=[].slice.call(arguments,1);return this.forEach(function(e){e instanceof Array?e[0][i].apply(e[0],e.slice(1)):e[i].apply(e,t)}),this},Array.prototype.random=Array.prototype.random||function(){let i=this.slice(0),t=[],e=i.length;for(;e--;)t.push(i.splice(randomNumber(e+1),1)[0]);return t}}addPonyfills();const MAX_VIEWPORT_HEIGHT=932,MAX_VIEWPORT_WIDTH=640,adjustView=i=>{const t=window.innerHeight,e=window.innerWidth,T=MAX_VIEWPORT_WIDTH<e,s=MAX_VIEWPORT_HEIGHT<t,n=T?MAX_VIEWPORT_WIDTH+"px":"100%",_=s?MAX_VIEWPORT_HEIGHT+"px":"100%",r=T||s,h=r?"absolute":"static",S=r?"translate(-50%, -50%)":"none";return i.style.position=h,i.style.width=n,i.style.height=_,i.transform=S,i.getBoundingClientRect()},viewport=adjustView(document.querySelector("#extra")),HORIZONTAL_BASE=393,VERTICAL_BASE=852,BASE_RESULT_CHARS_NUMBER=6,{width:width$1,height:height$1}=viewport,calcSize=i=>{const t=width$1/HORIZONTAL_BASE;return i*t},calcVerticalSize=i=>{const t=height$1/VERTICAL_BASE;return i*t},calcResultFontSize=(i,t)=>{const e=calcSize(t),T=i.length,s=T>BASE_RESULT_CHARS_NUMBER?T:BASE_RESULT_CHARS_NUMBER;return e*BASE_RESULT_CHARS_NUMBER/s},{width:viewportWidth$3,height:viewportHeight$5}=viewport,DEBUG_MODE=new URLSearchParams(window.location.search).has("debug"),INTERACTION_MODES={TOUCH:"touch",SLICE:"slice"},INTERACTION_MODE=new URLSearchParams(window.location.search).has("touch")?INTERACTION_MODES.TOUCH:INTERACTION_MODES.SLICE,IS_TOUCH=INTERACTION_MODE===INTERACTION_MODES.TOUCH,FONT_FAMILY="lm",MODES={SHOW:"show",HIDE:"hide"},STATE_KEYS={CLICK_ENABLE:"click-enable",GAME_STATE:"game-state",SCENE_NAME:"scene-name",SCENE_STATE:"scene-state"},SCENE_STATES={READY:"ready",ENTERING:"entering",EXITING:"exiting"},GAME_STATES={PLAYING:"playing",OVER:"over"},SCENES={HOME_MENU:"home-menu",GAME_BODY:"game-body",GAME_OVER:"game-over",GAME_RESULT:"game-result",BRAND_QUESTION:"brand-question"},LAYERS={PRELOAD:"preload",DEFAULT:"default",FRUIT:"fruit",JUICE:"juice",MASK:"mask",LIGHT:"light",FLASH:"flash",KNIFE:"knife",START_SCREEN:"start-screen",RESULT_SCREEN:"result-screen",BRAND_QUESTION:"brand-question"},FRUIT_DROP_TIME=IS_TOUCH?2e3:1200,FRUIT_DROP_X_SCOPE=200,FRUIT_SHADOW_POS=50,FRUIT_TYPES={BOOM:"boom",PEACH:"peach",SANDIA:"sandia",APPLE:"apple",BANANA:"banana",BASAHA:"basaha"},FRUIT_JUICE_COLORS={[FRUIT_TYPES.BOOM]:null,[FRUIT_TYPES.PEACH]:"#e6c731",[FRUIT_TYPES.SANDIA]:"#c00",[FRUIT_TYPES.APPLE]:"#c8e925",[FRUIT_TYPES.BANANA]:null,[FRUIT_TYPES.BASAHA]:"#c00"},FRUIT_IMAGES={[FRUIT_TYPES.BOOM]:"images/fruit/boom.webp",[FRUIT_TYPES.PEACH]:"images/fruit/mango.webp",[FRUIT_TYPES.SANDIA]:"images/fruit/watermelon.webp",[FRUIT_TYPES.APPLE]:"images/fruit/apple.webp",[FRUIT_TYPES.BANANA]:"images/fruit/melon.webp",[FRUIT_TYPES.BASAHA]:"images/fruit/raspberry.webp"},FRUIT_CUT_IMAGES={[FRUIT_TYPES.BOOM]:[],[FRUIT_TYPES.PEACH]:["images/fruit/mango-1.webp","images/fruit/mango-2.webp"],[FRUIT_TYPES.SANDIA]:["images/fruit/watermelon-1.webp","images/fruit/watermelon-2.webp"],[FRUIT_TYPES.APPLE]:["images/fruit/apple-1.webp","images/fruit/apple-2.webp"],[FRUIT_TYPES.BANANA]:["images/fruit/melon-1.webp","images/fruit/melon-2.webp"],[FRUIT_TYPES.BASAHA]:["images/fruit/raspberry-1.webp","images/fruit/raspberry-2.webp"]},FRUIT_SIZES={[FRUIT_TYPES.BOOM]:[calcSize(100),calcSize(100),26],[FRUIT_TYPES.PEACH]:[calcSize(100),calcSize(100),37],[FRUIT_TYPES.SANDIA]:[calcSize(100),calcSize(100),38],[FRUIT_TYPES.APPLE]:[calcSize(100),calcSize(100),31],[FRUIT_TYPES.BANANA]:[calcSize(100),calcSize(100),43],[FRUIT_TYPES.BASAHA]:[calcSize(100),calcSize(100),32]},FRUIT_FIX_ANGLE={[FRUIT_TYPES.BOOM]:-21,[FRUIT_TYPES.PEACH]:-50,[FRUIT_TYPES.SANDIA]:-100,[FRUIT_TYPES.APPLE]:-54,[FRUIT_TYPES.BANANA]:90,[FRUIT_TYPES.BASAHA]:-135},FRUIT_IS_REVERSE={[FRUIT_TYPES.BOOM]:0,[FRUIT_TYPES.PEACH]:0,[FRUIT_TYPES.SANDIA]:0,[FRUIT_TYPES.APPLE]:0,[FRUIT_TYPES.BANANA]:0,[FRUIT_TYPES.BASAHA]:0},FRUIT_INFOS={[FRUIT_TYPES.BOOM]:[FRUIT_IMAGES[FRUIT_TYPES.BOOM],...FRUIT_SIZES[FRUIT_TYPES.BOOM],FRUIT_FIX_ANGLE[FRUIT_TYPES.BOOM],FRUIT_IS_REVERSE[FRUIT_TYPES.BOOM],FRUIT_JUICE_COLORS[FRUIT_TYPES.BOOM]],[FRUIT_TYPES.PEACH]:[FRUIT_IMAGES[FRUIT_TYPES.PEACH],...FRUIT_SIZES[FRUIT_TYPES.PEACH],FRUIT_FIX_ANGLE[FRUIT_TYPES.PEACH],FRUIT_IS_REVERSE[FRUIT_TYPES.PEACH],FRUIT_JUICE_COLORS[FRUIT_TYPES.PEACH]],[FRUIT_TYPES.SANDIA]:[FRUIT_IMAGES[FRUIT_TYPES.SANDIA],...FRUIT_SIZES[FRUIT_TYPES.SANDIA],FRUIT_FIX_ANGLE[FRUIT_TYPES.SANDIA],FRUIT_IS_REVERSE[FRUIT_TYPES.SANDIA],FRUIT_JUICE_COLORS[FRUIT_TYPES.SANDIA]],[FRUIT_TYPES.APPLE]:[FRUIT_IMAGES[FRUIT_TYPES.APPLE],...FRUIT_SIZES[FRUIT_TYPES.APPLE],FRUIT_FIX_ANGLE[FRUIT_TYPES.APPLE],FRUIT_IS_REVERSE[FRUIT_TYPES.APPLE],FRUIT_JUICE_COLORS[FRUIT_TYPES.APPLE]],[FRUIT_TYPES.BANANA]:[FRUIT_IMAGES[FRUIT_TYPES.BANANA],...FRUIT_SIZES[FRUIT_TYPES.BANANA],FRUIT_FIX_ANGLE[FRUIT_TYPES.BANANA],FRUIT_IS_REVERSE[FRUIT_TYPES.BANANA],FRUIT_JUICE_COLORS[FRUIT_TYPES.BANANA]],[FRUIT_TYPES.BASAHA]:[FRUIT_IMAGES[FRUIT_TYPES.BASAHA],...FRUIT_SIZES[FRUIT_TYPES.BASAHA],FRUIT_FIX_ANGLE[FRUIT_TYPES.BASAHA],FRUIT_IS_REVERSE[FRUIT_TYPES.BASAHA],FRUIT_JUICE_COLORS[FRUIT_TYPES.BASAHA]]},FRUIT_SHADOW_IMAGE="images/shadow.webp",FRUIT_CONFIG={dropTime:FRUIT_DROP_TIME,dropXScope:FRUIT_DROP_X_SCOPE,shadowPos:FRUIT_SHADOW_POS,shadowImage:FRUIT_SHADOW_IMAGE,types:FRUIT_TYPES,infos:FRUIT_INFOS,cutImages:FRUIT_CUT_IMAGES,fruitSizes:FRUIT_SIZES},JUICE_DURATION=1500,JUICE_RADIUS=10,JUICE_NUMBER=10,JUICE_SHAPES={CIRCLE:"circle",SQUARE:"square",DIAMOND:"diamond",STAR:"star"},JUICE_CONFIG={duration:JUICE_DURATION,radius:JUICE_RADIUS,number:JUICE_NUMBER,shape:JUICE_SHAPES.DIAMOND,shapes:JUICE_SHAPES},BACKGROUND_IMAGE="images/background.webp",BACKGROUND_X=0,BACKGROUND_Y=0,BACKGROUND_WIDTH=viewportWidth$3||MAX_VIEWPORT_WIDTH,BACKGROUND_HEIGHT=viewportHeight$5||MAX_VIEWPORT_HEIGHT,BACKGROUND_CONFIG={image:BACKGROUND_IMAGE,x:BACKGROUND_X,y:BACKGROUND_Y,width:BACKGROUND_WIDTH,height:BACKGROUND_HEIGHT,preserveAspectRatio:"xMidYMid slice"},CONSOLE_X=16,CONSOLE_Y=0,CONSOLE_CONFIG={x:CONSOLE_X,y:CONSOLE_Y},MESSAGES={CLICK:"click",SLICE:"slice",TOUCH:"touch",FRUIT_FALL_OFF:"fruit.fallOff",FRUIT_FALL_OUT_OF_VIEWER:"fruit.fallOutOfViewer",FRUIT_REMOVE:"fruit.remove",HOME_MENU:"home-menu",SCENE_SWITCH_SCENE:"scene.switchScene",GAME_OVER:"game.over",OVER_WHITE_LIGHT_SHOW:"overWhiteLight.show",SLICE_AT:"slice.at",TOUCH_AT:"touch.at",START_GAME:"start.game",VIBRATE:"vibrate",TOGGLE_SOUND:"toggle.sound"},FLASH_IMAGE="images/flash.webp",FLASH_DURATION=100,FLASH_WIDTH=calcSize(358),FLASH_HEIGHT=calcSize(20),FLASH_CONFIG={image:FLASH_IMAGE,duration:FLASH_DURATION,width:FLASH_WIDTH,height:FLASH_HEIGHT},FPS_PREFIX="FPS: ",FPS_FILL="#fff",FPS_X=4,FPS_Y=viewportHeight$5-10,FPS_CONFIG={prefix:FPS_PREFIX,fill:FPS_FILL,x:FPS_X,y:FPS_Y},GAME_OVER_IMAGE="images/game-over.webp",GAME_OVER_HEIGHT=calcSize(145),GAME_OVER_WIDTH=calcSize(250),GAME_OVER_X=viewportWidth$3/2-GAME_OVER_WIDTH/2+calcSize(6),GAME_OVER_Y=viewportHeight$5/2-GAME_OVER_HEIGHT/2,GAME_OVER_CONFIG={image:GAME_OVER_IMAGE,x:GAME_OVER_X,y:GAME_OVER_Y,width:GAME_OVER_WIDTH,height:GAME_OVER_HEIGHT},HOME_MASK_IMAGE="images/blank.gif",HOME_MASK_WIDTH=viewportWidth$3,HOME_MASK_HEIGHT=183,HOME_MASK_ORIG_X=0,HOME_MASK_ORIG_Y=-183,HOME_MASK_TARGET_X=0,HOME_MASK_TARGET_Y=0,HOME_MASK_DURATION=1e3,HOME_MASK_CONFIG={image:HOME_MASK_IMAGE,width:HOME_MASK_WIDTH,height:HOME_MASK_HEIGHT,startX:HOME_MASK_ORIG_X,startY:HOME_MASK_ORIG_Y,endX:HOME_MASK_TARGET_X,endY:HOME_MASK_TARGET_Y,duration:HOME_MASK_DURATION},KNIFE_PART_COLOR="transparent",KNIFE_PART_STROKE=10,KNIFE_PART_LIFE=200,KNIFE_PART_CONFIG={color:KNIFE_PART_COLOR,stroke:KNIFE_PART_STROKE,life:KNIFE_PART_LIFE},LIGHTS_NUMBER=10,LIGHTS_FILL="#fff",LIGHTS_CONFIG={number:LIGHTS_NUMBER,fill:LIGHTS_FILL},HOME_LOGO_IMAGE="images/logo.webp",HOME_LOGO_WIDTH=calcSize(335),HOME_LOGO_HEIGHT=calcSize(200),HOME_LOGO_ORIG_X=calcSize(38),HOME_LOGO_ORIG_Y=-HOME_LOGO_HEIGHT,HOME_LOGO_TARGET_X=HOME_LOGO_ORIG_X,HOME_LOGO_TARGET_Y=calcSize(41),HOME_LOGO_DURATION=1e3,HOME_LOGO_CONFIG={image:HOME_LOGO_IMAGE,width:HOME_LOGO_WIDTH,height:HOME_LOGO_HEIGHT,startX:HOME_LOGO_ORIG_X,startY:HOME_LOGO_ORIG_Y,endX:HOME_LOGO_TARGET_X,endY:HOME_LOGO_TARGET_Y,duration:HOME_LOGO_DURATION},RESULT_LOGO_IMAGE="images/logo.webp",RESULT_LOGO_WIDTH=calcSize(244),RESULT_LOGO_HEIGHT=calcSize(147),RESULT_LOGO_ORIG_X=calcSize(81),RESULT_LOGO_ORIG_Y=-RESULT_LOGO_HEIGHT,RESULT_LOGO_TARGET_X=RESULT_LOGO_ORIG_X,RESULT_LOGO_TARGET_Y=calcSize(24),RESULT_LOGO_DURATION=1e3,RESULT_LOGO_CONFIG={image:RESULT_LOGO_IMAGE,width:RESULT_LOGO_WIDTH,height:RESULT_LOGO_HEIGHT,startX:RESULT_LOGO_ORIG_X,startY:RESULT_LOGO_ORIG_Y,endX:RESULT_LOGO_TARGET_X,endY:RESULT_LOGO_TARGET_Y,duration:RESULT_LOGO_DURATION},SCORE_IMAGE="images/score.webp",SCORE_IMAGE_SX=-94,SCORE_IMAGE_EX=calcSize(23),SCORE_IMAGE_Y=calcSize(8),SCORE_IMAGE_W=calcSize(40),SCORE_IMAGE_H=calcSize(40),SCORE_TEXT1_SX=-59,SCORE_TEXT1_EX=SCORE_IMAGE_EX+SCORE_IMAGE_W+calcSize(12),SCORE_TEXT1_Y=SCORE_IMAGE_Y+SCORE_IMAGE_H-calcSize(14),SCORE_TEXT1_FILL="#fff",SCORE_TEXT1_SIZE=calcVerticalSize(45)+"px",SCORE_TEXT1_VALUE="0",SCORE_TEXT2_SX=-93,SCORE_TEXT2_EX=SCORE_IMAGE_EX,SCORE_TEXT2_Y=calcSize(65),SCORE_TEXT2_FILL="#fff",SCORE_TEXT2_PREFIX="Рекорд: ",SCORE_TEXT2_VALUE=999,SCORE_TEXT2_SIZE=calcVerticalSize(16)+"px",SCORE_ANIM_LENGTH=500,SCORE_CONFIG={image:SCORE_IMAGE,imageSx:SCORE_IMAGE_SX,imageEx:SCORE_IMAGE_EX,imageY:SCORE_IMAGE_Y,imageW:SCORE_IMAGE_W,imageH:SCORE_IMAGE_H,text1Sx:SCORE_TEXT1_SX,text1Ex:SCORE_TEXT1_EX,text1Y:SCORE_TEXT1_Y,text1Fill:SCORE_TEXT1_FILL,text1Size:SCORE_TEXT1_SIZE,text1Weight:"bold",text1Value:SCORE_TEXT1_VALUE,text2Sx:SCORE_TEXT2_SX,text2Ex:SCORE_TEXT2_EX,text2Y:SCORE_TEXT2_Y,text2Fill:SCORE_TEXT2_FILL,text2Prefix:SCORE_TEXT2_PREFIX,text2Value:SCORE_TEXT2_VALUE,text2Size:SCORE_TEXT2_SIZE,animLength:SCORE_ANIM_LENGTH},LOSE_WIDTH=calcSize(45.2),LOSE_HEIGHT=calcSize(37.6),LOSE_LEFT=viewportWidth$3-SCORE_IMAGE_EX-LOSE_WIDTH,LOSE_CONF=[{src:"images/x.webp",srcF:"images/xf.webp",sx:LOSE_LEFT+200,ex:LOSE_LEFT,y:SCORE_IMAGE_Y,w:LOSE_WIDTH,h:LOSE_HEIGHT},{src:"images/x.webp",srcF:"images/xf.webp",sx:LOSE_LEFT-LOSE_WIDTH+200,ex:LOSE_LEFT-LOSE_WIDTH,y:SCORE_IMAGE_Y,w:LOSE_WIDTH,h:LOSE_HEIGHT},{src:"images/x.webp",srcF:"images/xf.webp",sx:LOSE_LEFT-LOSE_WIDTH-LOSE_WIDTH+200,ex:LOSE_LEFT-LOSE_WIDTH-LOSE_WIDTH,y:SCORE_IMAGE_Y,w:LOSE_WIDTH,h:LOSE_HEIGHT}],LOSE_IMAGE="images/lose.png",LOSE_ANIMATION_LENGTH=500,LOSE_CONFIG={conf:LOSE_CONF,image:LOSE_IMAGE,animLength:LOSE_ANIMATION_LENGTH},HOME_TEXT1_VALUE=`Тропическое путешествие
в самом разгаре!`,HOME_TEXT1_SX=-viewportWidth$3,HOME_TEXT1_EX=viewportWidth$3/2,HOME_TEXT1_Y=HOME_LOGO_TARGET_Y+HOME_LOGO_HEIGHT+calcVerticalSize(28),HOME_TEXT1_FILL="#fff",HOME_TEXT1_SIZE=calcVerticalSize(22)+"px",HOME_TEXT1_WEIGHT="bold",HOME_TEXT1_ANCHOR="middle",HOME_TEXT2_VALUE=`Разрежь как можно больше
экзотических фруктов!`,HOME_TEXT2_SX=-viewportWidth$3,HOME_TEXT2_EX=viewportWidth$3/2,HOME_TEXT2_Y=HOME_LOGO_TARGET_Y+HOME_LOGO_HEIGHT+calcVerticalSize(148),HOME_TEXT2_FILL="#fff",HOME_TEXT2_SIZE=calcVerticalSize(22)+"px",HOME_TEXT2_WEIGHT="bold",HOME_TEXT2_ANCHOR="middle",HOME_TEXT3_VALUE=`Осторожно:
избегай снежинки`,HOME_TEXT3_SX=-viewportWidth$3,HOME_TEXT3_EX=viewportWidth$3/2,HOME_TEXT3_Y=HOME_LOGO_TARGET_Y+HOME_LOGO_HEIGHT+calcVerticalSize(225),HOME_TEXT3_FILL="#fff",HOME_TEXT3_SIZE=calcVerticalSize(22)+"px",HOME_TEXT3_WEIGHT="bold",HOME_TEXT3_ANCHOR="middle",HOME_TEXT_ANIM_LENGTH=500,HOME_TEXT_CONFIG={text1Value:HOME_TEXT1_VALUE,text1Sx:HOME_TEXT1_SX,text1Ex:HOME_TEXT1_EX,text1Y:HOME_TEXT1_Y,text1Fill:HOME_TEXT1_FILL,text1Size:HOME_TEXT1_SIZE,text1Weight:HOME_TEXT1_WEIGHT,text1Anchor:HOME_TEXT1_ANCHOR,text2Value:HOME_TEXT2_VALUE,text2Sx:HOME_TEXT2_SX,text2Ex:HOME_TEXT2_EX,text2Y:HOME_TEXT2_Y,text2Fill:HOME_TEXT2_FILL,text2Size:HOME_TEXT2_SIZE,text2Weight:HOME_TEXT2_WEIGHT,text2Anchor:HOME_TEXT2_ANCHOR,text3Value:HOME_TEXT3_VALUE,text3Sx:HOME_TEXT3_SX,text3Ex:HOME_TEXT3_EX,text3Y:HOME_TEXT3_Y,text3Fill:HOME_TEXT3_FILL,text3Size:HOME_TEXT3_SIZE,text3Weight:HOME_TEXT3_WEIGHT,text3Anchor:HOME_TEXT3_ANCHOR,animLength:HOME_TEXT_ANIM_LENGTH},RESULT_TEXT1_VALUE="Сезон Sunny Beach!",RESULT_TEXT1_X=viewportWidth$3/2,RESULT_TEXT1_SY=-200,RESULT_TEXT1_EY=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(4),RESULT_TEXT1_FILL="#fff",RESULT_TEXT1_SIZE=calcVerticalSize(17.8)+"px",RESULT_TEXT1_WEIGHT="bold",RESULT_TEXT1_ANCHOR="middle",RESULT_TEXT2_VALUE="Твой счёт:",RESULT_TEXT2_X=viewportWidth$3/2,RESULT_TEXT2_SY=-200,RESULT_TEXT2_EY=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(60),RESULT_TEXT2_FILL="#fff",RESULT_TEXT2_SIZE=calcVerticalSize(30)+"px",RESULT_TEXT2_WEIGHT="bold",RESULT_TEXT2_ANCHOR="middle",RESULT_TEXT3_VALUE="5432",RESULT_TEXT3_X=viewportWidth$3/2,RESULT_TEXT3_SY=-200,RESULT_TEXT3_EY=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(140),RESULT_TEXT3_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT3_SIZE=calcVerticalSize(calcResultFontSize(RESULT_TEXT3_VALUE,115))+"px",RESULT_TEXT3_WEIGHT="bold",RESULT_TEXT3_ANCHOR="middle",RESULT_TEXT4_VALUE=`Твой
рекорд`,RESULT_TEXT4_SX=-viewportWidth$3,RESULT_TEXT4_EX=viewportWidth$3/4+calcSize(10),RESULT_TEXT4_Y=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(245),RESULT_TEXT4_FILL="#fff",RESULT_TEXT4_SIZE=calcVerticalSize(18)+"px",RESULT_TEXT4_WEIGHT="bold",RESULT_TEXT4_ANCHOR="middle",RESULT_TEXT5_VALUE="5,432",RESULT_TEXT5_SX=-viewportWidth$3,RESULT_TEXT5_EX=viewportWidth$3/4+calcSize(10),RESULT_TEXT5_Y=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(295),RESULT_TEXT5_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT5_SIZE=calcVerticalSize(44)+"px",RESULT_TEXT5_WEIGHT="bold",RESULT_TEXT5_ANCHOR="middle",RESULT_TEXT6_VALUE=`Общий
рекорд`,RESULT_TEXT6_SX=2*viewportWidth$3,RESULT_TEXT6_EX=3*(viewportWidth$3/4)-calcSize(10),RESULT_TEXT6_Y=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(245),RESULT_TEXT6_FILL="#fff",RESULT_TEXT6_SIZE=calcVerticalSize(18)+"px",RESULT_TEXT6_WEIGHT="bold",RESULT_TEXT6_ANCHOR="middle",RESULT_TEXT7_VALUE="10,000",RESULT_TEXT7_SX=2*viewportWidth$3,RESULT_TEXT7_EX=3*(viewportWidth$3/4)-calcSize(10),RESULT_TEXT7_Y=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(295),RESULT_TEXT7_FILL="270-#FFFFFF-#BCDBF8",RESULT_TEXT7_SIZE=calcVerticalSize(44)+"px",RESULT_TEXT7_WEIGHT="bold",RESULT_TEXT7_ANCHOR="middle",RESULT_TEXT_ANIM_LENGTH=500,RESULT_TEXT_CONFIG={text1Value:RESULT_TEXT1_VALUE,text1X:RESULT_TEXT1_X,text1Sy:RESULT_TEXT1_SY,text1Ey:RESULT_TEXT1_EY,text1Fill:RESULT_TEXT1_FILL,text1Size:RESULT_TEXT1_SIZE,text1Weight:RESULT_TEXT1_WEIGHT,text1Anchor:RESULT_TEXT1_ANCHOR,text2Value:RESULT_TEXT2_VALUE,text2X:RESULT_TEXT2_X,text2Sy:RESULT_TEXT2_SY,text2Ey:RESULT_TEXT2_EY,text2Fill:RESULT_TEXT2_FILL,text2Size:RESULT_TEXT2_SIZE,text2Weight:RESULT_TEXT2_WEIGHT,text2Anchor:RESULT_TEXT2_ANCHOR,text3Value:RESULT_TEXT3_VALUE,text3X:RESULT_TEXT3_X,text3Sy:RESULT_TEXT3_SY,text3Ey:RESULT_TEXT3_EY,text3Fill:RESULT_TEXT3_FILL,text3Size:RESULT_TEXT3_SIZE,text3Weight:RESULT_TEXT3_WEIGHT,text3Anchor:RESULT_TEXT3_ANCHOR,text4Value:RESULT_TEXT4_VALUE,text4Sx:RESULT_TEXT4_SX,text4Ex:RESULT_TEXT4_EX,text4Y:RESULT_TEXT4_Y,text4Fill:RESULT_TEXT4_FILL,text4Size:RESULT_TEXT4_SIZE,text4Weight:RESULT_TEXT4_WEIGHT,text4Anchor:RESULT_TEXT4_ANCHOR,text5Value:RESULT_TEXT5_VALUE,text5Sx:RESULT_TEXT5_SX,text5Ex:RESULT_TEXT5_EX,text5Y:RESULT_TEXT5_Y,text5Fill:RESULT_TEXT5_FILL,text5Size:RESULT_TEXT5_SIZE,text5Weight:RESULT_TEXT5_WEIGHT,text5Anchor:RESULT_TEXT5_ANCHOR,text6Value:RESULT_TEXT6_VALUE,text6Sx:RESULT_TEXT6_SX,text6Ex:RESULT_TEXT6_EX,text6Y:RESULT_TEXT6_Y,text6Fill:RESULT_TEXT6_FILL,text6Size:RESULT_TEXT6_SIZE,text6Weight:RESULT_TEXT6_WEIGHT,text6Anchor:RESULT_TEXT6_ANCHOR,text7Value:RESULT_TEXT7_VALUE,text7Sx:RESULT_TEXT7_SX,text7Ex:RESULT_TEXT7_EX,text7Y:RESULT_TEXT7_Y,text7Fill:RESULT_TEXT7_FILL,text7Size:RESULT_TEXT7_SIZE,text7Weight:RESULT_TEXT7_WEIGHT,text7Anchor:RESULT_TEXT7_ANCHOR,animLength:RESULT_TEXT_ANIM_LENGTH},BOTTOM_IMAGE="images/bottom.webp",BOTTOM_WIDTH=viewportWidth$3,BOTTOM_HEIGHT=calcSize(139),BOTTOM_ORIG_X=0,BOTTOM_ORIG_Y=viewportHeight$5,BOTTOM_TARGET_X=0,BOTTOM_TARGET_Y=viewportHeight$5-BOTTOM_HEIGHT,BOTTOM_DURATION=1e3,BOTTOM_CONFIG={image:BOTTOM_IMAGE,width:BOTTOM_WIDTH,height:BOTTOM_HEIGHT,startX:BOTTOM_ORIG_X,startY:BOTTOM_ORIG_Y,endX:BOTTOM_TARGET_X,endY:BOTTOM_TARGET_Y,duration:BOTTOM_DURATION},START_BUTTON_IMAGE="images/green-button.webp",START_BUTTON_ORIG_X=calcSize(42),START_BUTTON_TARGET_X=START_BUTTON_ORIG_X,START_BUTTON_ORIG_Y=viewportHeight$5,START_BUTTON_TARGET_Y=HOME_LOGO_TARGET_X+HOME_LOGO_HEIGHT+calcVerticalSize(330),START_BUTTON_WIDTH=calcSize(325),START_BUTTON_HEIGHT=calcSize(90),START_BUTTON_ANIMATION_LENGTH=500,START_BUTTON_TEXT_VALUE="Начать",START_BUTTON_TEXT_FILL="#fff",START_BUTTON_TEXT_SIZE=calcSize(30)+"px",START_BUTTON_TEXT_START_X=viewportWidth$3/2,START_BUTTON_TEXT_START_Y=viewportHeight$5+START_BUTTON_HEIGHT,START_BUTTON_TEXT_END_X=START_BUTTON_TEXT_START_X,START_BUTTON_TEXT_END_Y=START_BUTTON_TARGET_Y-calcVerticalSize(8)+START_BUTTON_HEIGHT/2,START_BUTTON_TEXT_ANCHOR="middle",START_BUTTON_TEXT_WEIGHT="bold",START_BUTTON_CONFIG={image:START_BUTTON_IMAGE,startX:START_BUTTON_ORIG_X,startY:START_BUTTON_ORIG_Y,endX:START_BUTTON_TARGET_X,endY:START_BUTTON_TARGET_Y,width:START_BUTTON_WIDTH,height:START_BUTTON_HEIGHT,textValue:START_BUTTON_TEXT_VALUE,textStartX:START_BUTTON_TEXT_START_X,textStartY:START_BUTTON_TEXT_START_Y,textEndX:START_BUTTON_TEXT_END_X,textEndY:START_BUTTON_TEXT_END_Y,textFill:START_BUTTON_TEXT_FILL,textSize:START_BUTTON_TEXT_SIZE,textAnchor:START_BUTTON_TEXT_ANCHOR,textWeight:START_BUTTON_TEXT_WEIGHT,animLength:START_BUTTON_ANIMATION_LENGTH},RESULT_BUTTON_NEXT_IMAGE="images/blue-button.webp",RESULT_BUTTON_NEXT_ORIG_X=calcSize(42),RESULT_BUTTON_NEXT_TARGET_X=RESULT_BUTTON_NEXT_ORIG_X,RESULT_BUTTON_NEXT_ORIG_Y=viewportHeight$5,RESULT_BUTTON_NEXT_TARGET_Y=RESULT_LOGO_TARGET_Y+RESULT_LOGO_HEIGHT+calcVerticalSize(360),RESULT_BUTTON_NEXT_WIDTH=calcSize(325),RESULT_BUTTON_NEXT_HEIGHT=calcSize(90),RESULT_BUTTON_NEXT_ANIMATION_LENGTH=500,RESULT_BUTTON_NEXT_TEXT_VALUE="Далее",RESULT_BUTTON_NEXT_TEXT_FILL="#fff",RESULT_BUTTON_NEXT_TEXT_SIZE=calcSize(30)+"px",RESULT_BUTTON_NEXT_TEXT_START_X=viewportWidth$3/2,RESULT_BUTTON_NEXT_TEXT_START_Y=viewportHeight$5+RESULT_BUTTON_NEXT_HEIGHT,RESULT_BUTTON_NEXT_TEXT_END_X=RESULT_BUTTON_NEXT_TEXT_START_X,RESULT_BUTTON_NEXT_TEXT_END_Y=RESULT_BUTTON_NEXT_TARGET_Y-calcSize(8)+RESULT_BUTTON_NEXT_HEIGHT/2,RESULT_BUTTON_NEXT_TEXT_ANCHOR="middle",RESULT_BUTTON_NEXT_TEXT_WEIGHT="bold",RESULT_BUTTON_NEXT_CONFIG={image:RESULT_BUTTON_NEXT_IMAGE,startX:RESULT_BUTTON_NEXT_ORIG_X,startY:RESULT_BUTTON_NEXT_ORIG_Y,endX:RESULT_BUTTON_NEXT_TARGET_X,endY:RESULT_BUTTON_NEXT_TARGET_Y,width:RESULT_BUTTON_NEXT_WIDTH,height:RESULT_BUTTON_NEXT_HEIGHT,textValue:RESULT_BUTTON_NEXT_TEXT_VALUE,textStartX:RESULT_BUTTON_NEXT_TEXT_START_X,textStartY:RESULT_BUTTON_NEXT_TEXT_START_Y,textEndX:RESULT_BUTTON_NEXT_TEXT_END_X,textEndY:RESULT_BUTTON_NEXT_TEXT_END_Y,textFill:RESULT_BUTTON_NEXT_TEXT_FILL,textSize:RESULT_BUTTON_NEXT_TEXT_SIZE,textAnchor:RESULT_BUTTON_NEXT_TEXT_ANCHOR,textWeight:RESULT_BUTTON_NEXT_TEXT_WEIGHT,animLength:RESULT_BUTTON_NEXT_ANIMATION_LENGTH},RESULT_BUTTON_REPLAY_IMAGE="images/green-button.webp",RESULT_BUTTON_REPLAY_ORIG_X=calcSize(42),RESULT_BUTTON_REPLAY_TARGET_X=RESULT_BUTTON_NEXT_ORIG_X,RESULT_BUTTON_REPLAY_ORIG_Y=viewportHeight$5,RESULT_BUTTON_REPLAY_TARGET_Y=RESULT_BUTTON_NEXT_TARGET_Y+RESULT_BUTTON_NEXT_HEIGHT,RESULT_BUTTON_REPLAY_WIDTH=calcSize(325),RESULT_BUTTON_REPLAY_HEIGHT=calcSize(90),RESULT_BUTTON_REPLAY_ANIMATION_LENGTH=500,RESULT_BUTTON_REPLAY_TEXT_VALUE="Начать заново",RESULT_BUTTON_REPLAY_TEXT_FILL="#fff",RESULT_BUTTON_REPLAY_TEXT_SIZE=calcSize(30)+"px",RESULT_BUTTON_REPLAY_TEXT_START_X=viewportWidth$3/2,RESULT_BUTTON_REPLAY_TEXT_START_Y=viewportHeight$5+RESULT_BUTTON_REPLAY_HEIGHT,RESULT_BUTTON_REPLAY_TEXT_END_X=RESULT_BUTTON_REPLAY_TEXT_START_X,RESULT_BUTTON_REPLAY_TEXT_END_Y=RESULT_BUTTON_REPLAY_TARGET_Y-calcSize(8)+RESULT_BUTTON_REPLAY_HEIGHT/2,RESULT_BUTTON_REPLAY_TEXT_ANCHOR="middle",RESULT_BUTTON_REPLAY_TEXT_WEIGHT="bold",RESULT_BUTTON_REPLAY_CONFIG={image:RESULT_BUTTON_REPLAY_IMAGE,startX:RESULT_BUTTON_REPLAY_ORIG_X,startY:RESULT_BUTTON_REPLAY_ORIG_Y,endX:RESULT_BUTTON_REPLAY_TARGET_X,endY:RESULT_BUTTON_REPLAY_TARGET_Y,width:RESULT_BUTTON_REPLAY_WIDTH,height:RESULT_BUTTON_REPLAY_HEIGHT,textValue:RESULT_BUTTON_REPLAY_TEXT_VALUE,textStartX:RESULT_BUTTON_REPLAY_TEXT_START_X,textStartY:RESULT_BUTTON_REPLAY_TEXT_START_Y,textEndX:RESULT_BUTTON_REPLAY_TEXT_END_X,textEndY:RESULT_BUTTON_REPLAY_TEXT_END_Y,textFill:RESULT_BUTTON_REPLAY_TEXT_FILL,textSize:RESULT_BUTTON_REPLAY_TEXT_SIZE,textAnchor:RESULT_BUTTON_REPLAY_TEXT_ANCHOR,textWeight:RESULT_BUTTON_REPLAY_TEXT_WEIGHT,animLength:RESULT_BUTTON_REPLAY_ANIMATION_LENGTH},SOUND_TEXT_SIZE=calcVerticalSize(16),SOUND_BUTTON_TEXT_VALUE_ON="Вкл. звук",SOUND_BUTTON_TEXT_VALUE_OFF="Откл. звук",SOUND_BUTTON_TEXT_FILL="#fff",SOUND_BUTTON_TEXT_SIZE=SOUND_TEXT_SIZE+"px",SOUND_BUTTON_TEXT_WEIGHT="normal",SOUND_BUTTON_TEXT_ANCHOR="end",SOUND_BUTTON_IMAGE_ON="images/sound-on.svg",SOUND_BUTTON_IMAGE_OFF="images/sound-off.svg",SOUND_BUTTON_IMAGE_WIDTH=calcSize(26),SOUND_BUTTON_IMAGE_HEIGHT=calcSize(26),SOUND_BUTTON_IMAGE_X=viewportWidth$3-SOUND_BUTTON_IMAGE_WIDTH-calcSize(38),SOUND_BUTTON_TEXT_X=SOUND_BUTTON_IMAGE_X-calcSize(10),SOUND_BUTTON_IMAGE_START_Y=-100,SOUND_BUTTON_IMAGE_HOME_END_Y=calcVerticalSize(13),SOUND_BUTTON_IMAGE_GAME_END_Y=SCORE_IMAGE_Y+SCORE_IMAGE_H+calcSize(4),SOUND_BUTTON_IMAGE_RESULT_END_Y=SOUND_TEXT_SIZE/2+calcSize(2),SOUND_BUTTON_TEXT_START_Y=-100,SOUND_BUTTON_TEXT_HOME_END_Y=SOUND_TEXT_SIZE/2+calcSize(18),SOUND_BUTTON_TEXT_GAME_END_Y=SCORE_TEXT2_Y,SOUND_BUTTON_TEXT_RESULT_END_Y=SOUND_TEXT_SIZE/2+calcSize(15),SOUND_BUTTON_ANIMATION_LENGTH=500,SOUND_BUTTON_CONFIG={textValueOn:SOUND_BUTTON_TEXT_VALUE_ON,textValueOff:SOUND_BUTTON_TEXT_VALUE_OFF,textFill:SOUND_BUTTON_TEXT_FILL,textSize:SOUND_BUTTON_TEXT_SIZE,textWeight:SOUND_BUTTON_TEXT_WEIGHT,textAnchor:SOUND_BUTTON_TEXT_ANCHOR,imageOn:SOUND_BUTTON_IMAGE_ON,imageOff:SOUND_BUTTON_IMAGE_OFF,imageWidth:SOUND_BUTTON_IMAGE_WIDTH,imageHeight:SOUND_BUTTON_IMAGE_HEIGHT,imageX:SOUND_BUTTON_IMAGE_X,textX:SOUND_BUTTON_TEXT_X,imageStartY:SOUND_BUTTON_IMAGE_START_Y,imageHomeEndY:SOUND_BUTTON_IMAGE_HOME_END_Y,imageGameEndY:SOUND_BUTTON_IMAGE_GAME_END_Y,imageResultEndY:SOUND_BUTTON_IMAGE_RESULT_END_Y,textStartY:SOUND_BUTTON_TEXT_START_Y,textHomeEndY:SOUND_BUTTON_TEXT_HOME_END_Y,textGameEndY:SOUND_BUTTON_TEXT_GAME_END_Y,textResultEndY:SOUND_BUTTON_TEXT_RESULT_END_Y,animLength:SOUND_BUTTON_ANIMATION_LENGTH},BRAND_QUESTION_FILL="#fff",BRAND_QUESTION_ANIMATION_LENGTH=500,BRAND_QUESTION_TITLE_VALUE=`Ответь на вопрос
Программы, чтобы
получить приз:`,BRAND_QUESTION_TITLE_SIZE=calcVerticalSize(30)+"px",BRAND_QUESTION_TITLE_WEIGHT="bold",BRAND_QUESTION_TITLE_ANCHOR="middle",BRAND_QUESTION_X=viewportWidth$3/2,BRAND_QUESTION_START_Y=-200,BRAND_QUESTION_END_Y=calcVerticalSize(100),BRAND_QUESTION_TITLE_CONFIG={textValue:BRAND_QUESTION_TITLE_VALUE,textFill:BRAND_QUESTION_FILL,textSize:BRAND_QUESTION_TITLE_SIZE,textWeight:BRAND_QUESTION_TITLE_WEIGHT,textAnchor:BRAND_QUESTION_TITLE_ANCHOR,textX:BRAND_QUESTION_X,textStartY:BRAND_QUESTION_START_Y,textEndY:BRAND_QUESTION_END_Y,animLength:BRAND_QUESTION_ANIMATION_LENGTH},BRAND_QUESTION_TEXT1_VALUE="Знаешь ли ты,",BRAND_QUESTION_TEXT1_SIZE=calcVerticalSize(40)+"px",BRAND_QUESTION_TEXT1_WEIGHT="bold",BRAND_QUESTION_TEXT1_ANCHOR="middle",BRAND_QUESTION_TEXT1_START_X=-viewportWidth$3,BRAND_QUESTION_TEXT1_END_X=viewportWidth$3/2,BRAND_QUESTION_TEXT1_Y=calcVerticalSize(249),BRAND_QUESTION_TEXT1_CONFIG={textValue:BRAND_QUESTION_TEXT1_VALUE,textFill:BRAND_QUESTION_FILL,textSize:BRAND_QUESTION_TEXT1_SIZE,textWeight:BRAND_QUESTION_TEXT1_WEIGHT,textAnchor:BRAND_QUESTION_TEXT1_ANCHOR,textStartX:BRAND_QUESTION_TEXT1_START_X,textEndX:BRAND_QUESTION_TEXT1_END_X,textY:BRAND_QUESTION_TEXT1_Y,animLength:BRAND_QUESTION_ANIMATION_LENGTH},BRAND_QUESTION_TEXT2_VALUE=`что табак для бренда
L&M собирается
с 4-х континентов?`,BRAND_QUESTION_TEXT2_SIZE=calcVerticalSize(26)+"px",BRAND_QUESTION_TEXT2_WEIGHT="bold",BRAND_QUESTION_TEXT2_ANCHOR="middle",BRAND_QUESTION_TEXT2_START_X=viewportWidth$3,BRAND_QUESTION_TEXT2_END_X=viewportWidth$3/2,BRAND_QUESTION_TEXT2_Y=calcVerticalSize(335),BRAND_QUESTION_TEXT2_CONFIG={textValue:BRAND_QUESTION_TEXT2_VALUE,textFill:BRAND_QUESTION_FILL,textSize:BRAND_QUESTION_TEXT2_SIZE,textWeight:BRAND_QUESTION_TEXT2_WEIGHT,textAnchor:BRAND_QUESTION_TEXT2_ANCHOR,textStartX:BRAND_QUESTION_TEXT2_START_X,textEndX:BRAND_QUESTION_TEXT2_END_X,textY:BRAND_QUESTION_TEXT2_Y,animLength:BRAND_QUESTION_ANIMATION_LENGTH},BRAND_ANSWER_BUTTON1_IMAGE="images/blue-button.webp",BRAND_ANSWER_BUTTON1_WIDTH=calcSize(325),BRAND_ANSWER_BUTTON1_HEIGHT=calcSize(90),BRAND_ANSWER_BUTTON1_X=calcSize(42),BRAND_ANSWER_BUTTON1_START_Y=viewportHeight$5,BRAND_ANSWER_BUTTON1_END_Y=calcVerticalSize(450),BRAND_ANSWER_TEXT1_VALUE="Нет",BRAND_ANSWER_TEXT1_SIZE=calcVerticalSize(30)+"px",BRAND_ANSWER_TEXT1_WEIGHT="bold",BRAND_ANSWER_TEXT1_ANCHOR="middle",BRAND_ANSWER_TEXT1_X=viewportWidth$3/2,BRAND_ANSWER_TEXT1_START_Y=viewportHeight$5+BRAND_ANSWER_BUTTON1_HEIGHT,BRAND_ANSWER_TEXT1_END_Y=BRAND_ANSWER_BUTTON1_END_Y-calcVerticalSize(6)+BRAND_ANSWER_BUTTON1_HEIGHT/2,BRAND_ANSWER1_CONFIG={image:BRAND_ANSWER_BUTTON1_IMAGE,width:BRAND_ANSWER_BUTTON1_WIDTH,height:BRAND_ANSWER_BUTTON1_HEIGHT,buttonX:BRAND_ANSWER_BUTTON1_X,buttonStartY:BRAND_ANSWER_BUTTON1_START_Y,buttonEndY:BRAND_ANSWER_BUTTON1_END_Y,textValue:BRAND_ANSWER_TEXT1_VALUE,textFill:BRAND_QUESTION_FILL,textSize:BRAND_ANSWER_TEXT1_SIZE,textWeight:BRAND_ANSWER_TEXT1_WEIGHT,textAnchor:BRAND_ANSWER_TEXT1_ANCHOR,textX:BRAND_ANSWER_TEXT1_X,textStartY:BRAND_ANSWER_TEXT1_START_Y,textEndY:BRAND_ANSWER_TEXT1_END_Y,animLength:BRAND_QUESTION_ANIMATION_LENGTH},BRAND_ANSWER_BUTTON2_IMAGE="images/green-button.webp",BRAND_ANSWER_BUTTON2_WIDTH=calcSize(325),BRAND_ANSWER_BUTTON2_HEIGHT=calcSize(90),BRAND_ANSWER_BUTTON2_X=calcSize(42),BRAND_ANSWER_BUTTON2_START_Y=viewportHeight$5,BRAND_ANSWER_BUTTON2_END_Y=BRAND_ANSWER_BUTTON1_END_Y+BRAND_ANSWER_BUTTON1_HEIGHT,BRAND_ANSWER_TEXT2_VALUE="Да",BRAND_ANSWER_TEXT2_SIZE=calcVerticalSize(30)+"px",BRAND_ANSWER_TEXT2_WEIGHT="bold",BRAND_ANSWER_TEXT2_ANCHOR="middle",BRAND_ANSWER_TEXT2_X=viewportWidth$3/2,BRAND_ANSWER_TEXT2_START_Y=viewportHeight$5+BRAND_ANSWER_BUTTON2_HEIGHT,BRAND_ANSWER_TEXT2_END_Y=BRAND_ANSWER_BUTTON2_END_Y-calcVerticalSize(6)+BRAND_ANSWER_BUTTON2_HEIGHT/2,BRAND_ANSWER2_CONFIG={image:BRAND_ANSWER_BUTTON2_IMAGE,width:BRAND_ANSWER_BUTTON2_WIDTH,height:BRAND_ANSWER_BUTTON2_HEIGHT,buttonX:BRAND_ANSWER_BUTTON2_X,buttonStartY:BRAND_ANSWER_BUTTON2_START_Y,buttonEndY:BRAND_ANSWER_BUTTON2_END_Y,textValue:BRAND_ANSWER_TEXT2_VALUE,textFill:BRAND_QUESTION_FILL,textSize:BRAND_ANSWER_TEXT2_SIZE,textWeight:BRAND_ANSWER_TEXT2_WEIGHT,textAnchor:BRAND_ANSWER_TEXT2_ANCHOR,textX:BRAND_ANSWER_TEXT2_X,textStartY:BRAND_ANSWER_TEXT2_START_Y,textEndY:BRAND_ANSWER_TEXT2_END_Y,animLength:BRAND_QUESTION_ANIMATION_LENGTH},blankArray=[],slice=blankArray.slice,join=blankArray.join,Ucren={isIe:/msie/i.test(navigator.userAgent),isIe6:/msie 6/i.test(navigator.userAgent),isFirefox:/firefox/i.test(navigator.userAgent),isSafari:/version\/[\d.]+\s+safari/i.test(navigator.userAgent),isOpera:/opera/i.test(navigator.userAgent),isChrome:/chrome/i.test(navigator.userAgent),isStrict:document.compatMode==="CSS1Compat",tempDom:document.createElement("div"),apply,appendStyle:function(i){var t;arguments.length>1&&(i=join.call(arguments,"")),document.createStyleSheet?(t=document.createStyleSheet(),t.cssText=i):(t=document.createElement("style"),t.type="text/css",t.appendChild(document.createTextNode(i)),document.getElementsByTagName("head")[0].appendChild(t))},addEvent:function(i,t,e){var T=function(){e.apply(i,arguments)};return i.dom&&(i=i.dom),window.attachEvent?i.attachEvent("on"+t,T):window.addEventListener?i.addEventListener(t,T,!1):i["on"+t]=T,T},delEvent:function(i,t,e){window.detachEvent?i.detachEvent("on"+t,e):window.removeEventListener?i.removeEventListener(t,e,!1):i["on"+t]===e&&(i["on"+t]=null)},Class:function(i,t,e,T){var s,n;return i=i||function(){},t=t||{},s=function(){this.instanceId=Ucren.id(),i.apply(this,arguments)},n=s.prototype,Ucren.registerClassEvent.call(n),Ucren.each(t,function(_,r){n[r]=function(h,S){return typeof h=="function"?function(){var E,o;if(E=slice.call(arguments,0),!(e&&e.apply(this,[S].concat(E))===!1))return this.fireEvent("before"+S,E),o=h.apply(this,E),T&&T.apply(this,[S].concat(E)),this.fireEvent(S,E),o}:h}(_,r)}),n.getOriginMethod=function(_){return t[_]},s},registerClassEvent:function(){this.on=function(i,t){var e=this.instanceId;Ucren.dispatch(e+i,t.bind(this))},this.onbefore=function(i,t){var e=this.instanceId;Ucren.dispatch(e+"before"+i,t.bind(this))},this.un=function(i,t){},this.fireEvent=function(i,t){var e=this.instanceId;Ucren.dispatch(e+i,t)}},createFuze:function(){var i,t,e;return i=[],t=function(T){e?T():i.push(T)},t.fire=function(){for(;i.length;)i.shift()();e=!0},t.extinguish=function(){e=!1},t.wettish=function(){i.length&&i.shift()()},t},dispatch:function(){var i={},t,e;return t=function(T,s,n){var _;(_=i[T])&&Ucren.each(_,function(r){r.apply(n,s)})},e=function(T,s){i[T]||(i[T]=[]),i[T].push(s)},function(T,s,n){typeof s>"u"&&(s=[]),s instanceof Array?t.apply(this,arguments):typeof s=="function"&&e.apply(this,arguments)}}(),each,Element:function(i,t){var e,T;return i&&i.isUcrenElement?t?i.dom:i:(i=typeof i=="string"?document.getElementById(i):i,i?t?i:(T=i.getAttribute("handleId"),typeof T=="string"?Ucren.handle(T-0):(e=new Ucren.BasicElement(i),T=Ucren.handle(e),i.setAttribute("handleId",T+""),e)):null)},Event:function(i){if(i=i||window.event,!i)for(var t=this.caller;t;){if(t.arguments&&t.arguments[0]&&typeof t.arguments[0].altKey=="boolean"){i=t.arguments[0];break}t=t.caller}return i},fixNumber:function(i,t){return typeof i=="number"?i:t},fixString:function(i,t){return typeof i=="string"?i:t},fixConfig:function(i){var t;return t={},typeof i>"u"?t:typeof i=="function"?new i:i},handle:function i(t){var e,T,s;if(e=i,e.cache||(e.cache={}),typeof e.number>"u"&&(e.number=0),T=typeof t,T==="number")return e.cache[t.toString()];if(T==="object"||T==="function")return s=e.number++,e.cache[s.toString()]=t,s},id:function i(){return i.number=++i.number||0,"_"+i.number},loadImage:function(i,t){var e=i.length,T=0,s=function(){T===e&&t&&t()};Ucren.each(i,function(n){var _=document.createElement("img");_.onload=_.onerror=function(){this.onload=this.onerror=null,T++,s()},Ucren.tempDom.appendChild(_),_.src=n})},loadScript:function(src,callback){Ucren.request(src,function(text){eval(text),callback&&callback(text)})},makeElement,nul,randomNumber:function(i){return Math.floor(Math.random()*i)},randomWord:function(){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return function(t,e){var T,s=[];return T=e||i,Ucren.each(t,(function(n){s[n]=T.charAt(this.randomNumber(T.length))}).bind(this)),s.join("")}}(),request:function(i,t){var e=Ucren.request,T=e.xhr;e.xhr||(window.XMLHttpRequest?T=e.xhr=new XMLHttpRequest:T=e.xhr=new ActiveXObject("Microsoft.XMLHTTP")),T.open("GET",i,!0),T.onreadystatechange=function(){T.readyState===4&&T.status===200&&t(T.responseText)},T.send(null)}};Ucren.BasicDrag=Ucren.Class(function(i){i=Ucren.fixConfig(i),this.type=Ucren.fixString(i.type,"normal");var t=this.isTouch="ontouchstart"in window;this.TOUCH_START=t?"touchstart":"mousedown",this.TOUCH_MOVE=t?"touchmove":"mousemove",this.TOUCH_END=t?"touchend":"mouseup"},{bind:function(i,t){i=Ucren.Element(i),t=Ucren.Element(t)||i;var e={};e[this.TOUCH_START]=(function(T){return T=Ucren.Event(T),this.startDrag(),T.cancelBubble=!0,T.stopPropagation&&T.stopPropagation(),T.returnValue=!1}).bind(this),t.addEvents(e),this.target=i},getCoors:function(i){var t=[];if(i.targetTouches&&i.targetTouches.length){var e=i.targetTouches[0];t[0]=e.clientX,t[1]=e.clientY}else t[0]=i.clientX,t[1]=i.clientY;return t},startDrag:function(){var i,t,e;i=this.target,t=i.draging={},this.isDraging=!0,t.x=parseInt(i.style("left"),10)||0,t.y=parseInt(i.style("top"),10)||0,e=Ucren.Event();var T=this.getCoors(e);t.mouseX=T[0],t.mouseY=T[1],this.registerDocumentEvent()},endDrag:function(){this.isDraging=!1,this.unRegisterDocumentEvent()},registerDocumentEvent:function(){var i,t;i=this.target,t=i.draging,t.documentSelectStart=Ucren.addEvent(document,"selectstart",function(e){return e=e||event,e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1}),t.documentMouseMove=Ucren.addEvent(document,this.TOUCH_MOVE,(function(e){var T,s;e=e||event,T=Ucren.isIe&&e.button!==1,s=!Ucren.isIe&&e.button!==0,(T||s)&&!this.isTouch&&this.endDrag();var n=this.getCoors(e);return t.newMouseX=n[0],t.newMouseY=n[1],e.stopPropagation&&e.stopPropagation(),e.returnValue=!1}).bind(this)),t.documentMouseUp=Ucren.addEvent(document,this.TOUCH_END,(function(){this.endDrag()}).bind(this)),clearInterval(t.timer),t.timer=setInterval((function(){var e,T,s,n;t.newMouseX&&(s=t.newMouseX-t.mouseX,n=t.newMouseY-t.mouseY,e=t.x+s,T=t.y+n,this.type==="calc"?this.returnValue(s,n,t.newMouseX,t.newMouseY):i.left(e).top(T))}).bind(this),10)},unRegisterDocumentEvent:function(){var i=this.target.draging;Ucren.delEvent(document,this.TOUCH_MOVE,i.documentMouseMove),Ucren.delEvent(document,this.TOUCH_END,i.documentMouseUp),Ucren.delEvent(document,"selectstart",i.documentSelectStart),clearInterval(i.timer)},returnValue:function(i,t,e,T){}});Ucren.Template=Ucren.Class(function(){this.string=join.call(arguments,"")},{apply:function(i){return this.string.format(i)}});Ucren.BasicElement=Ucren.Class(function(i){this.dom=i,this.countMapping={}},{isUcrenElement:!0,attr:function(i,t){if(typeof t=="string")this.dom.setAttribute(i,t);else return this.dom.getAttribute(i);return this},style:function(){var i=Ucren.isIe?function(t){return this.dom.currentStyle[t]}:function(t){var e;return e=document.defaultView.getComputedStyle(this.dom,null),e.getPropertyValue(t)};return function(t,e){if(typeof t=="object")Ucren.each(t,(function(T,s){this[s]=T}).bind(this.dom.style));else{if(typeof t=="string"&&typeof e>"u")return i.call(this,t);typeof t=="string"&&typeof e<"u"&&(this.dom.style[t]=e)}return this}}(),hasClass:function(i){var t=" "+this.dom.className+" ";return t.indexOf(" "+i+" ")>-1},setClass:function(i){return typeof i=="string"&&(this.dom.className=i.trim()),this},addClass:function(i){var t,e;return t=this.dom,e=" "+t.className+" ",e.indexOf(" "+i+" ")===-1&&(e+=i,e=e.trim(),e=e.replace(/ +/g," "),t.className=e),this},delClass:function(i){var t,e;return t=this.dom,e=" "+t.className+" ",e.indexOf(" "+i+" ")>-1&&(e=e.replace(" "+i+" "," "),e=e.trim(),e=e.replace(/ +/g," "),t.className=e),this},html:function(i){var t=this.dom;if(typeof i=="string")t.innerHTML=i;else if(i instanceof Array)t.innerHTML=i.join("");else return t.innerHTML;return this},left:function(i){var t=this.dom;if(typeof i=="number")t.style.left=i+"px",this.fireEvent("infect",[{left:i}]);else return this.getPos().x;return this},top:function(i){var t=this.dom;if(typeof i=="number")t.style.top=i+"px",this.fireEvent("infect",[{top:i}]);else return this.getPos().y;return this},width:function(i){var t=this.dom;if(typeof i=="number")t.style.width=i+"px",this.fireEvent("infect",[{width:i}]);else if(typeof i=="string")t.style.width=i,this.fireEvent("infect",[{width:i}]);else return this.getSize().width;return this},height:function(i){var t=this.dom;if(typeof i=="number")t.style.height=i+"px",this.fireEvent("infect",[{height:i}]);else if(typeof i=="string")t.style.height=i,this.fireEvent("infect",[{height:i}]);else return this.getSize().height;return this},count:function(i){return this.countMapping[i]=++this.countMapping[i]||1},display:function(i){var t=this.dom;if(typeof i=="boolean")t.style.display=i?"block":"none",this.fireEvent("infect",[{display:i}]);else return this.style("display")!=="none";return this},first:function(){for(var i=this.dom.firstChild;i&&!i.tagName&&i.nextSibling;)i=i.nextSibling;return i},add:function(i){var t;return t=Ucren.Element(i),this.dom.appendChild(t.dom),this},remove:function(i){var t;return i?(t=Ucren.Element(i),t.html(""),this.dom.removeChild(t.dom)):(t=Ucren.Element(this.dom.parentNode),t.remove(this)),this},insert:function(i){var t;return t=this.dom,t.firstChild?t.insertBefore(i,t.firstChild):this.add(i),this},addEvents:function(i){var t,e;return e={},t=this.dom,Ucren.each(i,function(T,s){e[s]=Ucren.addEvent(t,s,T)}),e},removeEvents:function(i){var t;return t=this.dom,Ucren.each(i,function(e,T){Ucren.delEvent(t,T,e)}),this},getPos:function(){var i,t,e,T,s;if(i=this.dom,e={},i.getBoundingClientRect){T=i.getBoundingClientRect(),s=Ucren.isIe?2:0;var n=document,_=Math.max(n.documentElement.scrollTop,n.body.scrollTop),r=Math.max(n.documentElement.scrollLeft,n.body.scrollLeft);return{x:T.left+r-s,y:T.top+_-s}}else{if(e={x:i.offsetLeft,y:i.offsetTop},t=i.offsetParent,t!==i)for(;t;)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;Ucren.isSafari&&this.style("position")==="absolute"&&(e.x-=document.body.offsetLeft,e.y-=document.body.offsetTop)}for(i.parentNode?t=i.parentNode:t=null;t&&t.tagName.toUpperCase()!=="BODY"&&t.tagName.toUpperCase()!=="HTML";)e.x-=t.scrollLeft,e.y-=t.scrollTop,t.parentNode?t=t.parentNode:t=null;return e},getSize:function(){var i=this.dom,t=this.style("display");if(t&&t!=="none")return{width:i.offsetWidth,height:i.offsetHeight};var e=i.style,T={visibility:e.visibility,position:e.position,display:e.display},s={visibility:"hidden",display:"block"};T.position!=="fixed"&&(s.position="absolute"),this.style(s);var n={width:i.offsetWidth,height:i.offsetHeight};return this.style(T),n},observe:function(i,t){return i=Ucren.Element(i),i.on("infect",t.bind(this)),this},usePNGbackground:function(i){var t;return t=this.dom,/\.png$/i.test(i)&&Ucren.isIe6?t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"',sizingMethod='scale');":t.style.backgroundImage="url("+i+")",this},setAlpha:function(){var i=/alpha\s*\(\s*opacity\s*=\s*([^)]+)\)/;return function(t){var e=this.dom,T=e.style;return Ucren.isIe?(e.currentStyle&&!e.currentStyle.hasLayout&&(T.zoom=1),i.test(T.filter)?(t=t>=99.99?"":"alpha(opacity="+t+")",T.filter=T.filter.replace(i,t)):T.filter+=" alpha(opacity="+t+")"):T.opacity=t/100,this}}(),fadeIn:function(i){typeof this.fadingNumber>"u"&&(this.fadingNumber=0),this.setAlpha(this.fadingNumber);var t=(function(){this.setAlpha(this.fadingNumber),this.fadingNumber===100?(clearInterval(this.fadingInterval),i&&i()):this.fadingNumber+=10}).bind(this);return this.display(!0),clearInterval(this.fadingInterval),this.fadingInterval=setInterval(t,Ucren.isIe?20:30),this},fadeOut:function(i){typeof this.fadingNumber>"u"&&(this.fadingNumber=100),this.setAlpha(this.fadingNumber);var t=(function(){this.setAlpha(this.fadingNumber),this.fadingNumber===0?(clearInterval(this.fadingInterval),this.display(!1),i&&i()):this.fadingNumber-=10}).bind(this);return clearInterval(this.fadingInterval),this.fadingInterval=setInterval(t,Ucren.isIe?20:30),this},useMouseAction:function(i,t){return this.MouseAction||(this.MouseAction=new Ucren.MouseAction({element:this})),this.MouseAction.use(i,t),this}});const layers={},zIndexes={[LAYERS.PRELOAD]:zi(),[LAYERS.DEFAULT]:zi(),[LAYERS.FLASH]:zi(),[LAYERS.JUICE]:zi(),[LAYERS.FRUIT]:zi(),[LAYERS.KNIFE]:zi(),[LAYERS.LIGHT]:zi(),[LAYERS.MASK]:zi(),[LAYERS.START_SCREEN]:zi(),[LAYERS.RESULT_SCREEN]:zi(),[LAYERS.BRAND_QUESTION]:zi()},{width,height}=viewport;function createImage(i,t,e,T,s,n,_="none"){return i=this.getLayer(i),i.image(t,e,T,s,n,_)}function createText(i,t,e,T,s,n,_="normal",r="start"){return i=this.getLayer(i),i.text(e,T,t).attr({fill:s||"#fff","font-family":FONT_FAMILY,"font-size":n||"14px","font-weight":_,"text-anchor":r})}function getLayer(i){i=i||LAYERS.DEFAULT;let t=layers[i],e;return t||(e=makeElement("div",{class:"layer","data-name":i,style:"z-index: "+(zIndexes[i]||0)+";"}),Ucren.Element("extra").add(e),t=layers[i]=Raphael(e,width,height),t)}function hideLayer(i){const t=getLayer(i);t&&t.canvas&&t.canvas.parentNode&&(t.canvas.parentNode.style.display="none")}function showLayer(i){const t=getLayer(i);t&&t.canvas&&t.canvas.parentNode&&(t.canvas.parentNode.style.display="block")}function zi(){return zi.num=++zi.num||2}const layer={createImage,createText,getLayer,hideLayer,showLayer};let addingTasks=[],adding=0,tasks=[];class Timeline{constructor(){a(this,"_requestAnimationFrame",function(t){return t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||function(e){setTimeout(e,1)}}(window)),this.startTime=0,this.count=0}now(){return new Date().getTime()}init(){this.startTime=this.now(),this.count=0,setInterval(()=>{this.count++,this.update(this.now())},1)}createTask(t){const e=this._createTask(t);return addingTasks.unshift(e),adding=1,t.recycle&&this.taskList(t.recycle,e),e}taskList(t,e){return t.clear||(t.clear=function(){for(let T,s=this.length-1;s>=0;s--)T=this[s],T.stop(),this.splice(s,1);return this}),e&&t.unshift(e),t}setTimeout(t,e){return this.createTask({start:e,duration:0,onTimeStart:t})}_setInterval(t,e){const T=setInterval(t,e);return{stop:function(){clearInterval(T)}}}getFPS(){const t=this.now(),e=this.count/(t-this.startTime)*1e3;return this.count>1e3&&(this.count=0,this.startTime=t),e}_createTask(t){const e=t.object||{};return t.start=t.start||0,{start:t.start+this.now(),duration:t.duration===-1?864e5:t.duration,data:t.data?[0].concat(t.data):[0],started:0,object:e,onTimeStart:t.onTimeStart||e.onTimeStart||nul,onTimeUpdate:t.onTimeUpdate||e.onTimeUpdate||nul,onTimeEnd:t.onTimeEnd||e.onTimeEnd||nul,stop:function(){this.stopped=1}}}updateTask(t,e){const T=t.data;T[0]=e,t.onTimeUpdate.apply(t.object,T)}checkStartTask(t){t.started||(t.started=1,t.onTimeStart.apply(t.object,t.data.slice(1)),this.updateTask(t,0))}update(t){let e=tasks.length,T,s,n,_;for(;e--;)if(s=tasks[e],n=s.start,_=s.duration,t>=n){if(s.stopped){tasks.splice(e,1);continue}this.checkStartTask(s),(T=t-n)<_?this.updateTask(s,T):(this.updateTask(s,_),s.onTimeEnd.apply(s.object,s.data.slice(1)),tasks.splice(e,1))}adding&&(tasks.unshift.apply(tasks,addingTasks),addingTasks.length=adding=0)}}const timeline=new Timeline;class Displacement{constructor({layer:t,imageSrc:e,width:T,height:s,startX:n,startY:_,endX:r,endY:h,animMap:S,duration:E}){a(this,"image"),a(this,"anim",{}),a(this,"anims",[]),this.layer=t,this.imageSrc=e,this.width=T,this.height=s,this.startX=n,this.startY=_,this.endX=r,this.endY=h,typeof S=="function"?this.anim.show=this.anim.hide=S:this.anim=S,this.duration=E}createTask(t,e,T,s,n,_,r,h){timeline.createTask({start:t,duration:e,object:this,data:[T,s,n,_,r,h],onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}set(){this.image=layer.createImage(this.layer,this.imageSrc,this.startX,this.startY,this.width,this.height)}show(t){this.createTask(t,this.duration,this.startX,this.startY,this.endX,this.endY,this.anim.show,MODES.SHOW)}hide(){this.anims.clear(),this.createTask(0,this.duration,this.endX,this.endY,this.startX,this.startY,this.anim.hide,MODES.HIDE)}onTimeUpdate(t,e,T,s,n,_){this.image.attr({x:_(t,e,s-e,this.duration),y:_(t,T,n-T,this.duration)})}onTimeStart(){}onTimeEnd(t,e,T,s,n){n===MODES.HIDE&&this.image.hide()}}class DisplacementFactory{create(t){return new Displacement(t)}}const displacementFactory=new DisplacementFactory;class Preload{constructor(t){displacementFactory.create({layer:LAYERS.PRELOAD,imageSrc:t}).set()}}class PreloadFactory{create(t){return new Preload(t)}}const preloadFactory=new PreloadFactory;function getURLs(){return[Object.values(FRUIT_CONFIG.infos).map(([i])=>i),Object.values(FRUIT_CONFIG.cutImages).flat(),FRUIT_CONFIG.shadowImage,LOSE_CONFIG.conf.map(({src:i})=>i)].flat()}function preload(){getURLs().forEach(preloadFactory.create)}function unsetObject(i){for(const t in i)i.hasOwnProperty(t)&&typeof i[t]=="function"&&(i[t]=function(){})}function getAngleByRadian(i){return i*180/Math.PI}function pointToRadian(i,t){if(t[0]===i[0])return t[1]>i[1]?Math.PI*.5:Math.PI*1.5;if(t[1]===i[1])return t[0]>i[0]?0:Math.PI;const e=Math.atan((i[1]-t[1])/(i[0]-t[0]));return t[0]>i[0]&&t[1]<i[1]?e+2*Math.PI:t[0]>i[0]&&t[1]>i[1]?e:e+Math.PI}const tools={unsetObject,getAngleByRadian,pointToRadian};function postMessage(i,t){const e=[].slice.call(arguments,0),T=e.length-1;t=e[T],e.slice(0,T),Ucren.dispatch(t,e)}function addEventListener(i,t){Ucren.dispatch(i,t)}const message={postMessage,addEventListener},stack={},cache={};class State{constructor(t){this.key=t}is(t){return stack[this.key]===t}isnot(t){return stack[this.key]!==t}ison(){return this.is(!0)}isoff(){return this.isnot(!0)}isunset(){return this.is(void 0)}set(t){stack[this.key]=t}get(){return stack[this.key]}on(){return this.set(!0),{keep:t=>{timeline.setTimeout(()=>this.set(!1),t)}}}off(){return this.set(!1),{keep:t=>{timeline.setTimeout(()=>this.set(!0),t)}}}}const state=i=>cache[i]?cache[i]:cache[i]=new State(i);class Knifes{constructor(){a(this,"_knifes",[]),a(this,"lastX",null),a(this,"lastY",null),a(this,"switchState",!0),a(this,"_anims",[])}get anims(){return this._anims}newKnife(){this.lastX=null,this.lastY=null}through(t,e){if(!this.switchState)return;let T=null;return this.lastX!==null&&(this.lastX!==t||this.lastY!==e)&&(new KnifePart({sx:this.lastX,sy:this.lastY,ex:t,ey:e}).set(),T=[this.lastX,this.lastY,t,e]),this.lastX=t,this.lastY=e,T}pause(){this.anims.clear&&this.anims.clear(),this.switchOff()}switchOff(){this.switchState=!1}switchOn(){this.switchState=!0,this.endAll()}endAll(){for(let t=this._knifes.length-1;t>=0;t--)this._knifes[t].end()}push(t){this._knifes.push(t)}indexOf(t){return this._knifes.indexOf(t)}splice(t,e){this._knifes.splice(t,e)}}const knifes=new Knifes;class KnifePart{constructor(t){a(this,"color",KNIFE_PART_CONFIG.color),a(this,"stroke",KNIFE_PART_CONFIG.stroke),a(this,"life",KNIFE_PART_CONFIG.life),this.sx=t.sx,this.sy=t.sy,this.ex=t.ex,this.ey=t.ey,knifes.push(this)}set(){const t=layer.getLayer(LAYERS.KNIFE);let e,T,s,n,_,r,h,S;return e=this.sx,T=this.sy,s=this.ex,n=this.ey,_=e-s,r=T-n,h=Math.abs(_),S=Math.abs(r),h>S?(e+=_<0?-1:1,T+=r<0?-(S/h):S/h):(e+=_<0?-(h/S):h/S,T+=r<0?-1:1),this.line=t.path("M"+e+","+T+"L"+s+","+n).attr({stroke:this.color,"stroke-width":this.stroke+"px"}),timeline.createTask({start:0,duration:this.life,object:this,onTimeUpdate:this.update,onTimeEnd:this.end,recycle:knifes.anims}),this}update(t){this.line.attr("stroke-width",this.stroke*(1-t/this.life)+"px")}end(){this.line.remove();const t=knifes.indexOf(this);t&&knifes.splice(t,1)}}const{width:viewportWidth$2,height:viewportHeight$4}=viewport;class Control{constructor(){a(this,"canvasTop",0),a(this,"canvasLeft",0),a(this,"fix",()=>{this.canvasLeft=(document.documentElement.clientWidth-viewportWidth$2)/2,this.canvasTop=(document.documentElement.clientHeight-viewportHeight$4)/2}),a(this,"dragHandler",(t,e,T,s,n)=>{const _=T-this.canvasLeft,r=s-this.canvasTop;if(INTERACTION_MODE===INTERACTION_MODES.SLICE){const h=knifes.through(_,r);h&&message.postMessage(h,MESSAGES.SLICE)}else INTERACTION_MODE===INTERACTION_MODES.TOUCH&&message.postMessage([_,r],MESSAGES.TOUCH)}),a(this,"startDragHandler",()=>{knifes.newKnife()})}init(){this.fixCanvasPos(),this.installDragger()}fixCanvasPos(){this.fix(),Ucren.addEvent(window,"resize",this.fix)}installDragger(){const t=new Ucren.BasicDrag({type:"calc"});t.on("returnValue",this.dragHandler),t.on("startDrag",this.startDragHandler),t.bind(document.documentElement)}}const control=new Control;function exponential(){}exponential.co=function i(t,e,T,s){return t==s?e+T:T*(-Math.pow(2,-10*t/s)+1)+e};exponential.ci=function i(t,e,T,s){return t==0?e:T*Math.pow(2,10*(t/s-1))+e};function quadratic(){}quadratic.ci=function i(t,e,T,s){return T*(t/=s)*t+e};quadratic.co=function i(t,e,T,s){return-T*(t/=s)*(t-2)+e};quadratic.cio=function i(t,e,T,s){return(t/=s/2)<1?T/2*t*t+e:-T/2*(--t*(t-2)-1)+e};function linear(i,t,e,T){return e*i/T+t}function back(){}back.ci=function i(t,e,T,s,n){return n=1.70158,T*((t=t/s-1)*t*((n+1)*t+n)+1)+e};back.co=function i(t,e,T,s,n){return n=1.70158,T*(t/=s)*t*((n+1)*t-n)+e};function init(){const i={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,e){e=e||{};let T=0,s=[],n={},_=i.isSupported();this.load=function(){return _?(this.sound.load(),this):this},this.play=function(){return _?(this.sound.play().catch(console.warn),this):this},this.togglePlay=function(){return _?(this.sound.paused?this.sound.play().catch(console.warn):this.sound.pause(),this):this},this.pause=function(){return _?(this.sound.pause(),this):this},this.isPaused=function(){return _?this.sound.paused:null},this.stop=function(){return _?(this.setTime(this.getDuration()),this.sound.pause(),this):this},this.isEnded=function(){return _?this.sound.ended:null},this.loop=function(){return _?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return _?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return _?(this.sound.muted=!0,this):this},this.unmute=function(){return _?(this.sound.muted=!1,this):this},this.toggleMute=function(){return _?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return _?this.sound.muted:null},this.setVolume=function(E){return _?(E<0&&(E=0),E>100&&(E=100),this.volume=E,this.sound.volume=E/100,this):this},this.getVolume=function(){return _?this.volume:this},this.increaseVolume=function(E){return this.setVolume(this.volume+(E||1))},this.decreaseVolume=function(E){return this.setVolume(this.volume-(E||1))},this.setTime=function(E){return _?(this.whenReady(function(){this.sound.currentTime=E}),this):this},this.getTime=function(){if(!_)return null;const E=Math.round(this.sound.currentTime*100)/100;return isNaN(E)?i.defaults.placeholder:E},this.setPercent=function(E){return _?this.setTime(i.fromPercent(E,this.sound.duration)):this},this.getPercent=function(){if(!_)return null;const E=Math.round(i.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(E)?i.defaults.placeholder:E},this.setSpeed=function(E){if(!_)return this;this.sound.playbackRate=E},this.getSpeed=function(){return _?this.sound.playbackRate:null},this.getDuration=function(){if(!_)return null;const E=Math.round(this.sound.duration*100)/100;return isNaN(E)?i.defaults.placeholder:E},this.getPlayed=function(){return _?r(this.sound.played):null},this.getBuffered=function(){return _?r(this.sound.buffered):null},this.getSeekable=function(){return _?r(this.sound.seekable):null},this.getErrorCode=function(){return _&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!_)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return _?this.sound.readyState:null},this.getStateMessage=function(){if(!_)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return _?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!_)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(E,o){return _?(this.sound[E]=o,this):this},this.get=function(E){return _?E?this.sound[E]:this.sound:null},this.bind=function(E,o){if(!_)return this;E=E.split(" ");const O=this,c=function(u){o.call(O,u)};for(let u=0;u<E.length;u++){let N=E[u],l=N;N=l.split(".")[0],s.push({idx:l,func:c}),this.sound.addEventListener(N,c,!0)}return this},this.unbind=function(E){if(!_)return this;E=E.split(" ");for(let o=0;o<E.length;o++){const O=E[o],c=O.split(".")[0];for(let u=0;u<s.length;u++){const N=s[u].idx.split(".");(s[u].idx===O||N[1]&&N[1]===O.replace(".",""))&&(this.sound.removeEventListener(c,s[u].func,!0),s.splice(u,1))}}return this},this.bindOnce=function(E,o){if(!_)return this;const O=this;n[T++]=!1,this.bind(T+E,function(){n[T]||(n[T]=!0,o.call(O)),O.unbind(T+E)})},this.trigger=function(E){if(!_)return this;E=E.split(" ");for(let o=0;o<E.length;o++){const O=E[o];for(let c=0;c<s.length;c++){const u=s[c].idx.split(".");if(s[c].idx===O||u[0]&&u[0]===O.replace(".","")){const N=document.createEvent("HTMLEvents");N.initEvent(u[0],!1,!0),this.sound.dispatchEvent(N)}}}return this},this.fadeTo=function(E,o,O){if(!_)return this;o instanceof Function?(O=o,o=i.defaults.duration):o=o||i.defaults.duration;const c=this.volume,u=o/Math.abs(c-E),N=this;this.play();function l(){setTimeout(function(){c<E&&N.volume<E?(N.setVolume(N.volume+=1),l()):c>E&&N.volume>E?(N.setVolume(N.volume-=1),l()):O instanceof Function&&O.apply(N)},u)}return this.whenReady(function(){l()}),this},this.fadeIn=function(E,o){return _?this.setVolume(0).fadeTo(100,E,o):this},this.fadeOut=function(E,o){return _?this.fadeTo(0,E,o):this},this.fadeWith=function(E,o){return _?(this.fadeOut(o,function(){this.stop()}),E.play().fadeIn(o),this):this},this.whenReady=function(E){if(!_)return null;const o=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){E.call(o)}):E.call(o)};function r(E){const o=[],O=E.length-1;for(let c=0;c<=O;c++)o.push({start:E.start(O),end:E.end(O)});return o}function h(E){return E.split(".").pop()}function S(E,o){const O=document.createElement("source");O.src=o,i.types[h(o)]&&(O.type=i.types[h(o)]),E.appendChild(O)}if(_&&t){for(const E in i.defaults)i.defaults.hasOwnProperty(E)&&(e[E]=e[E]||i.defaults[E]);if(this.sound=document.createElement("audio"),t instanceof Array)for(const E in t)t.hasOwnProperty(E)&&S(this.sound,t[E]);else if(e.formats.length)for(const E in e.formats)e.formats.hasOwnProperty(E)&&S(this.sound,t+"."+e.formats[E]);else S(this.sound,t);e.loop&&this.loop(),e.autoplay&&(this.sound.autoplay="autoplay"),e.preload===!0?this.sound.preload="auto":e.preload===!1?this.sound.preload="none":this.sound.preload=e.preload,this.setVolume(e.volume),i.sounds.push(this)}},group:function(t){t=T(t,arguments),this.getSounds=function(){return t},this.add=function(s){s=T(s,arguments);for(let n=0;n<s.length;n++)t.push(s[n])},this.remove=function(s){s=T(s,arguments);for(let n=0;n<s.length;n++)for(let _=0;_<t.length;_++)if(t[_]==s[n]){delete t[_];break}},this.load=function(){return e("load"),this},this.play=function(){return e("play"),this},this.togglePlay=function(){return e("togglePlay"),this},this.pause=function(s){return e("pause",s),this},this.stop=function(){return e("stop"),this},this.mute=function(){return e("mute"),this},this.unmute=function(){return e("unmute"),this},this.toggleMute=function(){return e("toggleMute"),this},this.setVolume=function(s){return e("setVolume",s),this},this.increaseVolume=function(s){return e("increaseVolume",s),this},this.decreaseVolume=function(s){return e("decreaseVolume",s),this},this.loop=function(){return e("loop"),this},this.unloop=function(){return e("unloop"),this},this.setTime=function(s){return e("setTime",s),this},this.setduration=function(s){return e("setduration",s),this},this.set=function(s,n){return e("set",s,n),this},this.bind=function(s,n){return e("bind",s,n),this},this.unbind=function(s){return e("unbind",s),this},this.bindOnce=function(s,n){return e("bindOnce",s,n),this},this.trigger=function(s){return e("trigger",s),this},this.fade=function(s,n,_,r){return e("fade",s,n,_,r),this},this.fadeIn=function(s,n){return e("fadeIn",s,n),this},this.fadeOut=function(s,n){return e("fadeOut",s,n),this};function e(){const s=T(null,arguments),n=s.shift();for(let _=0;_<t.length;_++)t[_][n].apply(t[_],s)}function T(s,n){return s instanceof Array?s:Array.prototype.slice.call(n)}},all:function(){return new i.group(i.sounds)},isSupported:function(){return!!i.el.canPlayType},isOGGSupported:function(){return!!i.el.canPlayType&&i.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!i.el.canPlayType&&i.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!i.el.canPlayType&&i.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!i.el.canPlayType&&(i.el.canPlayType("audio/x-m4a;")||i.el.canPlayType("audio/aac;"))},toTimer:function(t,e){let T,s,n;return T=Math.floor(t/3600),T=isNaN(T)?"--":T>=10?T:"0"+T,s=Math.floor(e?t/60%60:t/60),s=isNaN(s)?"--":s>=10?s:"0"+s,n=Math.floor(t%60),n=isNaN(n)?"--":n>=10?n:"0"+n,e?T+":"+s+":"+n:s+":"+n},fromTimer:function(t){const e=t.toString().split(":");return e&&e.length===3&&(t=parseInt(e[0],10)*3600+parseInt(e[1],10)*60+parseInt(e[2],10)),e&&e.length===2&&(t=parseInt(e[0],10)*60+parseInt(e[1],10)),t},toPercent:function(t,e,T){const s=Math.pow(10,T||0);return Math.round(t*100/e*s)/s},fromPercent:function(t,e,T){const s=Math.pow(10,T||0);return Math.round(e/100*t*s)/s}};return i}const buzz=init(),VIBRATION_PATTERNS={DEFAULT:[100],SOUND_BUTTON:[30],FRUIT:[30],GAME_OVER:[10,0,10,0,100,0,600],BOOM:[10,0,10,0,100,0,600,0,10,0,10,0,100,0,400]};class Vibration{vibrate(t=VIBRATION_PATTERNS.DEFAULT){navigator.vibrate&&navigator.vibrate(t)}soundButton(){this.vibrate(VIBRATION_PATTERNS.SOUND_BUTTON)}fruit(){this.vibrate(VIBRATION_PATTERNS.FRUIT)}gameOver(){this.vibrate(VIBRATION_PATTERNS.GAME_OVER)}boom(){this.vibrate(VIBRATION_PATTERNS.BOOM)}}const vibration=new Vibration;class SoundButton{constructor(){a(this,"startText"),a(this,"gameText"),a(this,"resultText"),a(this,"startSoundButton"),a(this,"gameSoundButton"),a(this,"resultSoundButton"),a(this,"startGroup"),a(this,"gameGroup"),a(this,"resultGroup"),a(this,"anims",[]),a(this,"anim",exponential.co),a(this,"isOn",!1)}set(){this.startSoundButton=layer.createImage(LAYERS.START_SCREEN,this.isOn?SOUND_BUTTON_CONFIG.imageOn:SOUND_BUTTON_CONFIG.imageOff,SOUND_BUTTON_CONFIG.imageX,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageWidth,SOUND_BUTTON_CONFIG.imageHeight).hide(),this.startText=layer.createText(LAYERS.START_SCREEN,this.isOn?SOUND_BUTTON_CONFIG.textValueOff:SOUND_BUTTON_CONFIG.textValueOn,SOUND_BUTTON_CONFIG.textX,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textFill,SOUND_BUTTON_CONFIG.textSize,SOUND_BUTTON_CONFIG.textWeight,SOUND_BUTTON_CONFIG.textAnchor),this.startGroup=layer.getLayer(LAYERS.START_SCREEN).set(),this.startGroup.push(this.startSoundButton,this.startText),this.startGroup.click(()=>{this.toggle(),message.postMessage(null,MESSAGES.TOGGLE_SOUND),vibration.soundButton()}),this.gameSoundButton=layer.createImage(LAYERS.FRUIT,this.isOn?SOUND_BUTTON_CONFIG.imageOn:SOUND_BUTTON_CONFIG.imageOff,SOUND_BUTTON_CONFIG.imageX,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageWidth,SOUND_BUTTON_CONFIG.imageHeight).hide(),this.gameText=layer.createText(LAYERS.FRUIT,this.isOn?SOUND_BUTTON_CONFIG.textValueOff:SOUND_BUTTON_CONFIG.textValueOn,SOUND_BUTTON_CONFIG.textX,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textFill,SOUND_BUTTON_CONFIG.textSize,SOUND_BUTTON_CONFIG.textWeight,SOUND_BUTTON_CONFIG.textAnchor),this.gameGroup=layer.getLayer(LAYERS.FRUIT).set(),this.gameGroup.push(this.gameSoundButton,this.gameText),this.gameGroup.click(()=>{this.toggle(),message.postMessage(null,MESSAGES.TOGGLE_SOUND),vibration.soundButton()}),this.resultSoundButton=layer.createImage(LAYERS.RESULT_SCREEN,this.isOn?SOUND_BUTTON_CONFIG.imageOn:SOUND_BUTTON_CONFIG.imageOff,SOUND_BUTTON_CONFIG.imageX,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageWidth,SOUND_BUTTON_CONFIG.imageHeight).hide(),this.resultText=layer.createText(LAYERS.RESULT_SCREEN,this.isOn?SOUND_BUTTON_CONFIG.textValueOff:SOUND_BUTTON_CONFIG.textValueOn,SOUND_BUTTON_CONFIG.textX,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textFill,SOUND_BUTTON_CONFIG.textSize,SOUND_BUTTON_CONFIG.textWeight,SOUND_BUTTON_CONFIG.textAnchor),this.resultGroup=layer.getLayer(LAYERS.START_SCREEN).set(),this.resultGroup.push(this.resultSoundButton,this.resultText),this.resultGroup.click(()=>{this.toggle(),message.postMessage(null,MESSAGES.TOGGLE_SOUND),vibration.soundButton()})}show(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.SHOW,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageHomeEndY,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textHomeEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.SHOW,SOUND_BUTTON_CONFIG.imageHomeEndY,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.textHomeEndY,SOUND_BUTTON_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showHomeSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.SHOW,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageHomeEndY,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textHomeEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showResultSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.SHOW,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageResultEndY,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textResultEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}showGameSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.SHOW,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.imageGameEndY,SOUND_BUTTON_CONFIG.textStartY,SOUND_BUTTON_CONFIG.textGameEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideHomeSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.HIDE,SOUND_BUTTON_CONFIG.imageHomeEndY,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.textHomeEndY,SOUND_BUTTON_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideResultSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.HIDE,SOUND_BUTTON_CONFIG.imageResultEndY,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.textResultEndY,SOUND_BUTTON_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hideGameSoundButton(t){timeline.createTask({start:t,duration:SOUND_BUTTON_CONFIG.animLength,data:[MODES.HIDE,SOUND_BUTTON_CONFIG.imageGameEndY,SOUND_BUTTON_CONFIG.imageStartY,SOUND_BUTTON_CONFIG.textGameEndY,SOUND_BUTTON_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_){this.startSoundButton.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.startText.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength)),this.gameSoundButton.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.gameText.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength)),this.resultSoundButton.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.resultText.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.startSoundButton,this.startText,this.gameSoundButton,this.gameText,this.resultSoundButton,this.resultText].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.startSoundButton,this.startText,this.gameSoundButton,this.gameText,this.resultSoundButton,this.resultText].invoke(t)}toggle(){this.isOn?this.off():this.on()}on(){this.startText.attr("text",SOUND_BUTTON_CONFIG.textValueOff),this.startSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOn),this.gameText.attr("text",SOUND_BUTTON_CONFIG.textValueOff),this.gameSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOn),this.resultText.attr("text",SOUND_BUTTON_CONFIG.textValueOff),this.resultSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOn),this.isOn=!0}off(){this.startText.attr("text",SOUND_BUTTON_CONFIG.textValueOn),this.startSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOff),this.gameText.attr("text",SOUND_BUTTON_CONFIG.textValueOn),this.gameSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOff),this.resultText.attr("text",SOUND_BUTTON_CONFIG.textValueOn),this.resultSoundButton.attr("src",SOUND_BUTTON_CONFIG.imageOff),this.isOn=!1}}const soundButton=new SoundButton;class Sound{constructor(t){this.sound=new buzz.sound(t,{formats:["ogg","mp3"],preload:!0,autoload:!0,loop:!1})}play(){this.sound.setPercent(0),this.sound.setVolume(100),soundButton.isOn&&this.sound.play()}stop(){soundButton.isOn?this.sound.fadeOut(1e3,function(){this.pause()}):this.sound.stop()}}class SoundFactory{create(t){return new Sound(t)}}const soundFactory=new SoundFactory;class Flash{constructor(){a(this,"image"),a(this,"snd"),a(this,"xDiff",0),a(this,"yDiff",0),a(this,"switchOn",!0),a(this,"anim",quadratic.cio),a(this,"anims",[]),a(this,"dur",FLASH_CONFIG.duration)}set(){if(!this.switchOn)return!1;this.image=layer.createImage(LAYERS.FLASH,FLASH_CONFIG.image,0,0,FLASH_CONFIG.width,FLASH_CONFIG.height).hide(),this.snd=soundFactory.create("sound/splatter")}showAt(t,e,T){if(!this.switchOn)return!1;this.image&&this.image.rotate(T,!0).scale(1e-5,1e-5).attr({x:t+this.xDiff,y:e+this.yDiff}).show(),this.anims.clear&&this.anims.clear(),this.snd&&this.snd.play(),timeline.createTask({start:0,duration:this.dur,data:[1e-5,1],object:this,onTimeUpdate:this.onTimeUpdate,recycle:this.anims}),timeline.createTask({start:this.dur,duration:this.dur,data:[1,1e-5],object:this,onTimeUpdate:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,T,s){if(!this.switchOn)return!1;this.image.scale(s=this.anim(t,e,T-e,this.dur),s)}}const flash=new Flash;class Juice{constructor(t,e,T,s=JUICE_CONFIG.shapes.CIRCLE){a(this,"dur",JUICE_CONFIG.duration),a(this,"anim",exponential.co),a(this,"dropAnim",quadratic.co),a(this,"shape"),a(this,"figure"),this.originX=t,this.originY=e,this.color=T,this.radius=JUICE_CONFIG.radius,this.distance=randomNumber(200)+100,this.dir=randomNumber(360)*Math.PI/180,this.shape=s}render(){const t=layer.getLayer(LAYERS.JUICE);if(this.shape===JUICE_CONFIG.shapes.CIRCLE)this.figure=t.circle(this.originX,this.originY,this.radius).attr({fill:this.color,stroke:"none"});else if(this.shape===JUICE_CONFIG.shapes.SQUARE)this.figure=t.rect(this.originX-this.radius,this.originY-this.radius,this.radius*2,this.radius*2).attr({fill:this.color,stroke:"none"});else if(this.shape===JUICE_CONFIG.shapes.DIAMOND){const e=this.createStarPath(this.originX,this.originY,this.radius,4);this.figure=t.path(e).attr({fill:this.color,stroke:"none"})}else if(this.shape===JUICE_CONFIG.shapes.STAR){const e=this.createStarPath(this.originX,this.originY,this.radius,5);this.figure=t.path(e).attr({fill:this.color,stroke:"none"})}}createStarPath(t,e,T,s){const n=Math.PI/s;let _="";for(let r=0;r<2*s;r++){const h=r*n,S=r%2===0?T:T/2,E=t+S*Math.sin(h),o=e-S*Math.cos(h);_+=r===0?`M ${E} ${o}`:`L ${E} ${o}`}return _+="Z",_}sputter(){timeline.createTask({start:0,duration:this.dur,object:this,onTimeUpdate:this.onTimeUpdate,onTimeEnd:this.onTimeEnd})}onTimeUpdate(t){const e=this.anim(t,0,this.distance,this.dur),T=this.originX+e*Math.cos(this.dir),s=this.originY+e*Math.sin(this.dir)+this.dropAnim(t,0,200,this.dur),n=this.anim(t,1,-1,this.dur);this.shape===JUICE_CONFIG.shapes.CIRCLE?this.figure.attr({cx:T,cy:s}).scale(n,n):this.shape===JUICE_CONFIG.shapes.SQUARE?this.figure.attr({x:T-this.radius*n,y:s-this.radius*n}).scale(n,n):this.shape===JUICE_CONFIG.shapes.DIAMOND?this.figure.attr({path:this.createStarPath(T,s,this.radius*n,4)}).scale(n,n):this.shape===JUICE_CONFIG.shapes.STAR&&this.figure.attr({path:this.createStarPath(T,s,this.radius*n,5)}).scale(n,n)}onTimeEnd(){this.figure.remove(),tools.unsetObject(this)}}class JuiceFactory{constructor(){a(this,"num",JUICE_CONFIG.number),a(this,"createOne",function(t,e,T){if(!T)return;const s=new Juice(t,e,T,JUICE_CONFIG.shape);s.render(),s.sputter()})}create(t,e,T){for(let s=0;s<this.num;s++)this.createOne(t,e,T)}}const juiceFactory=new JuiceFactory,{height:viewportHeight$3}=viewport,average=function(i,t){return(i+t)/2>>0};class Fruit{constructor(t){a(this,"image"),a(this,"shadow"),a(this,"zoomAnim",exponential.co),a(this,"linearAnim",linear),a(this,"dropAnim",quadratic.ci),a(this,"fallOffAnim",quadratic.co),a(this,"rotateSpeed",[60,50,40,-40,-50,-60]),a(this,"brokend",!1),a(this,"apartAngle",0),a(this,"aparted",!1),a(this,"shotOutStartX"),a(this,"shotOutStartY"),a(this,"shotOutEndX"),a(this,"shotOutEndY"),a(this,"fallOffToX"),a(this,"fallTargetX"),a(this,"fallTargetY"),a(this,"brokenPosX"),a(this,"brokenPosY"),a(this,"brokenTargetX1"),a(this,"brokenTargetY1"),a(this,"brokenTargetX2"),a(this,"brokenTargetY2"),a(this,"bImage1RotateAngle"),a(this,"bImage2RotateAngle"),a(this,"fallOutOfViewerCalled",!1),a(this,"fallOffing",!1),a(this,"type"),a(this,"shotOut",(()=>{const T=[-1,1];return(s,n)=>(this.shotOutStartX=this.originX,this.shotOutStartY=this.originY,this.shotOutEndX=average(this.originX,n),this.shotOutEndY=Math.min(this.startY-randomNumber(this.startY-100),200),this.fallOffToX=n,timeline.createTask({start:s,duration:FRUIT_CONFIG.dropTime,object:this,onTimeUpdate:this.onShotOuting,onTimeStart:this.onShotOutStart,onTimeEnd:this.onShotOutEnd,recycle:this.anims}),this.type!==FRUIT_CONFIG.types.BOOM&&this.rotate(0,(randomNumber(180)+90)*T[randomNumber(2)]),this)})()),a(this,"fallOff",(()=>{const T=[-1,1];let s=0;return(n,_)=>{if(this.aparted||this.brokend)return;this.fallOffing=1;const r=viewportHeight$3+calcSize(120);typeof _!="number"&&(_=this.originX+randomNumber(FRUIT_CONFIG.dropXScope)*T[s++%2]),this.fallTargetX=_,this.fallTargetY=r,timeline.createTask({start:n,duration:FRUIT_CONFIG.dropTime,object:this,onTimeUpdate:this.onFalling,onTimeStart:this.onFallStart,onTimeEnd:this.onFallEnd,recycle:this.anims})}})()),a(this,"clickHandler",T=>{const s=T.clientX-control.canvasLeft,n=T.clientY-control.canvasTop;message.postMessage([s,n],MESSAGES.TOUCH)});const e=FRUIT_CONFIG.infos[t.type][3];this.type=t.type,this.originX=t.originX,this.originY=t.originY,this.radius=e,this.startX=t.originX,this.startY=t.originY,this.anims=[]}set(t){const e=FRUIT_CONFIG.infos[this.type],T=this.radius;return this.shadow=layer.createImage(LAYERS.FRUIT,FRUIT_CONFIG.shadowImage,this.startX-T,this.startY-T+FRUIT_CONFIG.shadowPos,106,77),this.image=layer.createImage(LAYERS.FRUIT,e[0],this.startX-T,this.startY-T,e[1],e[2]),IS_TOUCH&&this.addClickHandler(),this.type===FRUIT_CONFIG.types.BOOM&&this.image.rotate(e[4]),t&&(this.image.hide(),this.shadow.hide()),DEBUG_MODE&&this.showDebugCatchArea(),this}addClickHandler(){this.image.node.addEventListener("click",this.clickHandler)}removeClickHandler(){this.image.node.removeEventListener("click",this.clickHandler)}showDebugCatchArea(){const{originX:t,originY:e,radius:T}=this;this.debugArea=this.image.paper.circle(t,e,T).attr({stroke:"red","stroke-width":2,"stroke-dasharray":"- ",opacity:.5}),this.debugArea.insertBefore(this.image)}pos(t,e){const T=this.radius;this.originX=t,this.originY=e,this.image.attr({x:t-=T,y:e-=T}),this.shadow.attr({x:t,y:e+FRUIT_CONFIG.shadowPos}),DEBUG_MODE&&this.debugArea.attr({cx:t+T,cy:e+T}),this.fallOffing&&!this.fallOutOfViewerCalled&&e>viewportHeight$3+this.radius&&(this.fallOutOfViewerCalled=1,message.postMessage(this,MESSAGES.FRUIT_FALL_OUT_OF_VIEWER))}show(t){timeline.createTask({start:t,duration:500,data:[1e-5,1,MODES.SHOW],object:this,onTimeUpdate:this.onScaling,onTimeStart:this.onShowStart,recycle:this.anims})}hide(t){this.type===FRUIT_CONFIG.types.BOOM&&(this.anims.clear(),timeline.createTask({start:t,duration:500,data:[1,1e-5,MODES.HIDE],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd,recycle:this.anims}))}rotate(t,e){this.rotateSpeed=e||this.rotateSpeed[randomNumber(6)],timeline.createTask({start:t,duration:-1,object:this,onTimeUpdate:this.onRotating,recycle:this.anims})}broken(t){if(this.brokend)return;this.brokend=!0;const e=FruitFactory.fruitCache.indexOf(this);e>-1&&FruitFactory.fruitCache.splice(e,1),this.type!==FRUIT_CONFIG.types.BOOM?(flash.showAt(this.originX,this.originY,t),juiceFactory.create(this.originX,this.originY,FRUIT_CONFIG.infos[this.type][6]),this.apart(t)):this.hide()}pause(){this.brokend||this.anims.clear()}apart(t){this.anims.clear(),this.image.hide(),this.shadow.hide(),this.aparted=!0;const e=FRUIT_CONFIG.infos[this.type],T=FRUIT_CONFIG.cutImages[this.type],s=this.radius,n=layer.createImage.saturate(layer,this.startX-s,this.startY-s,e[1],e[2]);t=(t%180+360+e[4])%360,this.bImage1=n(LAYERS.FRUIT,T[0]),this.bImage2=n(LAYERS.FRUIT,T[1]),[this.bImage1,this.bImage2].invoke("rotate",t),this.apartAngle=t,timeline.createTask({start:0,duration:FRUIT_CONFIG.dropTime,object:this,onTimeUpdate:this.onBrokenDropUpdate,onTimeStart:this.onBrokenDropStart,onTimeEnd:this.onBrokenDropEnd,recycle:this.anims}),this.debugArea&&this.debugArea.remove()}remove(){IS_TOUCH&&this.removeClickHandler(),this.anims.clear(),this.image&&(this.image.remove(),this.shadow.remove(),this.debugArea&&this.debugArea.remove()),this.bImage1&&(this.bImage1.remove(),this.bImage2.remove());const t=FruitFactory.fruitCache.indexOf(this);t>-1&&FruitFactory.fruitCache.splice(t,1);for(const e in this)typeof this[e]=="function"?this[e]=function(T){return function(){throw new Error("method "+T+" has been removed")}}(e):delete this[e];message.postMessage(this,MESSAGES.FRUIT_REMOVE)}onShowStart(){this.image.show(),this.shadow.show()}onScaling(t,e,T,s){this.image.scale(s=this.zoomAnim(t,e,T-e,500),s),this.shadow.scale(s,s)}onHideEnd(){this.remove()}onRotating(t){this.image.rotate(this.rotateSpeed*t/1e3%360,!0)}onBrokenDropUpdate(t){const e=this.radius;this.bImage1.attr({x:this.linearAnim(t,this.brokenPosX-e,this.brokenTargetX1,FRUIT_CONFIG.dropTime),y:this.dropAnim(t,this.brokenPosY-e,this.brokenTargetY1-this.brokenPosY+e,FRUIT_CONFIG.dropTime)}).rotate(this.linearAnim(t,this.apartAngle,this.bImage1RotateAngle,FRUIT_CONFIG.dropTime),!0),this.bImage2.attr({x:this.linearAnim(t,this.brokenPosX-e,this.brokenTargetX2,FRUIT_CONFIG.dropTime),y:this.dropAnim(t,this.brokenPosY-e,this.brokenTargetY2-this.brokenPosY+e,FRUIT_CONFIG.dropTime)}).rotate(this.linearAnim(t,this.apartAngle,this.bImage2RotateAngle,FRUIT_CONFIG.dropTime),!0)}onBrokenDropStart(){this.brokenTargetX1=-(randomNumber(FRUIT_CONFIG.dropXScope)+75),this.brokenTargetX2=randomNumber(FRUIT_CONFIG.dropXScope+75),this.brokenTargetY1=600,this.brokenTargetY2=600,this.brokenPosX=this.originX,this.brokenPosY=this.originY,this.bImage1RotateAngle=-randomNumber(150)-50,this.bImage2RotateAngle=randomNumber(150)+50;for(let t=FruitFactory.fruitCache.length-1;t>=0;t--)FruitFactory.fruitCache[t]===this&&FruitFactory.fruitCache.splice(t,1)}onBrokenDropEnd(){this.remove()}onShotOuting(t){this.pos(this.linearAnim(t,this.shotOutStartX,this.shotOutEndX-this.shotOutStartX,FRUIT_CONFIG.dropTime),this.fallOffAnim(t,this.shotOutStartY,this.shotOutEndY-this.shotOutStartY,FRUIT_CONFIG.dropTime))}onShotOutStart(){}onShotOutEnd(){this.fallOff(0,this.fallOffToX)}onFalling(t){this.pos(this.linearAnim(t,this.brokenPosX,this.fallTargetX-this.brokenPosX,FRUIT_CONFIG.dropTime),this.dropAnim(t,this.brokenPosY,this.fallTargetY-this.brokenPosY,FRUIT_CONFIG.dropTime))}onFallStart(){this.brokenPosX=this.originX,this.brokenPosY=this.originY}onFallEnd(){message.postMessage(this,MESSAGES.FRUIT_FALL_OFF),this.remove()}}const R=class U{constructor(){a(this,"types",[FRUIT_CONFIG.types.PEACH,FRUIT_CONFIG.types.SANDIA,FRUIT_CONFIG.types.APPLE,FRUIT_CONFIG.types.BANANA,FRUIT_CONFIG.types.BASAHA])}create(t,e){const T=new Fruit({type:this.getType(),originX:t,originY:e}).set();return U.fruitCache.unshift(T),T}getType(){return randomNumber(8)===4?FRUIT_CONFIG.types.BOOM:this.types[randomNumber(5)]}getFruitInView(){return U.fruitCache}};a(R,"fruitCache",[]);let FruitFactory=R;const fruitFactory=new FruitFactory;class Collide{checkSlice(t){const e=[];let T=0;return fruitFactory.getFruitInView().forEach(s=>{this.isLineIntersectingEllipse(t.slice(0,2),t.slice(2,4),[s.originX,s.originY],s.radius)&&(e[T++]=s)}),e}checkTouch(t){const e=[];let T=0;return fruitFactory.getFruitInView().forEach(s=>{this.isPointInsideEllipse(t,[s.originX,s.originY],s.radius)&&(e[T++]=s)}),e}isPointInsideEllipse(t,e,T){const s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n<=T*T}isLineIntersectingEllipse(t,e,T,s,n=1){const _=this.calculateLineEllipseIntersections(t,e,T,s,n);return _&&(_[0]||_[1])}calculateLineEllipseIntersections(t,e,T,s,n=1){if(s<=0)return;const _=s,r=s*n,h=this.square(r)*this.square(t[0]-e[0])+this.square(_)*this.square(t[1]-e[1]);if(h<=0)return;const S=2*this.square(r)*(e[0]-t[0])*(t[0]-T[0])+2*this.square(_)*(e[1]-t[1])*(t[1]-T[1]),E=this.square(r)*this.square(t[0]-T[0])+this.square(_)*this.square(t[1]-T[1])-this.square(_)*this.square(r),o=this.solveQuadraticEquation(h,S,E);if(!o)return;const O=[[t[0]+o[0]*(e[0]-t[0]),t[1]+o[0]*(e[1]-t[1])],[t[0]+o[1]*(e[0]-t[0]),t[1]+o[1]*(e[1]-t[1])]];return this.isPointOnSegment(O[0],t,e)||(O[0]=null),this.isPointOnSegment(O[1],t,e)||(O[1]=null),O}isPointOnSegment(t,e,T){return t?this.getSign(t[0]-e[0])*this.getSign(t[0]-T[0])<=0&&this.getSign(t[1]-e[1])*this.getSign(t[1]-T[1])<=0:!1}square(t){return Math.pow(t,2)}getSign(t){return t<0?-1:t>0?1:0}solveQuadraticEquation(t,e,T){if(t===0)return;const s=e*e-4*t*T;if(s===0){const n=-e/(2*t);return[n,n]}else if(s>0){const n=Math.sqrt(s);return[(-e+n)/(2*t),(-e-n)/(2*t)]}}}const collide=new Collide,{width:viewportWidth$1,height:viewportHeight$2}=viewport;class Light{constructor(){a(this,"maskLayer",layer.getLayer(LAYERS.MASK)),a(this,"lightLayer",layer.getLayer(LAYERS.LIGHT)),a(this,"lights",[]),a(this,"indexs",[]),a(this,"lightsNum",LIGHTS_CONFIG.number),a(this,"overWhiteLight",()=>{message.postMessage(MESSAGES.OVER_WHITE_LIGHT_SHOW),this.removeLights();const t=4e3,e=this.maskLayer.rect(0,0,viewportWidth$1,viewportHeight$2).attr({fill:LIGHTS_CONFIG.fill,stroke:"none"}),T={onTimeUpdate:function(s){e.attr("opacity",1-s/t)},onTimeEnd:function(){e.remove(),message.postMessage(MESSAGES.GAME_OVER),message.postMessage(SCENES.GAME_OVER,MESSAGES.SCENE_SWITCH_SCENE)}};layer.showLayer(LAYERS.MASK),timeline.createTask({start:0,duration:t,object:T,onTimeUpdate:T.onTimeUpdate,onTimeEnd:T.onTimeEnd})});for(let t=0;t<this.lightsNum;t++)this.indexs[t]=t;layer.hideLayer(LAYERS.LIGHT),layer.hideLayer(LAYERS.MASK)}start(t){const e=t.originX,T=t.originY,s=this.indexs.random();let n=0;const _=r=>{this.build(e,T,s[r])};for(let r=0;r<this.lightsNum;r++)timeline.setTimeout(()=>_(r),n+=200);timeline.setTimeout(this.overWhiteLight,n+200)}removeLights(){const t=this.lights.length;for(let e=0;e<t;e++)this.lights[e].remove();this.lights.length=0}build(t,e,T){let s=T*36+randomNumber(10),n=s+5;s=Math.PI*s/180,n=Math.PI*n/180;const _=t+2*viewportWidth$1*Math.cos(s),r=e+2*viewportWidth$1*Math.sin(s),h=t+2*viewportWidth$1*Math.cos(n),S=e+2*viewportWidth$1*Math.sin(n),E=this.lightLayer.path(["M",t,e,"L",_,r,"L",h,S,"Z"]).attr({stroke:"none",fill:LIGHTS_CONFIG.fill});layer.showLayer(LAYERS.LIGHT),this.lights.push(E)}}const light=new Light;class Score{constructor(){a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"anim",exponential.co),a(this,"anims",[]),a(this,"image"),a(this,"text1"),a(this,"text2")}set(){this.image=layer.createImage(LAYERS.DEFAULT,SCORE_CONFIG.image,SCORE_CONFIG.imageSx,SCORE_CONFIG.imageY,SCORE_CONFIG.imageW,SCORE_CONFIG.imageH).hide(),this.text1=layer.createText(LAYERS.DEFAULT,SCORE_CONFIG.text1Value,SCORE_CONFIG.text1Sx,SCORE_CONFIG.text1Y,SCORE_CONFIG.text1Fill,SCORE_CONFIG.text1Size,SCORE_CONFIG.text1Weight).hide(),this.text2=layer.createText(LAYERS.DEFAULT,SCORE_CONFIG.text2Prefix+SCORE_CONFIG.text2Value,SCORE_CONFIG.text2Sx,SCORE_CONFIG.text2Y,SCORE_CONFIG.text2Fill,SCORE_CONFIG.text2Size).hide()}show(t){timeline.createTask({start:t,duration:SCORE_CONFIG.animLength,data:[MODES.SHOW,SCORE_CONFIG.imageSx,SCORE_CONFIG.imageEx,SCORE_CONFIG.text1Sx,SCORE_CONFIG.text1Ex,SCORE_CONFIG.text2Sx,SCORE_CONFIG.text2Ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:SCORE_CONFIG.animLength,data:[MODES.HIDE,SCORE_CONFIG.imageEx,SCORE_CONFIG.imageSx,SCORE_CONFIG.text1Ex,SCORE_CONFIG.text1Sx,SCORE_CONFIG.text2Ex,SCORE_CONFIG.text2Sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}number(t){this.text1.attr("text",t||0),this.image.scale(1.2,1.2),this.setTimeout(()=>{this.image.scale(1,1)},60)}onTimeUpdate(t,e,T,s,n,_,r,h){this.image.attr("x",this.anim(t,T,s-T,SCORE_CONFIG.animLength)),this.text1.attr("x",this.anim(t,n,_-n,SCORE_CONFIG.animLength)),this.text2.attr("x",this.anim(t,r,h-r,SCORE_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.image,this.text1,this.text2].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&([this.image,this.text1,this.text2].invoke(t),this.text1.attr("text",0))}}const score=new Score;class Background{constructor(){a(this,"image"),a(this,"time"),a(this,"getWobble",()=>{const t=randomNumber(12)-6,e=randomNumber(12)-6;this.image.attr({x:t,y:e})})}set(){this.image=layer.createImage(LAYERS.DEFAULT,BACKGROUND_CONFIG.image,BACKGROUND_CONFIG.x,BACKGROUND_CONFIG.y,BACKGROUND_CONFIG.width,BACKGROUND_CONFIG.height,BACKGROUND_CONFIG.preserveAspectRatio)}wobble(){this.time=timeline._setInterval(this.getWobble,50)}stop(){this.time.stop(),this.image.attr({x:0,y:0})}}const background=new Background,{height:viewportHeight$1}=viewport;class Lose{constructor(){a(this,"anim",exponential.co),a(this,"back",back.co),a(this,"o1"),a(this,"o2"),a(this,"o3"),a(this,"animLength",LOSE_CONFIG.animLength),a(this,"number",0),a(this,"anims",[])}set(){this.o1=layer.createImage(LAYERS.DEFAULT,LOSE_CONFIG.conf[0].src,LOSE_CONFIG.conf[0].sx,LOSE_CONFIG.conf[0].y,LOSE_CONFIG.conf[0].w,LOSE_CONFIG.conf[0].h).hide(),this.o2=layer.createImage(LAYERS.DEFAULT,LOSE_CONFIG.conf[1].src,LOSE_CONFIG.conf[1].sx,LOSE_CONFIG.conf[1].y,LOSE_CONFIG.conf[1].w,LOSE_CONFIG.conf[1].h).hide(),this.o3=layer.createImage(LAYERS.DEFAULT,LOSE_CONFIG.conf[2].src,LOSE_CONFIG.conf[2].sx,LOSE_CONFIG.conf[2].y,LOSE_CONFIG.conf[2].w,LOSE_CONFIG.conf[2].h).hide()}show(t){timeline.createTask({start:t,duration:this.animLength,data:[MODES.SHOW,LOSE_CONFIG.conf[0].sx,LOSE_CONFIG.conf[0].ex,LOSE_CONFIG.conf[1].sx,LOSE_CONFIG.conf[1].ex,LOSE_CONFIG.conf[2].sx,LOSE_CONFIG.conf[2].ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:this.animLength,data:[MODES.HIDE,LOSE_CONFIG.conf[0].ex,LOSE_CONFIG.conf[0].sx,LOSE_CONFIG.conf[1].ex,LOSE_CONFIG.conf[1].sx,LOSE_CONFIG.conf[2].ex,LOSE_CONFIG.conf[2].sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}showLoseAt(){const t=[[this.o1,LOSE_CONFIG.conf[0]],[this.o2,LOSE_CONFIG.conf[1]],[this.o3,LOSE_CONFIG.conf[2]]][++this.number-1];t[0].attr("src",t[1].srcF).scale(1e-5,1e-5),this.scaleImage(t[0]),vibration.vibrate(),this.number===3&&(vibration.gameOver(),this.number=0,message.postMessage(MESSAGES.GAME_OVER),message.postMessage(SCENES.GAME_OVER,MESSAGES.SCENE_SWITCH_SCENE))}scaleImage(t){t.myOnScaling=t.myOnScaling||((e,T)=>{t.scale(T=this.back(e,1e-5,1-1e-5,500),T)}),t.myOnScaleEnd=t.myOnScaleEnd||function(){t.scale(1,1)},timeline.createTask({start:0,duration:500,object:t,onTimeUpdate:t.myOnScaling,onTimeEnd:t.myOnScaleEnd,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_,r,h){this.o1.attr("x",this.anim(t,T,s-T,this.animLength)),this.o2.attr("x",this.anim(t,n,_-n,this.animLength)),this.o3.attr("x",this.anim(t,r,h-r,this.animLength))}onTimeStart(t){t===MODES.SHOW&&([this.o1,this.o2,this.o3].invoke(t),[[this.o1,LOSE_CONFIG.conf[0]],[this.o2,LOSE_CONFIG.conf[1]],[this.o3,LOSE_CONFIG.conf[2]]].forEach(e=>{e[0].attr("src",e[1].src)}))}onTimeEnd(t){t===MODES.HIDE&&([this.o1,this.o2,this.o3].invoke(t),[[this.o1,LOSE_CONFIG.conf[0]],[this.o2,LOSE_CONFIG.conf[1]],[this.o3,LOSE_CONFIG.conf[2]]].forEach(e=>{e[0].attr("src",e[1].srcF)}))}createPosShow(t){const e=layer.createImage(LAYERS.DEFAULT,LOSE_CONFIG.image,t-calcSize(27),viewportHeight$1-calcSize(50),calcSize(54),calcSize(50)).scale(1e-5,1e-5),T=500;({show:function(s){timeline.createTask({start:s,duration:T,data:[back.co,1e-5,1],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onShowEnd})},hide:function(s){timeline.createTask({start:s,duration:T,data:[back.ci,1,1e-5],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd})},onScaling:function(s,n,_,r,h){e.scale(h=n(s,_,r-_,T),h)},onShowEnd:function(){this.hide(1500)},onHideEnd:function(){e.remove()}}).show(200)}}const lose=new Lose;class GameOver{constructor(){a(this,"image"),a(this,"anims",[])}set(){this.image=layer.createImage(LAYERS.DEFAULT,GAME_OVER_CONFIG.image,GAME_OVER_CONFIG.x,GAME_OVER_CONFIG.y,GAME_OVER_CONFIG.width,GAME_OVER_CONFIG.height).hide().scale(1e-5,1e-5)}show(t){timeline.createTask({start:t,duration:500,data:[1e-5,1,MODES.SHOW],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:500,data:[1,1e-5,MODES.HIDE],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})}onZoomStart(t,e,T){T===MODES.SHOW&&this.image.show()}onZooming(t,e,T,s){this.image.scale(s=exponential.co(t,e,T-e,500),s)}onZoomEnd(t,e,T){T===MODES.SHOW?state(STATE_KEYS.CLICK_ENABLE).on():T===MODES.HIDE&&this.image.hide()}}const gameOver=new GameOver,{width:viewportWidth,height:viewportHeight}=viewport;class Game{constructor(){a(this,"scoreNumber",0),a(this,"volleyNum",2),a(this,"volleyMultipleNumber",5),a(this,"fruits",[]),a(this,"gameInterval"),a(this,"snd"),a(this,"boomSnd"),a(this,"barbette",()=>{if(this.fruits.length>=this.volleyNum)return;const t=randomNumber(viewportWidth),e=randomNumber(viewportWidth),T=viewportHeight,s=fruitFactory.create(t,T).shotOut(0,e);this.fruits.push(s),this.snd.play(),this.barbette()}),message.addEventListener(MESSAGES.FRUIT_REMOVE,t=>{const e=this.fruits.indexOf(t);e>-1&&this.fruits.splice(e,1)}),message.addEventListener(MESSAGES.FRUIT_FALL_OUT_OF_VIEWER,t=>{state(STATE_KEYS.GAME_STATE).isnot(GAME_STATES.PLAYING)||t.type!==FRUIT_CONFIG.types.BOOM&&lose.showLoseAt(t.originX)}),message.addEventListener(MESSAGES.GAME_OVER,()=>{this.gameOver(),knifes.switchOn()}),message.addEventListener(MESSAGES.OVER_WHITE_LIGHT_SHOW,()=>{knifes.endAll();for(let t=this.fruits.length-1;t>=0;t--)this.fruits[t].remove();background.stop()}),message.addEventListener(MESSAGES.CLICK,()=>{state(STATE_KEYS.CLICK_ENABLE).off(),gameOver.hide(),message.postMessage(MESSAGES.HOME_MENU,MESSAGES.SCENE_SWITCH_SCENE)})}start(){this.scoreNumber=0,this.volleyNum=2,this.snd=soundFactory.create("sound/throw"),this.boomSnd=soundFactory.create("sound/boom"),timeline.setTimeout(()=>{state(STATE_KEYS.GAME_STATE).set(GAME_STATES.PLAYING),this.gameInterval=timeline._setInterval(this.barbette,1e3)},500)}gameOver(){state(STATE_KEYS.GAME_STATE).set(GAME_STATES.OVER),this.gameInterval.stop(),this.fruits.length=0}applyScore(t){t>this.volleyNum*this.volleyMultipleNumber&&this.volleyNum++,this.volleyMultipleNumber+=50}sliceAt(t,e){const T=this.fruits.indexOf(t);state(STATE_KEYS.GAME_STATE).isnot(GAME_STATES.PLAYING)||(t.type!==FRUIT_CONFIG.types.BOOM?(t.broken(e),vibration.fruit(),T&&this.fruits.splice(T,1),score.number(++this.scoreNumber),this.applyScore(this.scoreNumber)):(this.boomSnd.play(),this.pauseAllFruit(),background.wobble(),vibration.boom(),light.start(t)))}catchFruit(t){const e=this.fruits.indexOf(t);state(STATE_KEYS.GAME_STATE).isnot(GAME_STATES.PLAYING)||(t.type!==FRUIT_CONFIG.types.BOOM?(t.broken(0),vibration.fruit(),e!==-1&&this.fruits.splice(e,1),score.number(++this.scoreNumber),this.applyScore(this.scoreNumber)):(this.boomSnd.play(),this.pauseAllFruit(),background.wobble(),vibration.boom(),light.start(t)))}pauseAllFruit(){this.gameInterval.stop(),knifes.pause(),this.fruits.invoke("pause")}}const game=new Game,homeMask=displacementFactory.create({layer:LAYERS.START_SCREEN,imageSrc:HOME_MASK_CONFIG.image,width:HOME_MASK_CONFIG.width,height:HOME_MASK_CONFIG.height,startX:HOME_MASK_CONFIG.startX,startY:HOME_MASK_CONFIG.startY,endX:HOME_MASK_CONFIG.endX,endY:HOME_MASK_CONFIG.endY,animMap:exponential.co,duration:HOME_MASK_CONFIG.duration}),homeLogo=displacementFactory.create({layer:LAYERS.START_SCREEN,imageSrc:HOME_LOGO_CONFIG.image,width:HOME_LOGO_CONFIG.width,height:HOME_LOGO_CONFIG.height,startX:HOME_LOGO_CONFIG.startX,startY:HOME_LOGO_CONFIG.startY,endX:HOME_LOGO_CONFIG.endX,endY:HOME_LOGO_CONFIG.endY,animMap:exponential.co,duration:HOME_LOGO_CONFIG.duration});class HomeText{constructor(){a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"anim",exponential.co),a(this,"anims",[]),a(this,"text1"),a(this,"text2"),a(this,"text3")}set(){this.text1=layer.createText(LAYERS.START_SCREEN,HOME_TEXT_CONFIG.text1Value,HOME_TEXT_CONFIG.text1Sx,HOME_TEXT_CONFIG.text1Y,HOME_TEXT_CONFIG.text1Fill,HOME_TEXT_CONFIG.text1Size,HOME_TEXT_CONFIG.text1Weight,HOME_TEXT_CONFIG.text1Anchor).hide(),this.text2=layer.createText(LAYERS.START_SCREEN,HOME_TEXT_CONFIG.text2Value,HOME_TEXT_CONFIG.text2Sx,HOME_TEXT_CONFIG.text2Y,HOME_TEXT_CONFIG.text2Fill,HOME_TEXT_CONFIG.text2Size,HOME_TEXT_CONFIG.text2Weight,HOME_TEXT_CONFIG.text2Anchor).hide(),this.text3=layer.createText(LAYERS.START_SCREEN,HOME_TEXT_CONFIG.text3Value,HOME_TEXT_CONFIG.text3Sx,HOME_TEXT_CONFIG.text3Y,HOME_TEXT_CONFIG.text3Fill,HOME_TEXT_CONFIG.text3Size,HOME_TEXT_CONFIG.text3Weight,HOME_TEXT_CONFIG.text3Anchor).hide()}show(t){timeline.createTask({start:t,duration:HOME_TEXT_CONFIG.animLength,data:[MODES.SHOW,HOME_TEXT_CONFIG.text1Sx,HOME_TEXT_CONFIG.text1Ex,HOME_TEXT_CONFIG.text2Sx,HOME_TEXT_CONFIG.text2Ex,HOME_TEXT_CONFIG.text3Sx,HOME_TEXT_CONFIG.text3Ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:HOME_TEXT_CONFIG.animLength,data:[MODES.HIDE,HOME_TEXT_CONFIG.text1Ex,HOME_TEXT_CONFIG.text1Sx,HOME_TEXT_CONFIG.text2Ex,HOME_TEXT_CONFIG.text2Sx,HOME_TEXT_CONFIG.text3Ex,HOME_TEXT_CONFIG.text3Sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_,r,h){this.text1.attr("x",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.text2.attr("x",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength)),this.text3.attr("x",this.anim(t,r,h-r,HOME_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.text1,this.text2,this.text3].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.text1,this.text2,this.text3].invoke(t)}}const homeText=new HomeText;class HomeButton{constructor(){a(this,"text"),a(this,"button"),a(this,"group"),a(this,"anims",[]),a(this,"anim",exponential.co)}set(){this.button=layer.createImage(LAYERS.START_SCREEN,START_BUTTON_CONFIG.image,START_BUTTON_CONFIG.startX,START_BUTTON_CONFIG.startY,START_BUTTON_CONFIG.width,START_BUTTON_CONFIG.height).hide(),this.text=layer.createText(LAYERS.START_SCREEN,START_BUTTON_CONFIG.textValue,START_BUTTON_CONFIG.textStartX,START_BUTTON_CONFIG.textStartY,START_BUTTON_CONFIG.textFill,START_BUTTON_CONFIG.textSize,START_BUTTON_CONFIG.textWeight,START_BUTTON_CONFIG.textAnchor),this.group=layer.getLayer(LAYERS.START_SCREEN).set(),this.group.push(this.button,this.text),layer.hideLayer(LAYERS.START_SCREEN),this.group.click(()=>{message.postMessage(MESSAGES.START_GAME),vibration.vibrate()})}show(t){timeline.createTask({start:t,duration:START_BUTTON_CONFIG.animLength,data:[MODES.SHOW,START_BUTTON_CONFIG.startY,START_BUTTON_CONFIG.endY,START_BUTTON_CONFIG.textStartY,START_BUTTON_CONFIG.textEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:START_BUTTON_CONFIG.animLength,data:[MODES.SHOW,START_BUTTON_CONFIG.endY,START_BUTTON_CONFIG.startY,START_BUTTON_CONFIG.textEndY,START_BUTTON_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_){this.button.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.text.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.button].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.button].invoke(t)}}const homeButton=new HomeButton,resultLogo=displacementFactory.create({layer:LAYERS.RESULT_SCREEN,imageSrc:RESULT_LOGO_CONFIG.image,width:RESULT_LOGO_CONFIG.width,height:RESULT_LOGO_CONFIG.height,startX:RESULT_LOGO_CONFIG.startX,startY:RESULT_LOGO_CONFIG.startY,endX:RESULT_LOGO_CONFIG.endX,endY:RESULT_LOGO_CONFIG.endY,animMap:exponential.co,duration:RESULT_LOGO_CONFIG.duration});class ResultText{constructor(){a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"anim",exponential.co),a(this,"anims",[]),a(this,"text1"),a(this,"text2"),a(this,"text3"),a(this,"text4"),a(this,"text5"),a(this,"text6"),a(this,"text7"),message.addEventListener(MESSAGES.GAME_OVER,()=>{this.text3.attr("text",game.scoreNumber)})}set(){this.text1=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text1Value,RESULT_TEXT_CONFIG.text1X,RESULT_TEXT_CONFIG.text1Sy,RESULT_TEXT_CONFIG.text1Fill,RESULT_TEXT_CONFIG.text1Size,RESULT_TEXT_CONFIG.text1Weight,RESULT_TEXT_CONFIG.text1Anchor).hide(),this.text2=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text2Value,RESULT_TEXT_CONFIG.text2X,RESULT_TEXT_CONFIG.text2Sy,RESULT_TEXT_CONFIG.text2Fill,RESULT_TEXT_CONFIG.text2Size,RESULT_TEXT_CONFIG.text2Weight,RESULT_TEXT_CONFIG.text2Anchor).hide(),this.text3=layer.createText(LAYERS.RESULT_SCREEN,game.scoreNumber,RESULT_TEXT_CONFIG.text3X,RESULT_TEXT_CONFIG.text3Sy,RESULT_TEXT_CONFIG.text3Fill,RESULT_TEXT_CONFIG.text3Size,RESULT_TEXT_CONFIG.text3Weight,RESULT_TEXT_CONFIG.text3Anchor).attr("stroke","white").attr("stroke-width",3).hide(),this.text4=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text4Value,RESULT_TEXT_CONFIG.text4Sx,RESULT_TEXT_CONFIG.text4Y,RESULT_TEXT_CONFIG.text4Fill,RESULT_TEXT_CONFIG.text4Size,RESULT_TEXT_CONFIG.text4Weight,RESULT_TEXT_CONFIG.text4Anchor).hide(),this.text5=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text5Value,RESULT_TEXT_CONFIG.text5Sx,RESULT_TEXT_CONFIG.text5Y,RESULT_TEXT_CONFIG.text5Fill,RESULT_TEXT_CONFIG.text5Size,RESULT_TEXT_CONFIG.text5Weight,RESULT_TEXT_CONFIG.text5Anchor).attr("stroke","white").attr("stroke-width",2).hide(),this.text6=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text6Value,RESULT_TEXT_CONFIG.text6Sx,RESULT_TEXT_CONFIG.text6Y,RESULT_TEXT_CONFIG.text6Fill,RESULT_TEXT_CONFIG.text6Size,RESULT_TEXT_CONFIG.text6Weight,RESULT_TEXT_CONFIG.text6Anchor).hide(),this.text7=layer.createText(LAYERS.RESULT_SCREEN,RESULT_TEXT_CONFIG.text7Value,RESULT_TEXT_CONFIG.text7Sx,RESULT_TEXT_CONFIG.text7Y,RESULT_TEXT_CONFIG.text7Fill,RESULT_TEXT_CONFIG.text7Size,RESULT_TEXT_CONFIG.text7Weight,RESULT_TEXT_CONFIG.text7Anchor).attr("stroke","white").attr("stroke-width",2).hide()}show(t){timeline.createTask({start:t,duration:RESULT_TEXT_CONFIG.animLength,data:[MODES.SHOW,RESULT_TEXT_CONFIG.text1Sy,RESULT_TEXT_CONFIG.text1Ey,RESULT_TEXT_CONFIG.text2Sy,RESULT_TEXT_CONFIG.text2Ey,RESULT_TEXT_CONFIG.text3Sy,RESULT_TEXT_CONFIG.text3Ey,RESULT_TEXT_CONFIG.text4Sx,RESULT_TEXT_CONFIG.text4Ex,RESULT_TEXT_CONFIG.text5Sx,RESULT_TEXT_CONFIG.text5Ex,RESULT_TEXT_CONFIG.text6Sx,RESULT_TEXT_CONFIG.text6Ex,RESULT_TEXT_CONFIG.text7Sx,RESULT_TEXT_CONFIG.text7Ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:RESULT_TEXT_CONFIG.animLength,data:[MODES.HIDE,RESULT_TEXT_CONFIG.text1Ey,RESULT_TEXT_CONFIG.text1Sy,RESULT_TEXT_CONFIG.text2Ey,RESULT_TEXT_CONFIG.text2Sy,RESULT_TEXT_CONFIG.text3Ey,RESULT_TEXT_CONFIG.text3Sy,RESULT_TEXT_CONFIG.text4Ex,RESULT_TEXT_CONFIG.text4Sx,RESULT_TEXT_CONFIG.text5Ex,RESULT_TEXT_CONFIG.text5Sx,RESULT_TEXT_CONFIG.text6Ex,RESULT_TEXT_CONFIG.text6Sx,RESULT_TEXT_CONFIG.text7Ex,RESULT_TEXT_CONFIG.text7Sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_,r,h,S,E,o,O,c,u,N,l){this.text1.attr("y",this.anim(t,T,s-T,RESULT_TEXT_CONFIG.animLength)),this.text2.attr("y",this.anim(t,n,_-n,RESULT_TEXT_CONFIG.animLength)),this.text3.attr("y",this.anim(t,r,h-r,RESULT_TEXT_CONFIG.animLength)),this.text4.attr("x",this.anim(t,S,E-S,RESULT_TEXT_CONFIG.animLength)),this.text5.attr("x",this.anim(t,o,O-o,RESULT_TEXT_CONFIG.animLength)),this.text6.attr("x",this.anim(t,c,u-c,RESULT_TEXT_CONFIG.animLength)),this.text7.attr("x",this.anim(t,N,l-N,RESULT_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.text1,this.text2,this.text3,this.text4,this.text5,this.text6,this.text7].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.text1,this.text2,this.text3,this.text4,this.text5,this.text6,this.text7].invoke(t)}}const resultText=new ResultText;class ResultButtonNext{constructor(){a(this,"text"),a(this,"button"),a(this,"group"),a(this,"anims",[]),a(this,"anim",exponential.co)}set(){this.button=layer.createImage(LAYERS.RESULT_SCREEN,RESULT_BUTTON_NEXT_CONFIG.image,RESULT_BUTTON_NEXT_CONFIG.startX,RESULT_BUTTON_NEXT_CONFIG.startY,RESULT_BUTTON_NEXT_CONFIG.width,RESULT_BUTTON_NEXT_CONFIG.height).hide(),this.text=layer.createText(LAYERS.RESULT_SCREEN,RESULT_BUTTON_NEXT_CONFIG.textValue,RESULT_BUTTON_NEXT_CONFIG.textStartX,RESULT_BUTTON_NEXT_CONFIG.textStartY,RESULT_BUTTON_NEXT_CONFIG.textFill,RESULT_BUTTON_NEXT_CONFIG.textSize,RESULT_BUTTON_NEXT_CONFIG.textWeight,RESULT_BUTTON_NEXT_CONFIG.textAnchor),this.group=layer.getLayer(LAYERS.RESULT_SCREEN).set(),this.group.push(this.button,this.text),layer.hideLayer(LAYERS.RESULT_SCREEN),this.group.click(()=>{vibration.vibrate(),message.postMessage(SCENES.BRAND_QUESTION,MESSAGES.SCENE_SWITCH_SCENE)})}show(t){timeline.createTask({start:t,duration:RESULT_BUTTON_NEXT_CONFIG.animLength,data:[MODES.SHOW,RESULT_BUTTON_NEXT_CONFIG.startY,RESULT_BUTTON_NEXT_CONFIG.endY,RESULT_BUTTON_NEXT_CONFIG.textStartY,RESULT_BUTTON_NEXT_CONFIG.textEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:RESULT_BUTTON_NEXT_CONFIG.animLength,data:[MODES.SHOW,RESULT_BUTTON_NEXT_CONFIG.endY,RESULT_BUTTON_NEXT_CONFIG.startY,RESULT_BUTTON_NEXT_CONFIG.textEndY,RESULT_BUTTON_NEXT_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_){this.button.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.text.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.button].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.button].invoke(t)}}const resultButtonNext=new ResultButtonNext;class ResultButtonReplay{constructor(){a(this,"text"),a(this,"button"),a(this,"group"),a(this,"anims",[]),a(this,"anim",exponential.co)}set(){this.button=layer.createImage(LAYERS.RESULT_SCREEN,RESULT_BUTTON_REPLAY_CONFIG.image,RESULT_BUTTON_REPLAY_CONFIG.startX,RESULT_BUTTON_REPLAY_CONFIG.startY,RESULT_BUTTON_REPLAY_CONFIG.width,RESULT_BUTTON_REPLAY_CONFIG.height).hide(),this.text=layer.createText(LAYERS.RESULT_SCREEN,RESULT_BUTTON_REPLAY_CONFIG.textValue,RESULT_BUTTON_REPLAY_CONFIG.textStartX,RESULT_BUTTON_REPLAY_CONFIG.textStartY,RESULT_BUTTON_REPLAY_CONFIG.textFill,RESULT_BUTTON_REPLAY_CONFIG.textSize,RESULT_BUTTON_REPLAY_CONFIG.textWeight,RESULT_BUTTON_REPLAY_CONFIG.textAnchor),this.group=layer.getLayer(LAYERS.RESULT_SCREEN).set(),this.group.push(this.button,this.text),layer.hideLayer(LAYERS.RESULT_SCREEN),this.group.click(()=>{message.postMessage(MESSAGES.START_GAME),vibration.vibrate()})}show(t){timeline.createTask({start:t,duration:RESULT_BUTTON_REPLAY_CONFIG.animLength,data:[MODES.SHOW,RESULT_BUTTON_REPLAY_CONFIG.startY,RESULT_BUTTON_REPLAY_CONFIG.endY,RESULT_BUTTON_REPLAY_CONFIG.textStartY,RESULT_BUTTON_REPLAY_CONFIG.textEndY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:RESULT_BUTTON_REPLAY_CONFIG.animLength,data:[MODES.SHOW,RESULT_BUTTON_REPLAY_CONFIG.endY,RESULT_BUTTON_REPLAY_CONFIG.startY,RESULT_BUTTON_REPLAY_CONFIG.textEndY,RESULT_BUTTON_REPLAY_CONFIG.textStartY],object:this,onTime:this.onTimeUpdate,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_){this.button.attr("y",this.anim(t,T,s-T,HOME_TEXT_CONFIG.animLength)),this.text.attr("y",this.anim(t,n,_-n,HOME_TEXT_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.button].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.button].invoke(t)}}const resultButtonReplay=new ResultButtonReplay,bottom=displacementFactory.create({layer:LAYERS.DEFAULT,imageSrc:BOTTOM_CONFIG.image,width:BOTTOM_CONFIG.width,height:BOTTOM_CONFIG.height,startX:BOTTOM_CONFIG.startX,startY:BOTTOM_CONFIG.startY,endX:BOTTOM_CONFIG.endX,endY:BOTTOM_CONFIG.endY,animMap:exponential.co,duration:BOTTOM_CONFIG.duration});class FPS{constructor(){a(this,"text"),a(this,"prefix",FPS_CONFIG.prefix),a(this,"fill",FPS_CONFIG.fill)}set(){this.text=layer.createText(LAYERS.DEFAULT,this.prefix+"0",FPS_CONFIG.x,FPS_CONFIG.y).attr("fill",this.fill)}update(){this.text.attr("text",this.prefix+(timeline.getFPS()>>0))}}const fps=new FPS;class BrandQuestion{constructor(){a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"anim",exponential.co),a(this,"anims",[]),a(this,"title"),a(this,"text1"),a(this,"text2"),a(this,"text3"),a(this,"text4"),a(this,"answer1"),a(this,"answer2")}set(){this.title=layer.createText(LAYERS.BRAND_QUESTION,BRAND_QUESTION_TITLE_CONFIG.textValue,BRAND_QUESTION_TITLE_CONFIG.textX,BRAND_QUESTION_TITLE_CONFIG.textStartY,BRAND_QUESTION_TITLE_CONFIG.textFill,BRAND_QUESTION_TITLE_CONFIG.textSize,BRAND_QUESTION_TITLE_CONFIG.textWeight,BRAND_QUESTION_TITLE_CONFIG.textAnchor).hide(),this.text1=layer.createText(LAYERS.BRAND_QUESTION,BRAND_QUESTION_TEXT1_CONFIG.textValue,BRAND_QUESTION_TEXT1_CONFIG.textStartX,BRAND_QUESTION_TEXT1_CONFIG.textY,BRAND_QUESTION_TEXT1_CONFIG.textFill,BRAND_QUESTION_TEXT1_CONFIG.textSize,BRAND_QUESTION_TEXT1_CONFIG.textWeight,BRAND_QUESTION_TEXT1_CONFIG.textAnchor).hide(),this.text2=layer.createText(LAYERS.BRAND_QUESTION,BRAND_QUESTION_TEXT2_CONFIG.textValue,BRAND_QUESTION_TEXT2_CONFIG.textStartX,BRAND_QUESTION_TEXT2_CONFIG.textY,BRAND_QUESTION_TEXT2_CONFIG.textFill,BRAND_QUESTION_TEXT2_CONFIG.textSize,BRAND_QUESTION_TEXT2_CONFIG.textWeight,BRAND_QUESTION_TEXT2_CONFIG.textAnchor).hide(),this.answer1=layer.createImage(LAYERS.BRAND_QUESTION,BRAND_ANSWER1_CONFIG.image,BRAND_ANSWER1_CONFIG.buttonX,BRAND_ANSWER1_CONFIG.buttonStartY,BRAND_ANSWER1_CONFIG.width,BRAND_ANSWER1_CONFIG.height).hide(),this.text3=layer.createText(LAYERS.BRAND_QUESTION,BRAND_ANSWER1_CONFIG.textValue,BRAND_ANSWER1_CONFIG.textX,BRAND_ANSWER1_CONFIG.textStartY,BRAND_ANSWER1_CONFIG.textFill,BRAND_ANSWER1_CONFIG.textSize,BRAND_ANSWER1_CONFIG.textWeight,BRAND_ANSWER1_CONFIG.textAnchor).hide(),this.answer2=layer.createImage(LAYERS.BRAND_QUESTION,BRAND_ANSWER2_CONFIG.image,BRAND_ANSWER2_CONFIG.buttonX,BRAND_ANSWER2_CONFIG.buttonStartY,BRAND_ANSWER2_CONFIG.width,BRAND_ANSWER2_CONFIG.height).hide(),this.text4=layer.createText(LAYERS.BRAND_QUESTION,BRAND_ANSWER2_CONFIG.textValue,BRAND_ANSWER2_CONFIG.textX,BRAND_ANSWER2_CONFIG.textStartY,BRAND_ANSWER2_CONFIG.textFill,BRAND_ANSWER2_CONFIG.textSize,BRAND_ANSWER2_CONFIG.textWeight,BRAND_ANSWER2_CONFIG.textAnchor).hide(),this.group1=layer.getLayer(LAYERS.RESULT_SCREEN).set(),this.group1.push(this.answer1,this.text3),this.group2=layer.getLayer(LAYERS.RESULT_SCREEN).set(),this.group2.push(this.answer2,this.text4),this.group1.click(()=>{vibration.vibrate(),console.log("click1")}),this.group2.click(()=>{vibration.vibrate(),console.log("click2")}),layer.getLayer(LAYERS.BRAND_QUESTION).set(),layer.hideLayer(LAYERS.BRAND_QUESTION)}show(t){timeline.createTask({start:t,duration:BRAND_QUESTION_TITLE_CONFIG.animLength,data:[MODES.SHOW,BRAND_QUESTION_TITLE_CONFIG.textStartY,BRAND_QUESTION_TITLE_CONFIG.textEndY,BRAND_QUESTION_TEXT1_CONFIG.textStartX,BRAND_QUESTION_TEXT1_CONFIG.textEndX,BRAND_QUESTION_TEXT2_CONFIG.textStartX,BRAND_QUESTION_TEXT2_CONFIG.textEndX,BRAND_ANSWER1_CONFIG.textStartY,BRAND_ANSWER1_CONFIG.textEndY,BRAND_ANSWER1_CONFIG.buttonStartY,BRAND_ANSWER1_CONFIG.buttonEndY,BRAND_ANSWER2_CONFIG.textStartY,BRAND_ANSWER2_CONFIG.textEndY,BRAND_ANSWER2_CONFIG.buttonStartY,BRAND_ANSWER2_CONFIG.buttonEndY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}hide(t){timeline.createTask({start:t,duration:BRAND_QUESTION_TITLE_CONFIG.animLength,data:[MODES.HIDE,BRAND_QUESTION_TITLE_CONFIG.textEndY,BRAND_QUESTION_TITLE_CONFIG.textStartY,BRAND_QUESTION_TEXT1_CONFIG.textEndX,BRAND_QUESTION_TEXT1_CONFIG.textStartX,BRAND_QUESTION_TEXT2_CONFIG.textEndX,BRAND_QUESTION_TEXT2_CONFIG.textStartX,BRAND_ANSWER1_CONFIG.textEndY,BRAND_ANSWER1_CONFIG.textStartY,BRAND_ANSWER1_CONFIG.buttonEndY,BRAND_ANSWER1_CONFIG.buttonStartY,BRAND_ANSWER2_CONFIG.textEndY,BRAND_ANSWER2_CONFIG.textStartY,BRAND_ANSWER2_CONFIG.buttonEndY,BRAND_ANSWER2_CONFIG.buttonStartY],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})}onTimeUpdate(t,e,T,s,n,_,r,h,S,E,o,O,c,u,N,l){this.title.attr("y",this.anim(t,T,s-T,BRAND_QUESTION_TITLE_CONFIG.animLength)),this.text1.attr("x",this.anim(t,n,_-n,BRAND_QUESTION_TEXT1_CONFIG.animLength)),this.text2.attr("x",this.anim(t,r,h-r,BRAND_QUESTION_TEXT2_CONFIG.animLength)),this.text3.attr("y",this.anim(t,S,E-S,BRAND_ANSWER1_CONFIG.animLength)),this.answer1.attr("y",this.anim(t,o,O-o,BRAND_ANSWER1_CONFIG.animLength)),this.text4.attr("y",this.anim(t,c,u-c,BRAND_ANSWER2_CONFIG.animLength)),this.answer2.attr("y",this.anim(t,N,l-N,BRAND_ANSWER2_CONFIG.animLength))}onTimeStart(t){t===MODES.SHOW&&[this.title,this.text1,this.text2,this.text3,this.answer1,this.text4,this.answer2].invoke(t)}onTimeEnd(t){t===MODES.HIDE&&[this.title,this.text1,this.text2,this.text3,this.answer1,this.text4,this.answer2].invoke(t)}}const brandQuestion=new BrandQuestion;class Scene{constructor(){a(this,"menuSnd"),a(this,"gameStartSnd"),a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"setInterval",timeline._setInterval.bind(timeline)),message.addEventListener(MESSAGES.SCENE_SWITCH_SCENE,t=>{this.switchScene(t)}),message.addEventListener(MESSAGES.TOGGLE_SOUND,()=>{this.toggleSound()})}init(){this.menuSnd=soundFactory.create("sound/menu"),this.gameStartSnd=soundFactory.create("sound/start"),[background,homeMask,homeLogo,homeText,homeButton,score,lose,gameOver,flash,bottom,resultLogo,resultText,resultButtonNext,resultButtonReplay,soundButton,brandQuestion,fps].invoke("set"),this.setInterval(fps.update.bind(fps),500)}switchScene(t){const e=()=>s.set(SCENE_STATES.READY),T=state(STATE_KEYS.SCENE_NAME),s=state(STATE_KEYS.SCENE_STATE);if(T.is(t))return;const n=()=>{switch(T.set(t),s.set(SCENE_STATES.ENTERING),t){case SCENES.HOME_MENU:this.showMenu(e);break;case SCENES.GAME_BODY:this.showGame(e);break;case SCENES.GAME_OVER:this.showGameOver(e);break;case SCENES.GAME_RESULT:this.showResult(e);break;case SCENES.BRAND_QUESTION:this.showBrandQuestion(e);break}};s.set(SCENE_STATES.EXITING),T.isunset()?n():T.is(SCENES.HOME_MENU)?this.hideMenu(n):T.is(SCENES.GAME_BODY)?this.hideGame(n):T.is(SCENES.GAME_OVER)?this.hideGameOver(n):T.is(SCENES.GAME_RESULT)?this.hideResult(n):T.is(SCENES.BRAND_QUESTION)&&this.hideBrandQuestion(n)}toggleSound(){const t=state(STATE_KEYS.SCENE_NAME),e=soundButton.isOn?"play":"stop";t.is(SCENES.HOME_MENU)?this.menuSnd[e]():t.is(SCENES.GAME_BODY)?this.gameStartSnd[e]():t.is(SCENES.GAME_RESULT)&&this.menuSnd[e]()}showMenu(t){layer.showLayer(LAYERS.START_SCREEN),[[homeMask,0],[homeLogo,0],[homeText,1e3],[bottom,1e3],[homeButton,2e3]].invoke(MODES.SHOW),this.menuSnd.play(),soundButton.showHomeSoundButton(2e3),this.setTimeout(t,2500)}hideMenu(t){[homeButton,homeMask,homeLogo,homeText].invoke(MODES.HIDE),soundButton.hideHomeSoundButton(),this.menuSnd.stop(),this.setTimeout(()=>{t(),layer.hideLayer(LAYERS.START_SCREEN)},1200)}showGame(t){layer.showLayer(LAYERS.FRUIT),score.show(),lose.show(),game.start(),this.gameStartSnd.play(),soundButton.showGameSoundButton(),this.setTimeout(t,700)}hideGame(t){score.hide(),lose.hide(),soundButton.hideGameSoundButton(),this.gameStartSnd.stop(),this.setTimeout(()=>{t(),layer.hideLayer(LAYERS.FRUIT)},700)}showGameOver(t){[[gameOver,1e3]].invoke(MODES.SHOW),this.setTimeout(()=>{t(),this.switchScene(SCENES.GAME_RESULT)},2e3)}hideGameOver(t){[gameOver].invoke(MODES.HIDE),this.setTimeout(t,1e3)}showResult(){layer.showLayer(LAYERS.RESULT_SCREEN),[[resultLogo,0],[resultText,700],[resultButtonNext,1e3],[resultButtonReplay,1e3]].invoke(MODES.SHOW),this.menuSnd.play(),soundButton.showResultSoundButton()}hideResult(t){[resultLogo,resultText,resultButtonNext,resultButtonReplay].invoke(MODES.HIDE),soundButton.hideResultSoundButton(),this.menuSnd.stop(),this.setTimeout(()=>{t(),layer.hideLayer(LAYERS.RESULT_SCREEN)},1e3)}showBrandQuestion(){layer.showLayer(LAYERS.BRAND_QUESTION),[[brandQuestion,0]].invoke(MODES.SHOW),soundButton.showResultSoundButton()}hideBrandQuestion(t){[brandQuestion].invoke(MODES.HIDE),soundButton.hideResultSoundButton(),this.setTimeout(()=>{t(),layer.hideLayer(LAYERS.BRAND_QUESTION)},1e3)}}const scene=new Scene;class Console{constructor(){a(this,"x",CONSOLE_CONFIG.x),a(this,"y",CONSOLE_CONFIG.y),a(this,"texts",[])}set(){}clear(){const t=this.texts.length;for(let e=0;e<t;e++)this.texts[e].remove();this.texts.length=0,this.y=CONSOLE_CONFIG.y}log(t){this.y+=20,this.texts.push(layer.createText("default",t,this.x,this.y))}}const csl=new Console;class Main{constructor(){a(this,"setTimeout",timeline.setTimeout.bind(timeline)),a(this,"log",(()=>{let T=1e3;const s=300,n=function(_){setTimeout(function(){csl.log(_)},T),T+=s};return n.clear=function(){setTimeout(csl.clear.bind(csl),T),T+=s},n})());var t,e;(e=(t=window.Telegram)==null?void 0:t.WebApp)!=null&&e.disableVerticalScroll&&window.Telegram.WebApp.disableVerticalScroll(!0),document.addEventListener("touchstart",T=>{T.preventDefault()},{passive:!1}),document.addEventListener("touchmove",T=>{T.preventDefault()},{passive:!1}),message.addEventListener(MESSAGES.SLICE,T=>{const s=collide.checkSlice(T);if(s.length){const n=tools.getAngleByRadian(tools.pointToRadian(T.slice(0,2),T.slice(2,4)));s.forEach(_=>message.postMessage(_,n,MESSAGES.SLICE_AT))}}),message.addEventListener(MESSAGES.TOUCH,T=>{const s=collide.checkTouch(T);s.length&&s.forEach(n=>message.postMessage(n,MESSAGES.TOUCH_AT))}),message.addEventListener(MESSAGES.SLICE_AT,(T,s)=>{state(STATE_KEYS.SCENE_STATE).isnot(SCENE_STATES.READY)||state(STATE_KEYS.SCENE_NAME).is(SCENES.GAME_BODY)&&game.sliceAt(T,s)}),message.addEventListener(MESSAGES.TOUCH_AT,T=>{state(STATE_KEYS.SCENE_STATE).isnot(SCENE_STATES.READY)||state(STATE_KEYS.SCENE_NAME).is(SCENES.GAME_BODY)&&game.catchFruit(T)}),message.addEventListener(MESSAGES.START_GAME,()=>{scene.switchScene(SCENES.GAME_BODY)}),preload()}start(){[timeline,scene,control].invoke("init"),this.log("Loading..."),this.log.clear(),this.setTimeout(scene.switchScene.saturate(scene,SCENES.HOME_MENU),3e3)}}const main=new Main;main.start();
//# sourceMappingURL=fruitNinja-BMxjv7Wa.js.map
